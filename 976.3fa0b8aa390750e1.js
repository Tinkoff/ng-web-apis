(self.webpackChunkdemo=self.webpackChunkdemo||[]).push([[976],{2976:(Fn,tt,Q)=>{"use strict";Q.r(tt),Q.d(tt,{default:()=>vd});var z=Q(6889),Te=Q(6733),Ne=Q(2133),le=Q(9455),ne=Q(6044),Ye=Q(1882),Le=Q(9289),Ae=Q(4911),C=Q(755),Ie=Q(4521),Se=Q(6720),Me=Q(8715),rt=Q(5047),ze=Q(2425),me=Q(5333),xe=Q(4787),Ce=Q(3843),ke=Q(8004),Oe=Q(1749);let De=(()=>{class e{constructor({nativeElement:t},i){this.tuiDroppableDropped=(0,Ie.mL)(t,"drop").pipe((0,Ie.mp)(),(0,ze.U)(r=>r.dataTransfer),(0,me.h)(Me.Pc)),this.tuiDroppableDragOverChange=(0,Ie.mL)(t,"dragenter").pipe((0,xe.w)(({target:r,dataTransfer:h})=>(0,rt.T)((0,Ie.mL)(t,"dragleave").pipe((0,me.h)(_=>_.target===r)),(0,Ie.mL)(t,"drop")).pipe((0,ze.U)(()=>null),(0,Ce.O)(h))),(0,ke.x)((r,h)=>!!r&&!!h||!r&&!h)),(0,Ie.mL)(t,"dragover").pipe((0,Ie.mp)(),(0,Oe.R)(i)).subscribe()}}return e.\u0275fac=function(t){return new(t||e)(C.Y36(C.SBq),C.Y36(Se.a3,2))},e.\u0275dir=C.lG2({type:e,selectors:[["","tuiDroppableDropped",""],["","tuiDroppableDragOverChange",""]],outputs:{tuiDroppableDropped:"tuiDroppableDropped",tuiDroppableDragOverChange:"tuiDroppableDragOverChange"},features:[C._Bn([Se.a3])]}),e})(),je=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=C.oAB({type:e}),e.\u0275inj=C.cJS({}),e})();var Ee=Q(160),$e=Q(4226),Fe=Q(6470),st=Q(7007),qe=Q(2423),at=Q(5351),We=Q(9502),Cn=Q(5974),de=Q(713),B=Q(5777),G=Q(8159),ee=Q(8289),se=Q(4050),he=Q(9098),ve=Q(9313),He=Q(2694),Pe=Q(6268),ot=Q(5140),Xe=Q(8725),kt=Q(5618);function zt(e,n){return void 0===n?null:n<1024?`${n} ${e[0]}`:n<1048576?`${(n/1024).toFixed(0)} ${e[1]}`:`${(0,kt.FG)(n/1048576,2).toLocaleString("ru-RU")} ${e[2]}`}var Ct=Q(8442),Jt=Q(1209),Xt=Q(6254),hn=Q(2744);let Kt=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=C.oAB({type:e}),e.\u0275inj=C.cJS({}),e})();(0,Me.JN)({formatSize:zt,icons:{normal:({$implicit:e})=>"l"===e?"tuiIconFileLarge":"tuiIconCheckCircleLarge",error:"tuiIconAlertCircleLarge",deleted:"tuiIconTrashLarge"}});let L=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=C.oAB({type:e}),e.\u0275inj=C.cJS({imports:[[Te.ez,ot.n6,He.dS,Xt.wq,ve.EI,de.c,Pe.fN,hn.H,Ye.ij,Kt]]}),e})();const W=["input"],q=["formatRejection"],pe=["maxSizeRejection"];function ge(e,n){1&e&&C.GkF(0)}function Ge(e,n){if(1&e&&(C.ynx(0),C._uU(1),C.BQk()),2&e){const t=n.polymorpheusOutlet;C.xp6(1),C.hij(" ",t," ")}}function mn(e,n){1&e&&C._UZ(0,"span",10),2&e&&C.Q6J("textContent",n.polymorpheusOutlet)}function yn(e,n){if(1&e&&(C.TgZ(0,"div")(1,"a",7),C.YNc(2,Ge,2,1,"ng-container",8),C.ALo(3,"async"),C.qZA(),C.YNc(4,mn,1,1,"span",9),C.ALo(5,"async"),C.qZA()),2&e){const t=C.oxw();C.xp6(2),C.Q6J("polymorpheusOutlet",C.lcZ(3,2,t.computedLink$)),C.xp6(2),C.Q6J("polymorpheusOutlet",C.lcZ(5,4,t.computedLabel$))}}function Ci(e,n){if(1&e&&(C.ynx(0),C.Hsn(1),C._UZ(2,"input",11,12),C.BQk()),2&e){const t=C.oxw();C.xp6(2),C.Q6J("accept",t.accept)("id",t.id)("multiple",t.multiple)("tuiFocusable",t.focusable)}}function Xn(e,n){if(1&e&&(C._uU(0),C.ALo(1,"async")),2&e){const t=C.oxw();let i;C.hij(" ",(null==(i=C.lcZ(1,1,t.inputFileTexts$))?null:i.formatRejectionReason)||"","\n")}}function Bn(e,n){if(1&e&&(C._uU(0),C.ALo(1,"async"),C.ALo(2,"tuiMaxSizeRejectionError")),2&e){const t=C.oxw();C.hij(" ",C.lcZ(1,1,C.lcZ(2,3,t.maxFileSize)),"\n")}}const _o=[[["input"]]],To=function(e){return{$implicit:e}},ei=(0,Me.JN)({capture:null,accepts:"",multiple:!1,size:"m",maxFileSize:31457280});let zi=(()=>{class e{constructor(t,i,r,h){this.host=t,this.el=i,this.idService=r,this.options=h}get tabIndex(){return this.host.focusable?0:-1}get id(){return this.el.nativeElement.id||this.idService.generate()}get accept(){var t;return null!==(t=this.el.nativeElement.accept)&&void 0!==t?t:this.options.accepts}get multiple(){var t;return null!==(t=this.el.nativeElement.multiple)&&void 0!==t?t:this.options.multiple}get capture(){var t;return null!==(t=this.el.nativeElement.getAttribute("capture"))&&void 0!==t?t:this.options.capture}get input(){return this.el.nativeElement}}return e.\u0275fac=function(t){return new(t||e)(C.Y36((0,C.Gpc)(()=>on)),C.Y36(C.SBq),C.Y36(Se.ll),C.Y36(ei))},e.\u0275dir=C.lG2({type:e,selectors:[["input","tuiInputFiles",""]],hostAttrs:["type","file",1,"t-native"],hostVars:5,hostBindings:function(t,i){2&t&&(C.Ikx("tabIndex",i.tabIndex)("id",i.id)("accept",i.accept)("multiple",i.multiple),C.uIk("capture",i.capture))}}),e})(),ti=(()=>{class e{constructor(t,i){this.inputFileTexts$=t,this.units$=i}transform(t){return(0,Ct.a)([this.inputFileTexts$,this.units$]).pipe((0,ze.U)(([{maxSizeRejectionReason:i},r])=>`${i}${zt(r,t)}`))}}return e.\u0275fac=function(t){return new(t||e)(C.Y36(Xe.BV,16),C.Y36(Xe.rV,16))},e.\u0275pipe=C.Yjl({name:"tuiMaxSizeRejectionError",type:e,pure:!0}),e})(),on=(()=>{class e extends $e.F9{constructor(t,i,r,h,_){super(t,i),this.isMobile=r,this.inputFileTexts$=h,this.options=_,this.dataTransfer=null,this.accept=this.options.accepts,this.multiple=this.options.multiple,this.size=this.options.size,this.maxFileSize=this.options.maxFileSize,this.reject=new C.vpe}get computedMultiple(){var t,i;return null!==(i=null===(t=this.nativeInput)||void 0===t?void 0:t.multiple)&&void 0!==i?i:this.multiple}get computedAccept(){var t,i;return null!==(i=null===(t=this.nativeInput)||void 0===t?void 0:t.accept)&&void 0!==i?i:this.accept}get nativeFocusableElement(){var t;return(null===(t=this.input)||void 0===t?void 0:t.nativeElement)||null}get focused(){return(0,Fe.V8)(this.nativeFocusableElement)}get computedPseudoHovered(){var t;return null!==(t=this.pseudoHover)&&void 0!==t?t:this.fileDragged||null}get computedLink$(){return this.computeLink$(this.fileDragged,this.computedMultiple,this.link)}get computedLabel$(){return this.computeLabel$(this.isMobile,this.fileDragged,this.computedMultiple,this.label)}get fileDragged(){var t;return!(null===(t=this.dataTransfer)||void 0===t||!t.types.includes("Files"))}get arrayValue(){return this.getValueArray(this.value)}onFocused(t){this.updateFocused(t)}onFilesSelected(){var t,i,r;const h=null!==(i=null===(t=this.nativeInput)||void 0===t?void 0:t.input)&&void 0!==i?i:null===(r=this.input)||void 0===r?void 0:r.nativeElement;h&&(this.processSelectedFiles(h.files),h.value="")}onDropped(t){this.processSelectedFiles(t.files)}onDragOver(t){this.dataTransfer=t}removeFile(t){this.value=this.computedMultiple?this.arrayValue.filter(i=>i!==t):null}computeLink$(t,i,r){return t?(0,Jt.of)(""):this.inputFileTexts$.pipe((0,ze.U)(h=>i&&!r?h.defaultLinkMultiple:r||h.defaultLinkSingle))}computeLabel$(t,i,r,h){return t?(0,Jt.of)(""):this.inputFileTexts$.pipe((0,ze.U)(i?_=>r?_.dropMultiple:_.drop:_=>r&&!h?_.defaultLabelMultiple:h||_.defaultLabelSingle))}getValueArray(t){return t?Array.isArray(t)?t:[t]:st.LZ}processSelectedFiles(t){if(null==t||!t.length)return;const i={formatRejection:this.formatRejection,maxSizeRejection:this.maxSizeRejection},r=this.computedMultiple?Array.from(t):[t[0]],h=r.filter(I=>I.size>this.maxFileSize),_=r.filter(I=>!this.isFormatAcceptable(I)&&!h.includes(I)),E=r.filter(I=>!h.includes(I)&&!_.includes(I));(h.length||_.length)&&this.rejectFiles([...h.map(I=>({name:I.name,type:I.type,size:I.size,content:i.maxSizeRejection})),..._.map(I=>({name:I.name,type:I.type,size:I.size,content:i.formatRejection}))]),this.value=this.computedMultiple?[...this.arrayValue,...E]:E[0]||null}isFormatAcceptable(t){if(!this.computedAccept)return!0;const i=`.${(t.name.split(".").pop()||"").toLowerCase()}`;return function At(e){return e.toLowerCase().split(",").map(n=>n.trim())}(this.computedAccept).some(r=>r===i||r===t.type||"*"===r.split("/")[1]&&t.type.split("/")[0]===r.split("/")[0])}rejectFiles(t){this.reject.emit(this.computedMultiple?t:t[0])}}return e.\u0275fac=function(t){return new(t||e)(C.Y36(Ne.a5,10),C.Y36(C.sBO),C.Y36(qe.fL),C.Y36(Xe.BV),C.Y36(ei))},e.\u0275cmp=C.Xpm({type:e,selectors:[["tui-input-files"]],contentQueries:function(t,i,r){if(1&t&&(C.Suo(r,zi,5),C.Suo(r,C.Rgc,5)),2&t){let h;C.iGM(h=C.CRH())&&(i.nativeInput=h.first),C.iGM(h=C.CRH())&&(i.template=h.first)}},viewQuery:function(t,i){if(1&t&&(C.Gf(W,5),C.Gf(q,5),C.Gf(pe,5)),2&t){let r;C.iGM(r=C.CRH())&&(i.input=r.first),C.iGM(r=C.CRH())&&(i.formatRejection=r.first),C.iGM(r=C.CRH())&&(i.maxSizeRejection=r.first)}},hostBindings:function(t,i){1&t&&C.NdJ("focusin",function(){return i.onFocused(!0)})("focusout",function(){return i.onFocused(!1)})("change",function(){return i.onFilesSelected()})},inputs:{link:"link",label:"label",accept:"accept",multiple:"multiple",size:"size",maxFileSize:"maxFileSize"},outputs:{reject:"reject"},features:[C._Bn([he.CV,(0,qe.FT)(e)]),C.qOj],ngContentSelectors:W,decls:10,vars:12,consts:[["appearance","input-file","tuiWrapper","",1,"t-wrapper",3,"active","disabled","focus","hover"],["automation-id","tui-input-file__label",1,"t-label",3,"mousedown.prevent.silent","tuiDroppableDragOverChange","tuiDroppableDropped"],[1,"t-description"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[4,"ngIf"],["formatRejection",""],["maxSizeRejection",""],["tuiLink",""],[4,"polymorpheusOutlet"],[3,"textContent",4,"polymorpheusOutlet"],[3,"textContent"],["title","","type","file",1,"t-native",3,"accept","id","multiple","tuiFocusable"],["input",""]],template:function(t,i){1&t&&(C.F$t(_o),C.TgZ(0,"div",0)(1,"label",1),C.NdJ("mousedown.prevent.silent",function(){return 0})("tuiDroppableDragOverChange",function(h){return i.onDragOver(h)})("tuiDroppableDropped",function(h){return i.onDropped(h)}),C.TgZ(2,"div",2),C.YNc(3,ge,1,0,"ng-container",3),C.YNc(4,yn,6,6,"div",4),C.qZA(),C.YNc(5,Ci,4,4,"ng-container",4),C.qZA()(),C.YNc(6,Xn,2,3,"ng-template",null,5,C.W1O),C.YNc(8,Bn,3,5,"ng-template",null,6,C.W1O)),2&t&&(C.ekj("_mobile",i.isMobile),C.Q6J("active",i.pseudoActive)("disabled",i.computedDisabled)("focus",i.computedFocused)("hover",i.pseudoHover||i.fileDragged||null),C.xp6(3),C.Q6J("ngTemplateOutlet",i.template||null)("ngTemplateOutletContext",C.VKq(10,To,i.fileDragged)),C.xp6(1),C.Q6J("ngIf",!i.template),C.xp6(1),C.Q6J("ngIf",!i.readOnly&&!i.computedDisabled))},dependencies:[ee.V,se.o,De,Te.tP,Te.O5,Xt.Li,Ee.t,Te.Ov,ti],styles:['tui-input-files{display:block;min-height:var(--tui-height-l);border-radius:var(--tui-radius-m);font:var(--tui-font-text-m)}tui-input-files .t-native{position:absolute;top:0;left:0;width:100%;height:100%;opacity:0;cursor:pointer}tui-input-files .t-native::-webkit-file-upload-button{display:none}tui-input-files .t-native+.t-native{display:none}tui-input-files .t-label{width:100%;min-height:inherit;text-align:center}tui-input-files .t-description{display:flex;justify-content:center;align-items:center;height:100%;min-height:inherit;padding:1rem 0;box-sizing:border-box}[tuiWrapper][data-appearance=input-file]{background:transparent;word-wrap:break-word;color:var(--tui-text-02);min-height:inherit;border-radius:inherit;padding:0 .5rem;box-sizing:border-box}[tuiWrapper][data-appearance=input-file]:after{border:1px dashed;color:var(--tui-link)}[tuiWrapper][data-appearance=input-file]._mobile:after{border:1px solid}[tuiWrapper][data-appearance=input-file]:disabled:disabled:after,[tuiWrapper][data-appearance=input-file][data-state=disabled][data-state=disabled]:after{color:var(--tui-text-03)}:focus-visible:not([data-focused="false"])>[tuiWrapper][data-appearance=input-file]:after,[data-focused=true]>[tuiWrapper][data-appearance=input-file]:after{border-style:solid;border-width:2px;color:var(--tui-focus)}[tuiWrapper][data-appearance=input-file]:focus-visible:focus-visible:after{border-style:solid;border-width:2px;color:var(--tui-focus)}[tuiWrapper][data-appearance=input-file]._focused._focused:after{border-style:solid;border-width:2px;color:var(--tui-focus)}[tuiWrapper][data-appearance=input-file][data-mode=onDark]{color:var(--tui-text-01-night)}[tuiWrapper][data-appearance=input-file][data-mode=onDark]:after{color:var(--tui-text-01-night)}:focus-visible:not([data-focused="false"])>[tuiWrapper][data-appearance=input-file][data-mode=onDark]:after,[data-focused=true]>[tuiWrapper][data-appearance=input-file][data-mode=onDark]:after{color:var(--tui-text-01-night)}[tuiWrapper][data-appearance=input-file][data-mode=onDark]:focus-visible:focus-visible:after{color:var(--tui-text-01-night)}[tuiWrapper][data-appearance=input-file][data-mode=onDark]._focused._focused:after{color:var(--tui-text-01-night)}@media (hover: hover){[tuiWrapper][data-appearance=input-file][data-mode=onDark]:hover:not(._no-hover),[tuiWrapper][data-appearance=input-file][data-mode=onDark][data-state=hover]{background:var(--tui-clear-inverse-hover)}[tuiWrapper][data-appearance=input-file][data-mode=onDark]:hover:not(._no-hover):after,[tuiWrapper][data-appearance=input-file][data-mode=onDark][data-state=hover]:after{color:var(--tui-text-03-night)}}[tuiWrapper][data-appearance=input-file][data-mode=onDark]:active:not(._no-active),[tuiWrapper][data-appearance=input-file][data-mode=onDark][data-state=active],[tuiWrapper][data-appearance=input-file][data-mode=onDark][data-state=active]:hover{background:var(--tui-clear-inverse-active)}[tuiWrapper][data-appearance=input-file][data-mode=onDark]:active:not(._no-active):after,[tuiWrapper][data-appearance=input-file][data-mode=onDark][data-state=active]:after,[tuiWrapper][data-appearance=input-file][data-mode=onDark][data-state=active]:hover:after{color:var(--tui-text-03-night)}[tuiWrapper][data-appearance=input-file][data-mode=onLight]{color:var(--tui-text-01)}[tuiWrapper][data-appearance=input-file][data-mode=onLight]:after{color:var(--tui-text-01)}@media (hover: hover){[tuiWrapper][data-appearance=input-file][data-mode=onLight]:hover:not(._no-hover),[tuiWrapper][data-appearance=input-file][data-mode=onLight][data-state=hover]{background:var(--tui-clear-hover)}[tuiWrapper][data-appearance=input-file][data-mode=onLight]:hover:not(._no-hover):after,[tuiWrapper][data-appearance=input-file][data-mode=onLight][data-state=hover]:after{color:var(--tui-text-03)}}[tuiWrapper][data-appearance=input-file][data-mode=onLight]:active:not(._no-active),[tuiWrapper][data-appearance=input-file][data-mode=onLight][data-state=active],[tuiWrapper][data-appearance=input-file][data-mode=onLight][data-state=active]:hover{background:var(--tui-clear-active)}[tuiWrapper][data-appearance=input-file][data-mode=onLight]:active:not(._no-active):after,[tuiWrapper][data-appearance=input-file][data-mode=onLight][data-state=active]:after,[tuiWrapper][data-appearance=input-file][data-mode=onLight][data-state=active]:hover:after{color:var(--tui-text-03)}@media (hover: hover){[tuiWrapper][data-appearance=input-file]:hover:not(._no-hover),[tuiWrapper][data-appearance=input-file][data-state=hover]{background:var(--tui-secondary)}[tuiWrapper][data-appearance=input-file]:hover:not(._no-hover):after,[tuiWrapper][data-appearance=input-file][data-state=hover]:after{color:var(--tui-link-hover)}}[tuiWrapper][data-appearance=input-file]:active:not(._no-active),[tuiWrapper][data-appearance=input-file][data-state=active],[tuiWrapper][data-appearance=input-file][data-state=active]:hover{background:var(--tui-secondary-hover)}\n'],encapsulation:2,changeDetection:0}),(0,Ae.gn)([at.UM],e.prototype,"computeLink$",null),(0,Ae.gn)([at.UM],e.prototype,"computeLabel$",null),(0,Ae.gn)([at.UM],e.prototype,"getValueArray",null),e})(),Mt=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=C.oAB({type:e}),e.\u0275inj=C.cJS({imports:[[Te.ez,Xt.wq,We.WD,Cn.F,de.c,B.f,G.VE,Ee.u,je,se.W,ve.EI,ee.j,He.dS,Pe.fN,ot.n6,L]]}),e})();var zn=Q(5760),ct=Q(4419),ni=Q(4882),yi=Q(5909),$i=(Q(8748),Q(8132)),Vi=Q(5484),Co=Q(9401),$n=(Q(1813),Q(530),Q(3232)),vi=Q(806);function pt(e,n,t,i){const r=(i+e/60)%6;return Math.round(t-t*n*Math.max(Math.min(r,4-r,1),0))}function Ji(e,n,t){return[pt(e,n,t,5),pt(e,n,t,3),pt(e,n,t,1)]}const Vn=[0,0,0,1];function xn(e){const n=e.replace("#","").replace("rgba(","").replace("rgb(","").replace(")",""),t=n.split(",").map(h=>parseFloat(h));if(4===t.length)return t;if(3===t.length)return t.concat(1);const i=n.match(new RegExp(`(.{${n.length/3}})`,"g"));if(!i)return Vn;const r=i.map(h=>parseInt(n.length%2?h+h:h,16));return[r[0]||Vn[0],r[1]||Vn[1],r[2]||Vn[2],void 0===r[3]?Vn[3]:r[3]]}Q(963),Q(4087);var Si=Q(6851),Nt=Q(8397),Lt=Q(9015),bt=Q(2250),wn=Q(5243),Mi=Q(7383),Zi=Q(24),Ei=Q(3309),Sn=Q(2597),ie=(Q(3740),Q(9911));const Oi=/^\s*>\s$/,Qi=ie.Node.create({name:"blockquote",addOptions:()=>({HTMLAttributes:{}}),content:"block+",group:"block",defining:!0,parseHTML:()=>[{tag:"blockquote"}],renderHTML({HTMLAttributes:e}){return["blockquote",(0,ie.mergeAttributes)(this.options.HTMLAttributes,e),0]},addCommands(){return{setBlockquote:()=>({commands:e})=>e.wrapIn(this.name),toggleBlockquote:()=>({commands:e})=>e.toggleWrap(this.name),unsetBlockquote:()=>({commands:e})=>e.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[(0,ie.wrappingInputRule)({find:Oi,type:this.type})]}}),qi=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))$/,ri=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))/g,Xi=/(?:^|\s)((?:__)((?:[^__]+))(?:__))$/,vo=/(?:^|\s)((?:__)((?:[^__]+))(?:__))/g,Mn=ie.Mark.create({name:"bold",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"strong"},{tag:"b",getAttrs:e=>"normal"!==e.style.fontWeight&&null},{style:"font-weight",getAttrs:e=>/^(bold(er)?|[5-9]\d{2,})$/.test(e)&&null}],renderHTML({HTMLAttributes:e}){return["strong",(0,ie.mergeAttributes)(this.options.HTMLAttributes,e),0]},addCommands(){return{setBold:()=>({commands:e})=>e.setMark(this.name),toggleBold:()=>({commands:e})=>e.toggleMark(this.name),unsetBold:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[(0,ie.markInputRule)({find:qi,type:this.type}),(0,ie.markInputRule)({find:Xi,type:this.type})]},addPasteRules(){return[(0,ie.markPasteRule)({find:ri,type:this.type}),(0,ie.markPasteRule)({find:vo,type:this.type})]}}),xo=ie.Node.create({name:"listItem",addOptions:()=>({HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}),content:"paragraph block*",defining:!0,parseHTML:()=>[{tag:"li"}],renderHTML({HTMLAttributes:e}){return["li",(0,ie.mergeAttributes)(this.options.HTMLAttributes,e),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),ft=ie.Mark.create({name:"textStyle",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"span",getAttrs:e=>!!e.hasAttribute("style")&&{}}],renderHTML({HTMLAttributes:e}){return["span",(0,ie.mergeAttributes)(this.options.HTMLAttributes,e),0]},addCommands(){return{removeEmptyTextStyle:()=>({state:e,commands:n})=>{const t=(0,ie.getMarkAttributes)(e,this.type);return!!Object.entries(t).some(([,r])=>!!r)||n.unsetMark(this.name)}}}}),ht=/^\s*([-+*])\s$/,ko=ie.Node.create({name:"bulletList",addOptions:()=>({itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}),group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML:()=>[{tag:"ul"}],renderHTML({HTMLAttributes:e}){return["ul",(0,ie.mergeAttributes)(this.options.HTMLAttributes,e),0]},addCommands(){return{toggleBulletList:()=>({commands:e,chain:n})=>this.options.keepAttributes?n().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(xo.name,this.editor.getAttributes(ft.name)).run():e.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let e=(0,ie.wrappingInputRule)({find:ht,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(e=(0,ie.wrappingInputRule)({find:ht,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(ft.name),editor:this.editor})),[e]}}),Un=/(?:^|\s)((?:`)((?:[^`]+))(?:`))$/,Ai=/(?:^|\s)((?:`)((?:[^`]+))(?:`))/g,sn=ie.Mark.create({name:"code",addOptions:()=>({HTMLAttributes:{}}),excludes:"_",code:!0,exitable:!0,parseHTML:()=>[{tag:"code"}],renderHTML({HTMLAttributes:e}){return["code",(0,ie.mergeAttributes)(this.options.HTMLAttributes,e),0]},addCommands(){return{setCode:()=>({commands:e})=>e.setMark(this.name),toggleCode:()=>({commands:e})=>e.toggleMark(this.name),unsetCode:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[(0,ie.markInputRule)({find:Un,type:this.type})]},addPasteRules(){return[(0,ie.markPasteRule)({find:Ai,type:this.type})]}});var ye=Q(7825);const Ii=/^```([a-z]+)?[\s\n]$/,Di=/^~~~([a-z]+)?[\s\n]$/,wo=ie.Node.create({name:"codeBlock",addOptions:()=>({languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,HTMLAttributes:{}}),content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:null,parseHTML:e=>{var n;const{languageClassPrefix:t}=this.options;return[...(null===(n=e.firstElementChild)||void 0===n?void 0:n.classList)||[]].filter(_=>_.startsWith(t)).map(_=>_.replace(t,""))[0]||null},rendered:!1}}},parseHTML:()=>[{tag:"pre",preserveWhitespace:"full"}],renderHTML({node:e,HTMLAttributes:n}){return["pre",(0,ie.mergeAttributes)(this.options.HTMLAttributes,n),["code",{class:e.attrs.language?this.options.languageClassPrefix+e.attrs.language:null},0]]},addCommands(){return{setCodeBlock:e=>({commands:n})=>n.setNode(this.name,e),toggleCodeBlock:e=>({commands:n})=>n.toggleNode(this.name,"paragraph",e)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:e,$anchor:n}=this.editor.state.selection;return!(!e||n.parent.type.name!==this.name)&&!(1!==n.pos&&n.parent.textContent.length)&&this.editor.commands.clearNodes()},Enter:({editor:e})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:n}=e,{selection:t}=n,{$from:i,empty:r}=t;if(!r||i.parent.type!==this.type)return!1;const h=i.parentOffset===i.parent.nodeSize-2,_=i.parent.textContent.endsWith("\n\n");return!(!h||!_)&&e.chain().command(({tr:E})=>(E.delete(i.pos-2,i.pos),!0)).exitCode().run()},ArrowDown:({editor:e})=>{if(!this.options.exitOnArrowDown)return!1;const{state:n}=e,{selection:t,doc:i}=n,{$from:r,empty:h}=t;if(!h||r.parent.type!==this.type||r.parentOffset!==r.parent.nodeSize-2)return!1;const E=r.after();return void 0!==E&&!i.nodeAt(E)&&e.commands.exitCode()}}},addInputRules(){return[(0,ie.textblockTypeInputRule)({find:Ii,type:this.type,getAttributes:e=>({language:e[1]})}),(0,ie.textblockTypeInputRule)({find:Di,type:this.type,getAttributes:e=>({language:e[1]})})]},addProseMirrorPlugins(){return[new ye.Sy({key:new ye.H$("codeBlockVSCodeHandler"),props:{handlePaste:(e,n)=>{if(!n.clipboardData||this.editor.isActive(this.type.name))return!1;const t=n.clipboardData.getData("text/plain"),i=n.clipboardData.getData("vscode-editor-data"),r=i?JSON.parse(i):void 0,h=null==r?void 0:r.mode;if(!t||!h)return!1;const{tr:_}=e.state;return _.replaceSelectionWith(this.type.create({language:h})),_.setSelection(ye.Bs.near(_.doc.resolve(Math.max(0,_.selection.from-2)))),_.insertText(t.replace(/\r\n?/g,"\n")),_.setMeta("paste",!0),e.dispatch(_),!0}}})]}}),So=ie.Node.create({name:"doc",topNode:!0,content:"block+"});var En=Q(2938);function Mo(e={}){return new ye.Sy({view:n=>new jn(n,e)})}class jn{constructor(n,t){var i;this.editorView=n,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=null!==(i=t.width)&&void 0!==i?i:1,this.color=!1===t.color?void 0:t.color||"black",this.class=t.class,this.handlers=["dragover","dragend","drop","dragleave"].map(r=>{let h=_=>{this[r](_)};return n.dom.addEventListener(r,h),{name:r,handler:h}})}destroy(){this.handlers.forEach(({name:n,handler:t})=>this.editorView.dom.removeEventListener(n,t))}update(n,t){null!=this.cursorPos&&t.doc!=n.state.doc&&(this.cursorPos>n.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(n){n!=this.cursorPos&&(this.cursorPos=n,null==n?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let i,n=this.editorView.state.doc.resolve(this.cursorPos),t=!n.parent.inlineContent;if(t){let E=n.nodeBefore,I=n.nodeAfter;if(E||I){let N=this.editorView.nodeDOM(this.cursorPos-(E?E.nodeSize:0));if(N){let j=N.getBoundingClientRect(),U=E?j.bottom:j.top;E&&I&&(U=(U+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2),i={left:j.left,right:j.right,top:U-this.width/2,bottom:U+this.width/2}}}}if(!i){let E=this.editorView.coordsAtPos(this.cursorPos);i={left:E.left-this.width/2,right:E.left+this.width/2,top:E.top,bottom:E.bottom}}let h,_,r=this.editorView.dom.offsetParent;if(this.element||(this.element=r.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",t),this.element.classList.toggle("prosemirror-dropcursor-inline",!t),!r||r==document.body&&"static"==getComputedStyle(r).position)h=-pageXOffset,_=-pageYOffset;else{let E=r.getBoundingClientRect();h=E.left-r.scrollLeft,_=E.top-r.scrollTop}this.element.style.left=i.left-h+"px",this.element.style.top=i.top-_+"px",this.element.style.width=i.right-i.left+"px",this.element.style.height=i.bottom-i.top+"px"}scheduleRemoval(n){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),n)}dragover(n){if(!this.editorView.editable)return;let t=this.editorView.posAtCoords({left:n.clientX,top:n.clientY}),i=t&&t.inside>=0&&this.editorView.state.doc.nodeAt(t.inside),r=i&&i.type.spec.disableDropCursor,h="function"==typeof r?r(this.editorView,t,n):r;if(t&&!h){let _=t.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let E=(0,En.nj)(this.editorView.state.doc,_,this.editorView.dragging.slice);null!=E&&(_=E)}this.setCursor(_),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(n){(n.target==this.editorView.dom||!this.editorView.dom.contains(n.relatedTarget))&&this.setCursor(null)}}const On=ie.Extension.create({name:"dropCursor",addOptions:()=>({color:"currentColor",width:1,class:void 0}),addProseMirrorPlugins(){return[Mo(this.options)]}});var si=Q(3861),Ke=Q(7834),ln=Q(7387);class Ze extends ye.Y1{constructor(n){super(n,n)}map(n,t){let i=n.resolve(t.map(this.head));return Ze.valid(i)?new Ze(i):ye.Y1.near(i)}content(){return Ke.p2.empty}eq(n){return n instanceof Ze&&n.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(n,t){if("number"!=typeof t.pos)throw new RangeError("Invalid input for GapCursor.fromJSON");return new Ze(n.resolve(t.pos))}getBookmark(){return new Pi(this.anchor)}static valid(n){let t=n.parent;if(t.isTextblock||!function eo(e){for(let n=e.depth;n>=0;n--){let t=e.index(n),i=e.node(n);if(0!=t)for(let r=i.child(t-1);;r=r.lastChild){if(0==r.childCount&&!r.inlineContent||r.isAtom||r.type.spec.isolating)return!0;if(r.inlineContent)return!1}else if(i.type.spec.isolating)return!0}return!0}(n)||!function gn(e){for(let n=e.depth;n>=0;n--){let t=e.indexAfter(n),i=e.node(n);if(t!=i.childCount)for(let r=i.child(t);;r=r.firstChild){if(0==r.childCount&&!r.inlineContent||r.isAtom||r.type.spec.isolating)return!0;if(r.inlineContent)return!1}else if(i.type.spec.isolating)return!0}return!0}(n))return!1;let i=t.type.spec.allowGapCursor;if(null!=i)return i;let r=t.contentMatchAt(n.index()).defaultType;return r&&r.isTextblock}static findGapCursorFrom(n,t,i=!1){e:for(;;){if(!i&&Ze.valid(n))return n;let r=n.pos,h=null;for(let _=n.depth;;_--){let E=n.node(_);if(t>0?n.indexAfter(_)<E.childCount:n.index(_)>0){h=E.child(t>0?n.indexAfter(_):n.index(_)-1);break}if(0==_)return null;r+=t;let I=n.doc.resolve(r);if(Ze.valid(I))return I}for(;;){let _=t>0?h.firstChild:h.lastChild;if(!_){if(h.isAtom&&!h.isText&&!ye.qv.isSelectable(h)){n=n.doc.resolve(r+h.nodeSize*t),i=!1;continue e}break}h=_,r+=t;let E=n.doc.resolve(r);if(Ze.valid(E))return E}return null}}}Ze.prototype.visible=!1,Ze.findFrom=Ze.findGapCursorFrom,ye.Y1.jsonID("gapcursor",Ze);class Pi{constructor(n){this.pos=n}map(n){return new Pi(n.map(this.pos))}resolve(n){let t=n.resolve(this.pos);return Ze.valid(t)?new Ze(t):ye.Y1.near(t)}}const ai=(0,si.$)({ArrowLeft:Wn("horiz",-1),ArrowRight:Wn("horiz",1),ArrowUp:Wn("vert",-1),ArrowDown:Wn("vert",1)});function Wn(e,n){const t="vert"==e?n>0?"down":"up":n>0?"right":"left";return function(i,r,h){let _=i.selection,E=n>0?_.$to:_.$from,I=_.empty;if(_ instanceof ye.Bs){if(!h.endOfTextblock(t)||0==E.depth)return!1;I=!1,E=i.doc.resolve(n>0?E.after():E.before())}let N=Ze.findGapCursorFrom(E,n,I);return!!N&&(r&&r(i.tr.setSelection(new Ze(N))),!0)}}function Eo(e,n,t){if(!e||!e.editable)return!1;let i=e.state.doc.resolve(n);if(!Ze.valid(i))return!1;let r=e.posAtCoords({left:t.clientX,top:t.clientY});return!(r&&r.inside>-1&&ye.qv.isSelectable(e.state.doc.nodeAt(r.inside))||(e.dispatch(e.state.tr.setSelection(new Ze(i))),0))}function ci(e,n){if("insertCompositionText"!=n.inputType||!(e.state.selection instanceof Ze))return!1;let{$from:t}=e.state.selection,i=t.parent.contentMatchAt(t.index()).findWrapping(e.state.schema.nodes.text);if(!i)return!1;let r=Ke.HY.empty;for(let _=i.length-1;_>=0;_--)r=Ke.HY.from(i[_].createAndFill(null,r));let h=e.state.tr.replace(t.pos,t.pos,new Ke.p2(r,0,0));return h.setSelection(ye.Bs.near(h.doc.resolve(t.pos+1))),e.dispatch(h),!1}function to(e){if(!(e.selection instanceof Ze))return null;let n=document.createElement("div");return n.className="ProseMirror-gapcursor",ln.EH.create(e.doc,[ln.p.widget(e.selection.head,n,{key:"gapcursor"})])}const no=ie.Extension.create({name:"gapCursor",addProseMirrorPlugins:()=>[new ye.Sy({props:{decorations:to,createSelectionBetween:(e,n,t)=>n.pos==t.pos&&Ze.valid(t)?new Ze(t):null,handleClick:Eo,handleKeyDown:ai,handleDOMEvents:{beforeinput:ci}}})],extendNodeSchema(e){var n;return{allowGapCursor:null!==(n=(0,ie.callOrReturn)((0,ie.getExtensionField)(e,"allowGapCursor",{name:e.name,options:e.options,storage:e.storage})))&&void 0!==n?n:null}}}),Jn=ie.Node.create({name:"hardBreak",addOptions:()=>({keepMarks:!0,HTMLAttributes:{}}),inline:!0,group:"inline",selectable:!1,parseHTML:()=>[{tag:"br"}],renderHTML({HTMLAttributes:e}){return["br",(0,ie.mergeAttributes)(this.options.HTMLAttributes,e)]},renderText:()=>"\n",addCommands(){return{setHardBreak:()=>({commands:e,chain:n,state:t,editor:i})=>e.first([()=>e.exitCode(),()=>e.command(()=>{const{selection:r,storedMarks:h}=t;if(r.$from.parent.type.spec.isolating)return!1;const{keepMarks:_}=this.options,{splittableMarks:E}=i.extensionManager,I=h||r.$to.parentOffset&&r.$from.marks();return n().insertContent({type:this.name}).command(({tr:N,dispatch:j})=>{if(j&&I&&_){const U=I.filter(Y=>E.includes(Y.type.name));N.ensureMarks(U)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),io=ie.Node.create({name:"heading",addOptions:()=>({levels:[1,2,3,4,5,6],HTMLAttributes:{}}),content:"inline*",group:"block",defining:!0,addAttributes:()=>({level:{default:1,rendered:!1}}),parseHTML(){return this.options.levels.map(e=>({tag:`h${e}`,attrs:{level:e}}))},renderHTML({node:e,HTMLAttributes:n}){return[`h${this.options.levels.includes(e.attrs.level)?e.attrs.level:this.options.levels[0]}`,(0,ie.mergeAttributes)(this.options.HTMLAttributes,n),0]},addCommands(){return{setHeading:e=>({commands:n})=>!!this.options.levels.includes(e.level)&&n.setNode(this.name,e),toggleHeading:e=>({commands:n})=>!!this.options.levels.includes(e.level)&&n.toggleNode(this.name,"paragraph",e)}},addKeyboardShortcuts(){return this.options.levels.reduce((e,n)=>({...e,[`Mod-Alt-${n}`]:()=>this.editor.commands.toggleHeading({level:n})}),{})},addInputRules(){return this.options.levels.map(e=>(0,ie.textblockTypeInputRule)({find:new RegExp(`^(#{1,${e}})\\s$`),type:this.type,getAttributes:{level:e}}))}});var ut=function(){};ut.prototype.append=function(n){return n.length?(n=ut.from(n),!this.length&&n||n.length<200&&this.leafAppend(n)||this.length<200&&n.leafPrepend(this)||this.appendInner(n)):this},ut.prototype.prepend=function(n){return n.length?ut.from(n).append(this):this},ut.prototype.appendInner=function(n){return new _n(this,n)},ut.prototype.slice=function(n,t){return void 0===n&&(n=0),void 0===t&&(t=this.length),n>=t?ut.empty:this.sliceInner(Math.max(0,n),Math.min(this.length,t))},ut.prototype.get=function(n){if(!(n<0||n>=this.length))return this.getInner(n)},ut.prototype.forEach=function(n,t,i){void 0===t&&(t=0),void 0===i&&(i=this.length),t<=i?this.forEachInner(n,t,i,0):this.forEachInvertedInner(n,t,i,0)},ut.prototype.map=function(n,t,i){void 0===t&&(t=0),void 0===i&&(i=this.length);var r=[];return this.forEach(function(h,_){return r.push(n(h,_))},t,i),r},ut.from=function(n){return n instanceof ut?n:n&&n.length?new Ri(n):ut.empty};var Ri=function(e){function n(i){e.call(this),this.values=i}e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n;var t={length:{configurable:!0},depth:{configurable:!0}};return n.prototype.flatten=function(){return this.values},n.prototype.sliceInner=function(r,h){return 0==r&&h==this.length?this:new n(this.values.slice(r,h))},n.prototype.getInner=function(r){return this.values[r]},n.prototype.forEachInner=function(r,h,_,E){for(var I=h;I<_;I++)if(!1===r(this.values[I],E+I))return!1},n.prototype.forEachInvertedInner=function(r,h,_,E){for(var I=h-1;I>=_;I--)if(!1===r(this.values[I],E+I))return!1},n.prototype.leafAppend=function(r){if(this.length+r.length<=200)return new n(this.values.concat(r.flatten()))},n.prototype.leafPrepend=function(r){if(this.length+r.length<=200)return new n(r.flatten().concat(this.values))},t.length.get=function(){return this.values.length},t.depth.get=function(){return 0},Object.defineProperties(n.prototype,t),n}(ut);ut.empty=new Ri([]);var _n=function(e){function n(t,i){e.call(this),this.left=t,this.right=i,this.length=t.length+i.length,this.depth=Math.max(t.depth,i.depth)+1}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},n.prototype.getInner=function(i){return i<this.left.length?this.left.get(i):this.right.get(i-this.left.length)},n.prototype.forEachInner=function(i,r,h,_){var E=this.left.length;if(r<E&&!1===this.left.forEachInner(i,r,Math.min(h,E),_)||h>E&&!1===this.right.forEachInner(i,Math.max(r-E,0),Math.min(this.length,h)-E,_+E))return!1},n.prototype.forEachInvertedInner=function(i,r,h,_){var E=this.left.length;if(r>E&&!1===this.right.forEachInvertedInner(i,r-E,Math.max(h,E)-E,_+E)||h<E&&!1===this.left.forEachInvertedInner(i,Math.min(r,E),h,_))return!1},n.prototype.sliceInner=function(i,r){if(0==i&&r==this.length)return this;var h=this.left.length;return r<=h?this.left.slice(i,r):i>=h?this.right.slice(i-h,r-h):this.left.slice(i,h).append(this.right.slice(0,r-h))},n.prototype.leafAppend=function(i){var r=this.right.leafAppend(i);if(r)return new n(this.left,r)},n.prototype.leafPrepend=function(i){var r=this.left.leafPrepend(i);if(r)return new n(r,this.right)},n.prototype.appendInner=function(i){return this.left.depth>=Math.max(this.right.depth,i.depth)+1?new n(this.left,new n(this.right,i)):new n(this,i)},n}(ut);const Ni=ut;class gt{constructor(n,t){this.items=n,this.eventCount=t}popEvent(n,t){if(0==this.eventCount)return null;let r,h,i=this.items.length;for(;;i--)if(this.items.get(i-1).selection){--i;break}t&&(r=this.remapping(i,this.items.length),h=r.maps.length);let E,I,_=n.tr,N=[],j=[];return this.items.forEach((U,Y)=>{if(!U.step)return r||(r=this.remapping(i,Y+1),h=r.maps.length),h--,void j.push(U);if(r){j.push(new yt(U.map));let ae,oe=U.step.map(r.slice(h));oe&&_.maybeStep(oe).doc&&(ae=_.mapping.maps[_.mapping.maps.length-1],N.push(new yt(ae,void 0,void 0,N.length+j.length))),h--,ae&&r.appendMap(ae,h)}else _.maybeStep(U.step);return U.selection?(E=r?U.selection.map(r.slice(h)):U.selection,I=new gt(this.items.slice(0,i).append(j.reverse().concat(N)),this.eventCount-1),!1):void 0},this.items.length,0),{remaining:I,transform:_,selection:E}}addTransform(n,t,i,r){let h=[],_=this.eventCount,E=this.items,I=!r&&E.length?E.get(E.length-1):null;for(let j=0;j<n.steps.length;j++){let oe,U=n.steps[j].invert(n.docs[j]),Y=new yt(n.mapping.maps[j],U,t);(oe=I&&I.merge(Y))&&(Y=oe,j?h.pop():E=E.slice(0,E.length-1)),h.push(Y),t&&(_++,t=void 0),r||(I=Y)}let N=_-i.depth;return N>Kn&&(E=function In(e,n){let t;return e.forEach((i,r)=>{if(i.selection&&0==n--)return t=r,!1}),e.slice(t)}(E,N),_-=N),new gt(E.append(h),_)}remapping(n,t){let i=new En.vs;return this.items.forEach((r,h)=>{i.appendMap(r.map,null!=r.mirrorOffset&&h-r.mirrorOffset>=n?i.maps.length-r.mirrorOffset:void 0)},n,t),i}addMaps(n){return 0==this.eventCount?this:new gt(this.items.append(n.map(t=>new yt(t))),this.eventCount)}rebased(n,t){if(!this.eventCount)return this;let i=[],r=Math.max(0,this.items.length-t),h=n.mapping,_=n.steps.length,E=this.eventCount;this.items.forEach(Y=>{Y.selection&&E--},r);let I=t;this.items.forEach(Y=>{let oe=h.getMirror(--I);if(null==oe)return;_=Math.min(_,oe);let ae=h.maps[oe];if(Y.step){let we=n.steps[oe].invert(n.docs[oe]),be=Y.selection&&Y.selection.map(h.slice(I+1,oe));be&&E++,i.push(new yt(ae,we,be))}else i.push(new yt(ae))},r);let N=[];for(let Y=t;Y<_;Y++)N.push(new yt(h.maps[Y]));let j=this.items.slice(0,r).append(N).append(i),U=new gt(j,E);return U.emptyItemCount()>500&&(U=U.compress(this.items.length-i.length)),U}emptyItemCount(){let n=0;return this.items.forEach(t=>{t.step||n++}),n}compress(n=this.items.length){let t=this.remapping(0,n),i=t.maps.length,r=[],h=0;return this.items.forEach((_,E)=>{if(E>=n)r.push(_),_.selection&&h++;else if(_.step){let I=_.step.map(t.slice(i)),N=I&&I.getMap();if(i--,N&&t.appendMap(N,i),I){let j=_.selection&&_.selection.map(t.slice(i));j&&h++;let Y,U=new yt(N.invert(),I,j),oe=r.length-1;(Y=r.length&&r[oe].merge(U))?r[oe]=Y:r.push(U)}}else _.map&&i--},this.items.length,0),new gt(Ni.from(r.reverse()),h)}}gt.empty=new gt(Ni.empty,0);class yt{constructor(n,t,i,r){this.map=n,this.step=t,this.selection=i,this.mirrorOffset=r}merge(n){if(this.step&&n.step&&!n.selection){let t=n.step.merge(this.step);if(t)return new yt(t.getMap().invert(),t,this.selection)}}}class _t{constructor(n,t,i,r,h){this.done=n,this.undone=t,this.prevRanges=i,this.prevTime=r,this.prevComposition=h}}const Kn=20;function cn(e){let n=[];return e.forEach((t,i,r,h)=>n.push(r,h)),n}function et(e,n){if(!e)return null;let t=[];for(let i=0;i<e.length;i+=2){let r=n.map(e[i],1),h=n.map(e[i+1],-1);r<=h&&t.push(r,h)}return t}function dt(e,n,t,i){let r=Yn(n),h=Ht.get(n).spec.config,_=(i?e.undone:e.done).popEvent(n,r);if(!_)return;let E=_.selection.resolve(_.transform.doc),I=(i?e.done:e.undone).addTransform(_.transform,n.selection.getBookmark(),h,r),N=new _t(i?I:_.remaining,i?_.remaining:I,null,0,-1);t(_.transform.setSelection(E).setMeta(Ht,{redo:i,historyState:N}).scrollIntoView())}let Ut=!1,oo=null;function Yn(e){let n=e.plugins;if(oo!=n){Ut=!1,oo=n;for(let t=0;t<n.length;t++)if(n[t].spec.historyPreserveItems){Ut=!0;break}}return Ut}const Ht=new ye.H$("history"),ui=new ye.H$("closeHistory");function di(e={}){return new ye.Sy({key:Ht,state:{init:()=>new _t(gt.empty,gt.empty,null,0,-1),apply:(n,t,i)=>function vt(e,n,t,i){let h,r=t.getMeta(Ht);if(r)return r.historyState;t.getMeta(ui)&&(e=new _t(e.done,e.undone,null,0,-1));let _=t.getMeta("appendedTransaction");if(0==t.steps.length)return e;if(_&&_.getMeta(Ht))return _.getMeta(Ht).redo?new _t(e.done.addTransform(t,void 0,i,Yn(n)),e.undone,cn(t.mapping.maps[t.steps.length-1]),e.prevTime,e.prevComposition):new _t(e.done,e.undone.addTransform(t,void 0,i,Yn(n)),null,e.prevTime,e.prevComposition);if(!1===t.getMeta("addToHistory")||_&&!1===_.getMeta("addToHistory"))return(h=t.getMeta("rebased"))?new _t(e.done.rebased(t,h),e.undone.rebased(t,h),et(e.prevRanges,t.mapping),e.prevTime,e.prevComposition):new _t(e.done.addMaps(t.mapping.maps),e.undone.addMaps(t.mapping.maps),et(e.prevRanges,t.mapping),e.prevTime,e.prevComposition);{let E=t.getMeta("composition"),I=0==e.prevTime||!_&&e.prevComposition!=E&&(e.prevTime<(t.time||0)-i.newGroupDelay||!function Dn(e,n){if(!n)return!1;if(!e.docChanged)return!0;let t=!1;return e.mapping.maps[0].forEach((i,r)=>{for(let h=0;h<n.length;h+=2)i<=n[h+1]&&r>=n[h]&&(t=!0)}),t}(t,e.prevRanges)),N=_?et(e.prevRanges,t.mapping):cn(t.mapping.maps[t.steps.length-1]);return new _t(e.done.addTransform(t,I?n.selection.getBookmark():void 0,i,Yn(n)),gt.empty,N,t.time,E??e.prevComposition)}}(t,i,n,e)},config:e={depth:e.depth||100,newGroupDelay:e.newGroupDelay||500},props:{handleDOMEvents:{beforeinput(n,t){let i=t.inputType,r="historyUndo"==i?un:"historyRedo"==i?Pn:null;return!!r&&(t.preventDefault(),r(n.state,n.dispatch))}}}})}const un=(e,n)=>{let t=Ht.getState(e);return!(!t||0==t.done.eventCount||(n&&dt(t,e,n,!1),0))},Pn=(e,n)=>{let t=Ht.getState(e);return!(!t||0==t.undone.eventCount||(n&&dt(t,e,n,!0),0))},Ko=ie.Extension.create({name:"history",addOptions:()=>({depth:100,newGroupDelay:500}),addCommands:()=>({undo:()=>({state:e,dispatch:n})=>un(e,n),redo:()=>({state:e,dispatch:n})=>Pn(e,n)}),addProseMirrorPlugins(){return[di(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-\u044f":()=>this.editor.commands.undo(),"Shift-Mod-\u044f":()=>this.editor.commands.redo()}}}),Yo=ie.Node.create({name:"horizontalRule",addOptions:()=>({HTMLAttributes:{}}),group:"block",parseHTML:()=>[{tag:"hr"}],renderHTML({HTMLAttributes:e}){return["hr",(0,ie.mergeAttributes)(this.options.HTMLAttributes,e)]},addCommands(){return{setHorizontalRule:()=>({chain:e,state:n})=>{const{$to:t}=n.selection,i=e();return 0===t.parentOffset?i.insertContentAt(Math.max(t.pos-2,0),{type:this.name}):i.insertContent({type:this.name}),i.command(({tr:r,dispatch:h})=>{var _;if(h){const{$to:E}=r.selection,I=E.end();if(E.nodeAfter)r.setSelection(E.nodeAfter.isTextblock?ye.Bs.create(r.doc,E.pos+1):E.nodeAfter.isBlock?ye.qv.create(r.doc,E.pos):ye.Bs.create(r.doc,E.pos));else{const N=null===(_=E.parent.type.contentMatch.defaultType)||void 0===_?void 0:_.create();N&&(r.insert(I,N),r.setSelection(ye.Bs.create(r.doc,I+1)))}r.scrollIntoView()}return!0}).run()}}},addInputRules(){return[(0,ie.nodeInputRule)({find:/^(?:---|\u2014-|___\s|\*\*\*\s)$/,type:this.type})]}}),Go=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))$/,Zo=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))/g,Ao=/(?:^|\s)((?:_)((?:[^_]+))(?:_))$/,Io=/(?:^|\s)((?:_)((?:[^_]+))(?:_))/g,Qo=ie.Mark.create({name:"italic",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"em"},{tag:"i",getAttrs:e=>"normal"!==e.style.fontStyle&&null},{style:"font-style=italic"}],renderHTML({HTMLAttributes:e}){return["em",(0,ie.mergeAttributes)(this.options.HTMLAttributes,e),0]},addCommands(){return{setItalic:()=>({commands:e})=>e.setMark(this.name),toggleItalic:()=>({commands:e})=>e.toggleMark(this.name),unsetItalic:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[(0,ie.markInputRule)({find:Go,type:this.type}),(0,ie.markInputRule)({find:Ao,type:this.type})]},addPasteRules(){return[(0,ie.markPasteRule)({find:Zo,type:this.type}),(0,ie.markPasteRule)({find:Io,type:this.type})]}}),qo=ie.Node.create({name:"listItem",addOptions:()=>({HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}),content:"paragraph block*",defining:!0,parseHTML:()=>[{tag:"li"}],renderHTML({HTMLAttributes:e}){return["li",(0,ie.mergeAttributes)(this.options.HTMLAttributes,e),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),Xo=ie.Node.create({name:"listItem",addOptions:()=>({HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}),content:"paragraph block*",defining:!0,parseHTML:()=>[{tag:"li"}],renderHTML({HTMLAttributes:e}){return["li",(0,ie.mergeAttributes)(this.options.HTMLAttributes,e),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),ro=ie.Mark.create({name:"textStyle",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"span",getAttrs:e=>!!e.hasAttribute("style")&&{}}],renderHTML({HTMLAttributes:e}){return["span",(0,ie.mergeAttributes)(this.options.HTMLAttributes,e),0]},addCommands(){return{removeEmptyTextStyle:()=>({state:e,commands:n})=>{const t=(0,ie.getMarkAttributes)(e,this.type);return!!Object.entries(t).some(([,r])=>!!r)||n.unsetMark(this.name)}}}}),so=/^(\d+)\.\s$/,Do=ie.Node.create({name:"orderedList",addOptions:()=>({itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}),group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes:()=>({start:{default:1,parseHTML:e=>e.hasAttribute("start")?parseInt(e.getAttribute("start")||"",10):1}}),parseHTML:()=>[{tag:"ol"}],renderHTML({HTMLAttributes:e}){const{start:n,...t}=e;return 1===n?["ol",(0,ie.mergeAttributes)(this.options.HTMLAttributes,t),0]:["ol",(0,ie.mergeAttributes)(this.options.HTMLAttributes,e),0]},addCommands(){return{toggleOrderedList:()=>({commands:e,chain:n})=>this.options.keepAttributes?n().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(Xo.name,this.editor.getAttributes(ro.name)).run():e.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let e=(0,ie.wrappingInputRule)({find:so,type:this.type,getAttributes:n=>({start:+n[1]}),joinPredicate:(n,t)=>t.childCount+t.attrs.start===+n[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(e=(0,ie.wrappingInputRule)({find:so,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:n=>({start:+n[1],...this.editor.getAttributes(ro.name)}),joinPredicate:(n,t)=>t.childCount+t.attrs.start===+n[1],editor:this.editor})),[e]}}),lo=ie.Node.create({name:"paragraph",priority:1e3,addOptions:()=>({HTMLAttributes:{}}),group:"block",content:"inline*",parseHTML:()=>[{tag:"p"}],renderHTML({HTMLAttributes:e}){return["p",(0,ie.mergeAttributes)(this.options.HTMLAttributes,e),0]},addCommands(){return{setParagraph:()=>({commands:e})=>e.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),Po=/(?:^|\s)((?:~~)((?:[^~]+))(?:~~))$/,Ro=/(?:^|\s)((?:~~)((?:[^~]+))(?:~~))/g,pi=ie.Mark.create({name:"strike",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:e=>!!e.includes("line-through")&&{}}],renderHTML({HTMLAttributes:e}){return["s",(0,ie.mergeAttributes)(this.options.HTMLAttributes,e),0]},addCommands(){return{setStrike:()=>({commands:e})=>e.setMark(this.name),toggleStrike:()=>({commands:e})=>e.toggleMark(this.name),unsetStrike:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){const e={};return(0,ie.isMacOS)()?e["Mod-Shift-s"]=()=>this.editor.commands.toggleStrike():e["Ctrl-Shift-s"]=()=>this.editor.commands.toggleStrike(),e},addInputRules(){return[(0,ie.markInputRule)({find:Po,type:this.type})]},addPasteRules(){return[(0,ie.markPasteRule)({find:Ro,type:this.type})]}}),dn=ie.Node.create({name:"text",group:"inline"}),ao=/^(https?:\/\/)?(www\.|music\.)?(youtube\.com|youtu\.be|youtube-nocookie\.com)\/(?!channel\/)(?!@)(.+)?$/,No=/^(https?:\/\/)?(www\.|music\.)?(youtube\.com|youtu\.be)\/(?!channel\/)(?!@)(.+)?$/g,Lo=e=>e.match(ao),Ho=e=>e?"https://www.youtube-nocookie.com/embed/":"https://www.youtube.com/embed/",co=ie.Node.create({name:"youtube",addOptions:()=>({addPasteHandler:!0,allowFullscreen:!0,autoplay:!1,ccLanguage:void 0,ccLoadPolicy:void 0,controls:!0,disableKBcontrols:!1,enableIFrameApi:!1,endTime:0,height:480,interfaceLanguage:void 0,ivLoadPolicy:0,loop:!1,modestBranding:!1,HTMLAttributes:{},inline:!1,nocookie:!1,origin:"",playlist:"",progressBarColor:void 0,width:640}),inline(){return this.options.inline},group(){return this.options.inline?"inline":"block"},draggable:!0,addAttributes(){return{src:{default:null},start:{default:0},width:{default:this.options.width},height:{default:this.options.height}}},parseHTML:()=>[{tag:"div[data-youtube-video] iframe"}],addCommands(){return{setYoutubeVideo:e=>({commands:n})=>!!Lo(e.src)&&n.insertContent({type:this.name,attrs:e})}},addPasteRules(){return this.options.addPasteHandler?[(0,ie.nodePasteRule)({find:No,type:this.type,getAttributes:e=>({src:e.input})})]:[]},renderHTML({HTMLAttributes:e}){const n=(e=>{const{url:n,allowFullscreen:t,autoplay:i,ccLanguage:r,ccLoadPolicy:h,controls:_,disableKBcontrols:E,enableIFrameApi:I,endTime:N,interfaceLanguage:j,ivLoadPolicy:U,loop:Y,modestBranding:oe,nocookie:ae,origin:we,playlist:be,progressBarColor:Ve,startAt:Zt}=e;if(!Lo(n))return null;if(n.includes("/embed/"))return n;if(n.includes("youtu.be")){const jt=n.split("/").pop();return jt?`${Ho(ae)}${jt}`:null}const Zn=/(?:v=|shorts\/)([-\w]+)/gm.exec(n);if(!Zn||!Zn[1])return null;let Qt=`${Ho(ae)}${Zn[1]}`;const Re=[];return!1===t&&Re.push("fs=0"),i&&Re.push("autoplay=1"),r&&Re.push(`cc_lang_pref=${r}`),h&&Re.push("cc_load_policy=1"),_||Re.push("controls=0"),E&&Re.push("disablekb=1"),I&&Re.push("enablejsapi=1"),N&&Re.push(`end=${N}`),j&&Re.push(`hl=${j}`),U&&Re.push(`iv_load_policy=${U}`),Y&&Re.push("loop=1"),oe&&Re.push("modestbranding=1"),we&&Re.push(`origin=${we}`),be&&Re.push(`playlist=${be}`),Zt&&Re.push(`start=${Zt}`),Ve&&Re.push(`color=${Ve}`),Re.length&&(Qt+=`?${Re.join("&")}`),Qt})({url:e.src,allowFullscreen:this.options.allowFullscreen,autoplay:this.options.autoplay,ccLanguage:this.options.ccLanguage,ccLoadPolicy:this.options.ccLoadPolicy,controls:this.options.controls,disableKBcontrols:this.options.disableKBcontrols,enableIFrameApi:this.options.enableIFrameApi,endTime:this.options.endTime,interfaceLanguage:this.options.interfaceLanguage,ivLoadPolicy:this.options.ivLoadPolicy,loop:this.options.loop,modestBranding:this.options.modestBranding,nocookie:this.options.nocookie,origin:this.options.origin,playlist:this.options.playlist,progressBarColor:this.options.progressBarColor,startAt:e.start||0});return e.src=n,["div",{"data-youtube-video":""},["iframe",(0,ie.mergeAttributes)(this.options.HTMLAttributes,{width:this.options.width,height:this.options.height,allowfullscreen:this.options.allowFullscreen,autoplay:this.options.autoplay,ccLanguage:this.options.ccLanguage,ccLoadPolicy:this.options.ccLoadPolicy,disableKBcontrols:this.options.disableKBcontrols,enableIFrameApi:this.options.enableIFrameApi,endTime:this.options.endTime,interfaceLanguage:this.options.interfaceLanguage,ivLoadPolicy:this.options.ivLoadPolicy,loop:this.options.loop,modestBranding:this.options.modestBranding,origin:this.options.origin,playlist:this.options.playlist,progressBarColor:this.options.progressBarColor},e)]]}});Q(4133);const uo="aaa1rp3bb0ott3vie4c1le2ogado5udhabi7c0ademy5centure6ountant0s9o1tor4d0s1ult4e0g1ro2tna4f0l1rica5g0akhan5ency5i0g1rbus3force5tel5kdn3l0ibaba4pay4lfinanz6state5y2sace3tom5m0azon4ericanexpress7family11x2fam3ica3sterdam8nalytics7droid5quan4z2o0l2partments8p0le4q0uarelle8r0ab1mco4chi3my2pa2t0e3s0da2ia2sociates9t0hleta5torney7u0ction5di0ble3o3spost5thor3o0s4vianca6w0s2x0a2z0ure5ba0by2idu3namex3narepublic11d1k2r0celona5laycard4s5efoot5gains6seball5ketball8uhaus5yern5b0c1t1va3cg1n2d1e0ats2uty4er2ntley5rlin4st0buy5t2f1g1h0arti5i0ble3d1ke2ng0o3o1z2j1lack0friday9ockbuster8g1omberg7ue3m0s1w2n0pparibas9o0ats3ehringer8fa2m1nd2o0k0ing5sch2tik2on4t1utique6x2r0adesco6idgestone9oadway5ker3ther5ussels7s1t1uild0ers6siness6y1zz3v1w1y1z0h3ca0b1fe2l0l1vinklein9m0era3p2non3petown5ital0one8r0avan4ds2e0er0s4s2sa1e1h1ino4t0ering5holic7ba1n1re3c1d1enter4o1rn3f0a1d2g1h0anel2nel4rity4se2t2eap3intai5ristmas6ome4urch5i0priani6rcle4sco3tadel4i0c2y3k1l0aims4eaning6ick2nic1que6othing5ud3ub0med6m1n1o0ach3des3ffee4llege4ogne5m0cast4mbank4unity6pany2re3uter5sec4ndos3struction8ulting7tact3ractors9oking4l1p2rsica5untry4pon0s4rses6pa2r0edit0card4union9icket5own3s1uise0s6u0isinella9v1w1x1y0mru3ou3z2dabur3d1nce3ta1e1ing3sun4y2clk3ds2e0al0er2s3gree4livery5l1oitte5ta3mocrat6ntal2ist5si0gn4v2hl2iamonds6et2gital5rect0ory7scount3ver5h2y2j1k1m1np2o0cs1tor4g1mains5t1wnload7rive4tv2ubai3nlop4pont4rban5vag2r2z2earth3t2c0o2deka3u0cation8e1g1mail3erck5nergy4gineer0ing9terprises10pson4quipment8r0icsson6ni3s0q1tate5t1u0rovision8s2vents5xchange6pert3osed4ress5traspace10fage2il1rwinds6th3mily4n0s2rm0ers5shion4t3edex3edback6rrari3ero6i0delity5o2lm2nal1nce1ial7re0stone6mdale6sh0ing5t0ness6j1k1lickr3ghts4r2orist4wers5y2m1o0o0d1tball6rd1ex2sale4um3undation8x2r0ee1senius7l1ogans4ntier7tr2ujitsu5n0d2rniture7tbol5yi3ga0l0lery3o1up4me0s3p1rden4y2b0iz3d0n2e0a1nt0ing5orge5f1g0ee3h1i0ft0s3ves2ing5l0ass3e1obal2o4m0ail3bh2o1x2n1odaddy5ld0point6f2o0dyear5g0le4p1t1v2p1q1r0ainger5phics5tis4een3ipe3ocery4up4s1t1u0ardian6cci3ge2ide2tars5ru3w1y2hair2mburg5ngout5us3bo2dfc0bank7ealth0care8lp1sinki6re1mes5iphop4samitsu7tachi5v2k0t2m1n1ockey4ldings5iday5medepot5goods5s0ense7nda3rse3spital5t0ing5t0els3mail5use3w2r1sbc3t1u0ghes5yatt3undai7ibm2cbc2e1u2d1e0ee3fm2kano4l1m0amat4db2mo0bilien9n0c1dustries8finiti5o2g1k1stitute6urance4e4t0ernational10uit4vestments10o1piranga7q1r0ish4s0maili5t0anbul7t0au2v3jaguar4va3cb2e0ep2tzt3welry6io2ll2m0p2nj2o0bs1urg4t1y2p0morgan6rs3uegos4niper7kaufen5ddi3e0rryhotels6logistics9properties14fh2g1h1i0a1ds2m1ndle4tchen5wi3m1n1oeln3matsu5sher5p0mg2n2r0d1ed3uokgroup8w1y0oto4z2la0caixa5mborghini8er3ncaster6d0rover6xess5salle5t0ino3robe5w0yer5b1c1ds2ease3clerc5frak4gal2o2xus4gbt3i0dl2fe0insurance9style7ghting6ke2lly3mited4o2ncoln4k2psy3ve1ing5k1lc1p2oan0s3cker3us3l1ndon4tte1o3ve3pl0financial11r1s1t0d0a3u0ndbeck6xe1ury5v1y2ma0drid4if1son4keup4n0agement7go3p1rket0ing3s4riott5shalls7ttel5ba2c0kinsey7d1e0d0ia3et2lbourne7me1orial6n0u2rckmsd7g1h1iami3crosoft7l1ni1t2t0subishi9k1l0b1s2m0a2n1o0bi0le4da2e1i1m1nash3ey2ster5rmon3tgage6scow4to0rcycles9v0ie4p1q1r1s0d2t0n1r2u0seum3ic4v1w1x1y1z2na0b1goya4me2tura4vy3ba2c1e0c1t0bank4flix4work5ustar5w0s2xt0direct7us4f0l2g0o2hk2i0co2ke1on3nja3ssan1y5l1o0kia3rton4w0ruz3tv4p1r0a1w2tt2u1yc2z2obi1server7ffice5kinawa6layan0group9dnavy5lo3m0ega4ne1g1l0ine5oo2pen3racle3nge4g0anic5igins6saka4tsuka4t2vh3pa0ge2nasonic7ris2s1tners4s1y3y2ccw3e0t2f0izer5g1h0armacy6d1ilips5one2to0graphy6s4ysio5ics1tet2ures6d1n0g1k2oneer5zza4k1l0ace2y0station9umbing5s3m1n0c2ohl2ker3litie5rn2st3r0america6xi3ess3ime3o0d0uctions8f1gressive8mo2perties3y5tection8u0dential9s1t1ub2w0c2y2qa1pon3uebec3st5racing4dio4e0ad1lestate6tor2y4cipes5d0stone5umbrella9hab3ise0n3t2liance6n0t0als5pair3ort3ublican8st0aurant8view0s5xroth6ich0ardli6oh3l1o1p2o0cks3deo3gers4om3s0vp3u0gby3hr2n2w0e2yukyu6sa0arland6fe0ty4kura4le1on3msclub4ung5ndvik0coromant12ofi4p1rl2s1ve2xo3b0i1s2c0a1b1haeffler7midt4olarships8ol3ule3warz5ience5ot3d1e0arch3t2cure1ity6ek2lect4ner3rvices6ven3w1x0y3fr2g1h0angrila6rp2w2ell3ia1ksha5oes2p0ping5uji3w3i0lk2na1gles5te3j1k0i0n2y0pe4l0ing4m0art3ile4n0cf3o0ccer3ial4ftbank4ware6hu2lar2utions7ng1y2y2pa0ce3ort2t3r0l2s1t0ada2ples4r1tebank4farm7c0group6ockholm6rage3e3ream4udio2y3yle4u0cks3pplies3y2ort5rf1gery5zuki5v1watch4iss4x1y0dney4stems6z2tab1ipei4lk2obao4rget4tamotors6r2too4x0i3c0i2d0k2eam2ch0nology8l1masek5nnis4va3f1g1h0d1eater2re6iaa2ckets5enda4ps2res2ol4j0maxx4x2k0maxx5l1m0all4n1o0day3kyo3ols3p1ray3shiba5tal3urs3wn2yota3s3r0ade1ing4ining5vel0ers0insurance16ust3v2t1ube2i1nes3shu4v0s2w1z2ua1bank3s2g1k1nicom3versity8o2ol2ps2s1y1z2va0cations7na1guard7c1e0gas3ntures6risign5m\xf6gensberater2ung14sicherung10t2g1i0ajes4deo3g1king4llas4n1p1rgin4sa1ion4va1o3laanderen9n1odka3lvo3te1ing3o2yage5u2wales2mart4ter4ng0gou5tch0es6eather0channel12bcam3er2site5d0ding5ibo2r3f1hoswho6ien2ki2lliamhill9n0dows4e1ners6me2olterskluwer11odside6rk0s2ld3w2s1tc1f3xbox3erox4finity6ihuan4n2xx2yz3yachts4hoo3maxun5ndex5e1odobashi7ga2kohama6u0tube6t1un3za0ppos4ra3ero3ip2m1one3uerich6w2",Gn="\u03b5\u03bb1\u03c52\u0431\u04331\u0435\u043b3\u0434\u0435\u0442\u04384\u0435\u044e2\u043a\u0430\u0442\u043e\u043b\u0438\u043a6\u043e\u043c3\u043c\u043a\u04342\u043e\u043d1\u0441\u043a\u0432\u04306\u043e\u043d\u043b\u0430\u0439\u043d5\u0440\u04333\u0440\u0443\u04412\u04442\u0441\u0430\u0439\u04423\u0440\u04313\u0443\u043a\u04403\u049b\u0430\u04373\u0570\u0561\u05753\u05d9\u05e9\u05e8\u05d0\u05dc5\u05e7\u05d5\u05dd3\u0627\u0628\u0648\u0638\u0628\u064a5\u0631\u0627\u0645\u0643\u06485\u0644\u0627\u0631\u062f\u06464\u0628\u062d\u0631\u064a\u06465\u062c\u0632\u0627\u0626\u06315\u0633\u0639\u0648\u062f\u064a\u06296\u0639\u0644\u064a\u0627\u06465\u0645\u063a\u0631\u06285\u0645\u0627\u0631\u0627\u062a5\u06cc\u0631\u0627\u06465\u0628\u0627\u0631\u062a2\u0632\u0627\u06314\u064a\u062a\u06433\u06be\u0627\u0631\u062a5\u062a\u0648\u0646\u06334\u0633\u0648\u062f\u0627\u06463\u0631\u064a\u06295\u0634\u0628\u0643\u06294\u0639\u0631\u0627\u06422\u06282\u0645\u0627\u06464\u0641\u0644\u0633\u0637\u064a\u06466\u0642\u0637\u06313\u0643\u0627\u062b\u0648\u0644\u064a\u06436\u0648\u06453\u0645\u0635\u06312\u0644\u064a\u0633\u064a\u06275\u0648\u0631\u064a\u062a\u0627\u0646\u064a\u06277\u0642\u06394\u0647\u0645\u0631\u0627\u06475\u067e\u0627\u06a9\u0633\u062a\u0627\u06467\u0680\u0627\u0631\u062a4\u0915\u0949\u092e3\u0928\u0947\u091f3\u092d\u093e\u0930\u09240\u092e\u094d3\u094b\u09245\u0938\u0902\u0917\u0920\u09285\u09ac\u09be\u0982\u09b2\u09be5\u09ad\u09be\u09b0\u09a42\u09f0\u09a44\u0a2d\u0a3e\u0a30\u0a244\u0aad\u0abe\u0ab0\u0aa44\u0b2d\u0b3e\u0b30\u0b244\u0b87\u0ba8\u0bcd\u0ba4\u0bbf\u0baf\u0bbe6\u0bb2\u0b99\u0bcd\u0b95\u0bc86\u0b9a\u0bbf\u0b99\u0bcd\u0b95\u0baa\u0bcd\u0baa\u0bc2\u0bb0\u0bcd11\u0c2d\u0c3e\u0c30\u0c24\u0c4d5\u0cad\u0cbe\u0cb0\u0ca44\u0d2d\u0d3e\u0d30\u0d24\u0d025\u0dbd\u0d82\u0d9a\u0dcf4\u0e04\u0e2d\u0e213\u0e44\u0e17\u0e223\u0ea5\u0eb2\u0ea73\u10d2\u10d42\u307f\u3093\u306a3\u30a2\u30de\u30be\u30f34\u30af\u30e9\u30a6\u30c94\u30b0\u30fc\u30b0\u30eb4\u30b3\u30e02\u30b9\u30c8\u30a23\u30bb\u30fc\u30eb3\u30d5\u30a1\u30c3\u30b7\u30e7\u30f36\u30dd\u30a4\u30f3\u30c84\u4e16\u754c2\u4e2d\u4fe11\u56fd1\u570b1\u6587\u7f513\u4e9a\u9a6c\u900a3\u4f01\u4e1a2\u4f5b\u5c712\u4fe1\u606f2\u5065\u5eb72\u516b\u53662\u516c\u53f81\u76ca2\u53f0\u6e7e1\u70632\u5546\u57ce1\u5e971\u68072\u5609\u91cc0\u5927\u9152\u5e975\u5728\u7ebf2\u5927\u62ff2\u5929\u4e3b\u65593\u5a31\u4e502\u5bb6\u96fb2\u5e7f\u4e1c2\u5fae\u535a2\u6148\u55842\u6211\u7231\u4f603\u624b\u673a2\u62db\u80582\u653f\u52a11\u5e9c2\u65b0\u52a0\u57612\u95fb2\u65f6\u5c1a2\u66f8\u7c4d2\u673a\u67842\u6de1\u9a6c\u95213\u6e38\u620f2\u6fb3\u95802\u70b9\u770b2\u79fb\u52a82\u7ec4\u7ec7\u673a\u67844\u7f51\u57401\u5e971\u7ad91\u7edc2\u8054\u901a2\u8c37\u6b4c2\u8d2d\u72692\u901a\u8ca92\u96c6\u56e22\u96fb\u8a0a\u76c8\u79d14\u98de\u5229\u6d663\u98df\u54c12\u9910\u53852\u9999\u683c\u91cc\u62c93\u6e2f2\ub2f7\ub1371\ucef42\uc0bc\uc1312\ud55c\uad6d2",Ft=(e,n)=>{for(const t in n)e[t]=n[t];return e},Hi="numeric",fi="ascii",a="alpha",s="asciinumeric",u="alphanumeric",f="domain",T="emoji",b="scheme",l="slashscheme",o="whitespace";function c(e,n){return e in n||(n[e]=[]),n[e]}function p(e,n,t){n[Hi]&&(n[s]=!0,n[u]=!0),n[fi]&&(n[s]=!0,n[a]=!0),n[s]&&(n[u]=!0),n[a]&&(n[u]=!0),n[u]&&(n[f]=!0),n[T]&&(n[f]=!0);for(const i in n){const r=c(i,t);r.indexOf(e)<0&&r.push(e)}}function y(e){void 0===e&&(e=null),this.j={},this.jr=[],this.jd=null,this.t=e}y.groups={},y.prototype={accepts(){return!!this.t},go(e){const n=this,t=n.j[e];if(t)return t;for(let i=0;i<n.jr.length;i++){const h=n.jr[i][1];if(h&&n.jr[i][0].test(e))return h}return n.jd},has(e,n){return void 0===n&&(n=!1),n?e in this.j:!!this.go(e)},ta(e,n,t,i){for(let r=0;r<e.length;r++)this.tt(e[r],n,t,i)},tr(e,n,t,i){let r;return i=i||y.groups,n&&n.j?r=n:(r=new y(n),t&&i&&p(n,t,i)),this.jr.push([e,r]),r},ts(e,n,t,i){let r=this;const h=e.length;if(!h)return r;for(let _=0;_<h-1;_++)r=r.tt(e[_]);return r.tt(e[h-1],n,t,i)},tt(e,n,t,i){i=i||y.groups;const r=this;if(n&&n.j)return r.j[e]=n,n;const h=n;let _,E=r.go(e);if(E?(_=new y,Ft(_.j,E.j),_.jr.push.apply(_.jr,E.jr),_.jd=E.jd,_.t=E.t):_=new y,h){if(i)if(_.t&&"string"==typeof _.t){const I=Ft(function g(e,n){const t={};for(const i in n)n[i].indexOf(e)>=0&&(t[i]=!0);return t}(_.t,i),t);p(h,I,i)}else t&&p(h,t,i);_.t=h}return r.j[e]=_,_}};const v=(e,n,t,i,r)=>e.ta(n,t,i,r),S=(e,n,t,i,r)=>e.tr(n,t,i,r),O=(e,n,t,i,r)=>e.ts(n,t,i,r),D=(e,n,t,i,r)=>e.tt(n,t,i,r),H="WORD",$="UWORD",J="LOCALHOST",X="TLD",re="UTLD",ue="SCHEME",ce="SLASH_SCHEME",fe="NUM",Be="WS",_e="NL",Je="OPENBRACE",nt="CLOSEBRACE",Tt="OPENBRACKET",Bt="CLOSEBRACKET",hi="OPENPAREN",er="CLOSEPAREN",tr="OPENANGLEBRACKET",nr="CLOSEANGLEBRACKET",ir="FULLWIDTHLEFTPAREN",or="FULLWIDTHRIGHTPAREN",rr="LEFTCORNERBRACKET",sr="RIGHTCORNERBRACKET",lr="LEFTWHITECORNERBRACKET",ar="RIGHTWHITECORNERBRACKET",cr="FULLWIDTHLESSTHAN",ur="FULLWIDTHGREATERTHAN",dr="AMPERSAND",pr="APOSTROPHE",fr="ASTERISK",mi="AT",hr="BACKSLASH",mr="BACKTICK",gr="CARET",gi="COLON",jr="COMMA",_r="DOLLAR",Rn="DOT",Tr="EQUALS",Wr="EXCLAMATION",Nn="HYPHEN",Cr="PERCENT",br="PIPE",yr="PLUS",vr="POUND",xr="QUERY",Jr="QUOTE",Kr="SEMI",Ln="SLASH",zo="TILDE",kr="UNDERSCORE",ps="EMOJI",wr="SYM";var fs=Object.freeze({__proto__:null,WORD:H,UWORD:$,LOCALHOST:J,TLD:X,UTLD:re,SCHEME:ue,SLASH_SCHEME:ce,NUM:fe,WS:Be,NL:_e,OPENBRACE:Je,CLOSEBRACE:nt,OPENBRACKET:Tt,CLOSEBRACKET:Bt,OPENPAREN:hi,CLOSEPAREN:er,OPENANGLEBRACKET:tr,CLOSEANGLEBRACKET:nr,FULLWIDTHLEFTPAREN:ir,FULLWIDTHRIGHTPAREN:or,LEFTCORNERBRACKET:rr,RIGHTCORNERBRACKET:sr,LEFTWHITECORNERBRACKET:lr,RIGHTWHITECORNERBRACKET:ar,FULLWIDTHLESSTHAN:cr,FULLWIDTHGREATERTHAN:ur,AMPERSAND:dr,APOSTROPHE:pr,ASTERISK:fr,AT:mi,BACKSLASH:hr,BACKTICK:mr,CARET:gr,COLON:gi,COMMA:jr,DOLLAR:_r,DOT:Rn,EQUALS:Tr,EXCLAMATION:Wr,HYPHEN:Nn,PERCENT:Cr,PIPE:br,PLUS:yr,POUND:vr,QUERY:xr,QUOTE:Jr,SEMI:Kr,SLASH:Ln,TILDE:zo,UNDERSCORE:kr,EMOJI:ps,SYM:wr});const Fi=/[a-z]/,Sr=/\p{L}/u,Mr=/\p{Emoji}/u,Er=/\d/,Yr=/\s/,hs="\n",Tl="\ufe0f",Cl="\u200d";let Or=null,Ar=null;function _i(e,n,t,i,r){let h;const _=n.length;for(let E=0;E<_-1;E++){const I=n[E];e.j[I]?h=e.j[I]:(h=new y(i),h.jr=r.slice(),e.j[I]=h),e=h}return h=new y(t),h.jr=r.slice(),e.j[n[_-1]]=h,h}function ms(e){const n=[],t=[];let i=0;for(;i<e.length;){let h=0;for(;"0123456789".indexOf(e[i+h])>=0;)h++;if(h>0){n.push(t.join(""));for(let _=parseInt(e.substring(i,i+h),10);_>0;_--)t.pop();i+=h}else t.push(e[i]),i++}return n}const po={defaultProtocol:"http",events:null,format:gs,formatHref:gs,nl2br:!1,tagName:"a",target:null,rel:null,validate:!0,truncate:1/0,className:null,attributes:null,ignoreTags:[],render:null};function Ir(e,n){void 0===n&&(n=null);let t=Ft({},po);e&&(t=Ft(t,e instanceof Ir?e.o:e));const i=t.ignoreTags,r=[];for(let h=0;h<i.length;h++)r.push(i[h].toUpperCase());this.o=t,n&&(this.defaultRender=n),this.ignoreTags=r}function gs(e){return e}function Dr(e,n){this.t="token",this.v=e,this.tk=n}function $o(e,n){class t extends Dr{constructor(r,h){super(r,h),this.t=e}}for(const i in n)t.prototype[i]=n[i];return t.t=e,t}Ir.prototype={o:po,ignoreTags:[],defaultRender:e=>e,check(e){return this.get("validate",e.toString(),e)},get(e,n,t){const i=null!=n;let r=this.o[e];return r&&("object"==typeof r?(r=t.t in r?r[t.t]:po[e],"function"==typeof r&&i&&(r=r(n,t))):"function"==typeof r&&i&&(r=r(n,t.t,t)),r)},getObj(e,n,t){let i=this.o[e];return"function"==typeof i&&null!=n&&(i=i(n,t.t,t)),i},render(e){const n=e.render(this);return(this.get("render",null,e)||this.defaultRender)(n,e.t,e)}},Dr.prototype={isLink:!1,toString(){return this.v},toHref(e){return this.toString()},toFormattedString(e){const n=this.toString(),t=e.get("truncate",n,this),i=e.get("format",n,this);return t&&i.length>t?i.substring(0,t)+"\u2026":i},toFormattedHref(e){return e.get("formatHref",this.toHref(e.get("defaultProtocol")),this)},startIndex(){return this.tk[0].s},endIndex(){return this.tk[this.tk.length-1].e},toObject(e){return void 0===e&&(e=po.defaultProtocol),{type:this.t,value:this.toString(),isLink:this.isLink,href:this.toHref(e),start:this.startIndex(),end:this.endIndex()}},toFormattedObject(e){return{type:this.t,value:this.toFormattedString(e),isLink:this.isLink,href:this.toFormattedHref(e),start:this.startIndex(),end:this.endIndex()}},validate(e){return e.get("validate",this.toString(),this)},render(e){const n=this,t=this.toHref(e.get("defaultProtocol")),i=e.get("formatHref",t,this),r=e.get("tagName",t,n),h=this.toFormattedString(e),_={},E=e.get("className",t,n),I=e.get("target",t,n),N=e.get("rel",t,n),j=e.getObj("attributes",t,n),U=e.getObj("events",t,n);return _.href=i,E&&(_.class=E),I&&(_.target=I),N&&(_.rel=N),j&&Ft(_,j),{tagName:r,attributes:_,content:h,eventListeners:U}}};const Gr=$o("email",{isLink:!0,toHref(){return"mailto:"+this.toString()}}),Zr=$o("text"),_s=$o("nl"),Vo=$o("url",{isLink:!0,toHref(e){return void 0===e&&(e=po.defaultProtocol),this.hasProtocol()?this.v:`${e}://${this.v}`},hasProtocol(){const e=this.tk;return e.length>=2&&e[0].t!==J&&e[1].t===gi}}),pn=e=>new y(e);function Qr(e,n,t){return new e(n.slice(t[0].s,t[t.length-1].e),t)}const Uo=typeof console<"u"&&console&&console.warn||(()=>{}),Ue={scanner:null,parser:null,tokenQueue:[],pluginQueue:[],customSchemes:[],initialized:!1};function Ts(e,n){if(void 0===n&&(n=!1),Ue.initialized&&Uo(`linkifyjs: already initialized - will not register custom scheme "${e}" until manual call of linkify.init(). Register all schemes and plugins before invoking linkify the first time.`),!/^[0-9a-z]+(-[0-9a-z]+)*$/.test(e))throw new Error('linkifyjs: incorrect scheme format.\n1. Must only contain digits, lowercase ASCII letters or "-"\n2. Cannot start or end with "-"\n3. "-" cannot repeat');Ue.customSchemes.push([e,n])}function Cs(e){return Ue.initialized||function Sl(){Ue.scanner=function bl(e){void 0===e&&(e=[]);const n={};y.groups=n;const t=new y;null==Or&&(Or=ms(uo)),null==Ar&&(Ar=ms(Gn)),D(t,"'",pr),D(t,"{",Je),D(t,"}",nt),D(t,"[",Tt),D(t,"]",Bt),D(t,"(",hi),D(t,")",er),D(t,"<",tr),D(t,">",nr),D(t,"\uff08",ir),D(t,"\uff09",or),D(t,"\u300c",rr),D(t,"\u300d",sr),D(t,"\u300e",lr),D(t,"\u300f",ar),D(t,"\uff1c",cr),D(t,"\uff1e",ur),D(t,"&",dr),D(t,"*",fr),D(t,"@",mi),D(t,"`",mr),D(t,"^",gr),D(t,":",gi),D(t,",",jr),D(t,"$",_r),D(t,".",Rn),D(t,"=",Tr),D(t,"!",Wr),D(t,"-",Nn),D(t,"%",Cr),D(t,"|",br),D(t,"+",yr),D(t,"#",vr),D(t,"?",xr),D(t,'"',Jr),D(t,"/",Ln),D(t,";",Kr),D(t,"~",zo),D(t,"_",kr),D(t,"\\",hr);const i=S(t,Er,fe,{[Hi]:!0});S(i,Er,i);const r=S(t,Fi,H,{[fi]:!0});S(r,Fi,r);const h=S(t,Sr,$,{[a]:!0});S(h,Fi),S(h,Sr,h);const _=S(t,Yr,Be,{[o]:!0});D(t,hs,_e,{[o]:!0}),D(_,hs),S(_,Yr,_);const E=S(t,Mr,ps,{[T]:!0});S(E,Mr,E),D(E,Tl,E);const I=D(E,Cl);S(I,Mr,E);const N=[[Fi,r]],j=[[Fi,null],[Sr,h]];for(let U=0;U<Or.length;U++)_i(t,Or[U],X,H,N);for(let U=0;U<Ar.length;U++)_i(t,Ar[U],re,$,j);p(X,{tld:!0,ascii:!0},n),p(re,{utld:!0,alpha:!0},n),_i(t,"file",ue,H,N),_i(t,"mailto",ue,H,N),_i(t,"http",ce,H,N),_i(t,"https",ce,H,N),_i(t,"ftp",ce,H,N),_i(t,"ftps",ce,H,N),p(ue,{scheme:!0,ascii:!0},n),p(ce,{slashscheme:!0,ascii:!0},n),e=e.sort((U,Y)=>U[0]>Y[0]?1:-1);for(let U=0;U<e.length;U++){const Y=e[U][0],ae=e[U][1]?{[b]:!0}:{[l]:!0};Y.indexOf("-")>=0?ae[f]=!0:Fi.test(Y)?Er.test(Y)?ae[s]=!0:ae[fi]=!0:ae[Hi]=!0,O(t,Y,Y,ae)}return O(t,"localhost",J,{ascii:!0}),t.jd=new y(wr),{start:t,tokens:Ft({groups:n},fs)}}(Ue.customSchemes);for(let e=0;e<Ue.tokenQueue.length;e++)Ue.tokenQueue[e][1]({scanner:Ue.scanner});Ue.parser=function xl(e){let{groups:n}=e;const t=n.domain.concat([dr,fr,mi,hr,mr,gr,_r,Tr,Nn,fe,Cr,br,yr,vr,Ln,wr,zo,kr]),i=[pr,gi,jr,Rn,Wr,xr,Jr,Kr,tr,nr,Je,nt,Bt,Tt,hi,er,ir,or,rr,sr,lr,ar,cr,ur],r=[dr,pr,fr,hr,mr,gr,_r,Tr,Nn,Je,nt,Cr,br,yr,vr,xr,Ln,wr,zo,kr],h=pn(),_=D(h,zo);v(_,r,_),v(_,n.domain,_);const E=pn(),I=pn(),N=pn();v(h,n.domain,E),v(h,n.scheme,I),v(h,n.slashscheme,N),v(E,r,_),v(E,n.domain,E);const j=D(E,mi);D(_,mi,j),D(I,mi,j),D(N,mi,j);const U=D(_,Rn);v(U,r,_),v(U,n.domain,_);const Y=pn();v(j,n.domain,Y),v(Y,n.domain,Y);const oe=D(Y,Rn);v(oe,n.domain,Y);const ae=pn(Gr);v(oe,n.tld,ae),v(oe,n.utld,ae),D(j,J,ae);const we=D(Y,Nn);v(we,n.domain,Y),v(ae,n.domain,Y),D(ae,Rn,oe),D(ae,Nn,we);const be=D(ae,gi);v(be,n.numeric,Gr);const Ve=D(E,Nn),Zt=D(E,Rn);v(Ve,n.domain,E),v(Zt,r,_),v(Zt,n.domain,E);const xt=pn(Vo);v(Zt,n.tld,xt),v(Zt,n.utld,xt),v(xt,n.domain,E),v(xt,r,_),D(xt,Rn,Zt),D(xt,Nn,Ve),D(xt,mi,j);const Zn=D(xt,gi),Qt=pn(Vo);v(Zn,n.numeric,Qt);const Re=pn(Vo),jt=pn();v(Re,t,Re),v(Re,i,jt),v(jt,t,Re),v(jt,i,jt),D(xt,Ln,Re),D(Qt,Ln,Re);const mo=D(I,gi),xd=D(N,gi),kd=D(xd,Ln),cs=D(kd,Ln);v(I,n.domain,E),D(I,Rn,Zt),D(I,Nn,Ve),v(N,n.domain,E),D(N,Rn,Zt),D(N,Nn,Ve),v(mo,n.domain,Re),D(mo,Ln,Re),v(cs,n.domain,Re),v(cs,t,Re),D(cs,Ln,Re);const hl=[[Je,nt],[Tt,Bt],[hi,er],[tr,nr],[ir,or],[rr,sr],[lr,ar],[cr,ur]];for(let us=0;us<hl.length;us++){const[ml,ds]=hl[us],Vr=D(Re,ml);D(jt,ml,Vr),D(Vr,ds,Re);const go=pn(Vo);v(Vr,t,go);const Wo=pn();v(Vr,i),v(go,t,go),v(go,i,Wo),v(Wo,t,go),v(Wo,i,Wo),D(go,ds,Re),D(Wo,ds,Re)}return D(h,J,xt),D(h,_e,_s),{start:h,tokens:fs}}(Ue.scanner.tokens);for(let e=0;e<Ue.pluginQueue.length;e++)Ue.pluginQueue[e][1]({scanner:Ue.scanner,parser:Ue.parser});Ue.initialized=!0}(),function kl(e,n,t){let i=t.length,r=0,h=[],_=[];for(;r<i;){let E=e,I=null,N=null,j=0,U=null,Y=-1;for(;r<i&&!(I=E.go(t[r].t));)_.push(t[r++]);for(;r<i&&(N=I||E.go(t[r].t));)I=null,E=N,E.accepts()?(Y=0,U=E):Y>=0&&Y++,r++,j++;if(Y<0)r-=j,r<i&&(_.push(t[r]),r++);else{_.length>0&&(h.push(Qr(Zr,n,_)),_=[]),r-=Y,j-=Y;const oe=U.t,ae=t.slice(r-j,r);h.push(Qr(oe,n,ae))}}return _.length>0&&h.push(Qr(Zr,n,_)),h}(Ue.parser.start,e,function yl(e,n){const t=function vl(e){const n=[],t=e.length;let i=0;for(;i<t;){let h,r=e.charCodeAt(i),_=r<55296||r>56319||i+1===t||(h=e.charCodeAt(i+1))<56320||h>57343?e[i]:e.slice(i,i+2);n.push(_),i+=_.length}return n}(n.replace(/[A-Z]/g,E=>E.toLowerCase())),i=t.length,r=[];let h=0,_=0;for(;_<i;){let E=e,I=null,N=0,j=null,U=-1,Y=-1;for(;_<i&&(I=E.go(t[_]));)E=I,E.accepts()?(U=0,Y=0,j=E):U>=0&&(U+=t[_].length,Y++),N+=t[_].length,h+=t[_].length,_++;h-=U,_-=Y,N-=U,r.push({t:j.t,v:n.slice(h-N,h),s:h-N,e:h})}return r}(Ue.scanner.start,e))}function Pr(e,n,t){if(void 0===n&&(n=null),void 0===t&&(t=null),n&&"object"==typeof n){if(t)throw Error(`linkifyjs: Invalid link type ${n}; must be a string`);t=n,n=null}const i=new Ir(t),r=Cs(e),h=[];for(let _=0;_<r.length;_++){const E=r[_];E.isLink&&(!n||E.t===n)&&i.check(E)&&h.push(E.toFormattedObject(i))}return h}const Al=ie.Mark.create({name:"link",priority:1e3,keepOnSplit:!1,onCreate(){this.options.protocols.forEach(e=>{"string"!=typeof e?Ts(e.scheme,e.optionalSlashes):Ts(e)})},onDestroy(){!function wl(){y.groups={},Ue.scanner=null,Ue.parser=null,Ue.tokenQueue=[],Ue.pluginQueue=[],Ue.customSchemes=[],Ue.initialized=!1}()},inclusive(){return this.options.autolink},addOptions:()=>({openOnClick:!0,linkOnPaste:!0,autolink:!0,protocols:[],HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},validate:void 0}),addAttributes(){return{href:{default:null},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class}}},parseHTML:()=>[{tag:'a[href]:not([href *= "javascript:" i])'}],renderHTML({HTMLAttributes:e}){var n;return null!==(n=e.href)&&void 0!==n&&n.startsWith("javascript:")?["a",(0,ie.mergeAttributes)(this.options.HTMLAttributes,{...e,href:""}),0]:["a",(0,ie.mergeAttributes)(this.options.HTMLAttributes,e),0]},addCommands(){return{setLink:e=>({chain:n})=>n().setMark(this.name,e).setMeta("preventAutolink",!0).run(),toggleLink:e=>({chain:n})=>n().toggleMark(this.name,e,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run(),unsetLink:()=>({chain:e})=>e().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},addPasteRules(){return[(0,ie.markPasteRule)({find:e=>{const n=[];if(e){const t=Pr(e).filter(i=>i.isLink);t.length&&t.forEach(i=>n.push({text:i.value,data:{href:i.href},index:i.start}))}return n},type:this.type,getAttributes:e=>{var n;return{href:null===(n=e.data)||void 0===n?void 0:n.href}}})]},addProseMirrorPlugins(){const e=[];return this.options.autolink&&e.push(function Ml(e){return new ye.Sy({key:new ye.H$("autolink"),appendTransaction:(n,t,i)=>{const r=n.some(N=>N.docChanged)&&!t.doc.eq(i.doc),h=n.some(N=>N.getMeta("preventAutolink"));if(!r||h)return;const{tr:_}=i,E=(0,ie.combineTransactionSteps)(t.doc,[...n]);return(0,ie.getChangedRanges)(E).forEach(({newRange:N})=>{const j=(0,ie.findChildrenInRange)(i.doc,N,oe=>oe.isTextblock);let U,Y;if(j.length>1?(U=j[0],Y=i.doc.textBetween(U.pos,U.pos+U.node.nodeSize,void 0," ")):j.length&&i.doc.textBetween(N.from,N.to," "," ").endsWith(" ")&&(U=j[0],Y=i.doc.textBetween(U.pos,N.to,void 0," ")),U&&Y){const oe=Y.split(" ").filter(be=>""!==be);if(oe.length<=0)return!1;const ae=oe[oe.length-1],we=U.pos+Y.lastIndexOf(ae);if(!ae)return!1;Pr(ae).filter(be=>be.isLink).map(be=>({...be,from:we+be.start+1,to:we+be.end+1})).filter(be=>!i.schema.marks.code||!i.doc.rangeHasMark(be.from,be.to,i.schema.marks.code)).filter(be=>!e.validate||e.validate(be.value)).forEach(be=>{(0,ie.getMarksBetween)(be.from,be.to,i.doc).some(Ve=>Ve.mark.type===e.type)||_.addMark(be.from,be.to,e.type.create({href:be.href}))})}}),_.steps.length?_:void 0}})}({type:this.type,validate:this.options.validate})),this.options.openOnClick&&e.push(function El(e){return new ye.Sy({key:new ye.H$("handleClickLink"),props:{handleClick:(n,t,i)=>{var r,h;if(0!==i.button)return!1;let _=i.target;const E=[];for(;"DIV"!==_.nodeName;)E.push(_),_=_.parentNode;if(!E.find(Y=>"A"===Y.nodeName))return!1;const I=(0,ie.getAttributes)(n.state,e.type.name),N=i.target,j=null!==(r=null==N?void 0:N.href)&&void 0!==r?r:I.href,U=null!==(h=null==N?void 0:N.target)&&void 0!==h?h:I.target;return!(!N||!j||(window.open(j,U),0))}}})}({type:this.type})),this.options.linkOnPaste&&e.push(function Ol(e){return new ye.Sy({key:new ye.H$("handlePasteLink"),props:{handlePaste:(n,t,i)=>{const{state:r}=n,{selection:h}=r,{empty:_}=h;if(_)return!1;let E="";i.content.forEach(N=>{E+=N.textContent});const I=Pr(E).find(N=>N.isLink&&N.value===E);return!(!E||!I||(e.editor.commands.setMark(e.type,{href:I.href}),0))}}})}({editor:this.editor,type:this.type})),e}});var Xr,es;if(typeof WeakMap<"u"){let e=new WeakMap;Xr=n=>e.get(n),es=(n,t)=>(e.set(n,t),t)}else{const e=[];let t=0;Xr=i=>{for(let r=0;r<e.length;r+=2)if(e[r]==i)return e[r+1]},es=(i,r)=>(10==t&&(t=0),e[t++]=i,e[t++]=r)}var it=class{constructor(e,n,t,i){this.width=e,this.height=n,this.map=t,this.problems=i}findCell(e){for(let n=0;n<this.map.length;n++){const t=this.map[n];if(t!=e)continue;const i=n%this.width,r=n/this.width|0;let h=i+1,_=r+1;for(let E=1;h<this.width&&this.map[n+E]==t;E++)h++;for(let E=1;_<this.height&&this.map[n+this.width*E]==t;E++)_++;return{left:i,top:r,right:h,bottom:_}}throw new RangeError(`No cell with offset ${e} found`)}colCount(e){for(let n=0;n<this.map.length;n++)if(this.map[n]==e)return n%this.width;throw new RangeError(`No cell with offset ${e} found`)}nextCell(e,n,t){const{left:i,right:r,top:h,bottom:_}=this.findCell(e);return"horiz"==n?(t<0?0==i:r==this.width)?null:this.map[h*this.width+(t<0?i-1:r)]:(t<0?0==h:_==this.height)?null:this.map[i+this.width*(t<0?h-1:_)]}rectBetween(e,n){const{left:t,right:i,top:r,bottom:h}=this.findCell(e),{left:_,right:E,top:I,bottom:N}=this.findCell(n);return{left:Math.min(t,_),top:Math.min(r,I),right:Math.max(i,E),bottom:Math.max(h,N)}}cellsInRect(e){const n=[],t={};for(let i=e.top;i<e.bottom;i++)for(let r=e.left;r<e.right;r++){const h=i*this.width+r,_=this.map[h];t[_]||(t[_]=!0,!(r==e.left&&r&&this.map[h-1]==_||i==e.top&&i&&this.map[h-this.width]==_)&&n.push(_))}return n}positionAt(e,n,t){for(let i=0,r=0;;i++){const h=r+t.child(i).nodeSize;if(i==e){let _=n+e*this.width;const E=(e+1)*this.width;for(;_<E&&this.map[_]<r;)_++;return _==E?h-1:this.map[_]}r=h}}static get(e){return Xr(e)||es(e,function Il(e){if("table"!=e.type.spec.tableRole)throw new RangeError("Not a table node: "+e.type.name);const n=function Dl(e){let n=-1,t=!1;for(let i=0;i<e.childCount;i++){const r=e.child(i);let h=0;if(t)for(let _=0;_<i;_++){const E=e.child(_);for(let I=0;I<E.childCount;I++){const N=E.child(I);_+N.attrs.rowspan>i&&(h+=N.attrs.colspan)}}for(let _=0;_<r.childCount;_++){const E=r.child(_);h+=E.attrs.colspan,E.attrs.rowspan>1&&(t=!0)}-1==n?n=h:n!=h&&(n=Math.max(n,h))}return n}(e),t=e.childCount,i=[];let r=0,h=null;const _=[];for(let N=0,j=n*t;N<j;N++)i[N]=0;for(let N=0,j=0;N<t;N++){const U=e.child(N);j++;for(let ae=0;;ae++){for(;r<i.length&&0!=i[r];)r++;if(ae==U.childCount)break;const we=U.child(ae),{colspan:be,rowspan:Ve,colwidth:Zt}=we.attrs;for(let xt=0;xt<Ve;xt++){if(xt+N>=t){(h||(h=[])).push({type:"overlong_rowspan",pos:j,n:Ve-xt});break}const Zn=r+xt*n;for(let Qt=0;Qt<be;Qt++){0==i[Zn+Qt]?i[Zn+Qt]=j:(h||(h=[])).push({type:"collision",row:N,pos:j,n:be-Qt});const Re=Zt&&Zt[Qt];if(Re){const jt=(Zn+Qt)%n*2,mo=_[jt];null==mo||mo!=Re&&1==_[jt+1]?(_[jt]=Re,_[jt+1]=1):mo==Re&&_[jt+1]++}}}r+=be,j+=we.nodeSize}const Y=(N+1)*n;let oe=0;for(;r<Y;)0==i[r++]&&oe++;oe&&(h||(h=[])).push({type:"missing",row:N,n:oe}),j++}const E=new it(n,t,i,h);let I=!1;for(let N=0;!I&&N<_.length;N+=2)null!=_[N]&&_[N+1]<t&&(I=!0);return I&&function Pl(e,n,t){e.problems||(e.problems=[]);const i={};for(let r=0;r<e.map.length;r++){const h=e.map[r];if(i[h])continue;i[h]=!0;const _=t.nodeAt(h);if(!_)throw new RangeError(`No cell with offset ${h} found`);let E=null;const I=_.attrs;for(let N=0;N<I.colspan;N++){const U=n[(r+N)%e.width*2];null!=U&&(!I.colwidth||I.colwidth[N]!=U)&&((E||(E=Rl(I)))[N]=U)}E&&e.problems.unshift({type:"colwidth mismatch",pos:h,colwidth:E})}}(E,_,e),E}(e))}};function Rl(e){if(e.colwidth)return e.colwidth.slice();const n=[];for(let t=0;t<e.colspan;t++)n.push(0);return n}function Ot(e){let n=e.cached.tableNodeTypes;if(!n){n=e.cached.tableNodeTypes={};for(const t in e.nodes){const i=e.nodes[t],r=i.spec.tableRole;r&&(n[r]=i)}}return n}var Ti=new ye.H$("selectingCells");function fo(e){for(let n=e.depth-1;n>0;n--)if("row"==e.node(n).type.spec.tableRole)return e.node(0).resolve(e.before(n+1));return null}function Tn(e){const n=e.selection.$head;for(let t=n.depth;t>0;t--)if("row"==n.node(t).type.spec.tableRole)return!0;return!1}function Rr(e){const n=e.selection;if("$anchorCell"in n&&n.$anchorCell)return n.$anchorCell.pos>n.$headCell.pos?n.$anchorCell:n.$headCell;if("node"in n&&n.node&&"cell"==n.node.type.spec.tableRole)return n.$anchor;const t=fo(n.$head)||function Ll(e){for(let n=e.nodeAfter,t=e.pos;n;n=n.firstChild,t++){const i=n.type.spec.tableRole;if("cell"==i||"header_cell"==i)return e.doc.resolve(t)}for(let n=e.nodeBefore,t=e.pos;n;n=n.lastChild,t--){const i=n.type.spec.tableRole;if("cell"==i||"header_cell"==i)return e.doc.resolve(t-n.nodeSize)}}(n.$head);if(t)return t;throw new RangeError(`No cell found around position ${n.head}`)}function ts(e){return"row"==e.parent.type.spec.tableRole&&!!e.nodeAfter}function ns(e,n){return e.depth==n.depth&&e.pos>=n.start(-1)&&e.pos<=n.end(-1)}function vs(e,n,t){const i=e.node(-1),r=it.get(i),h=e.start(-1),_=r.nextCell(e.pos-h,n,t);return null==_?null:e.node(0).resolve(h+_)}function Bi(e,n,t=1){const i={...e,colspan:e.colspan-t};return i.colwidth&&(i.colwidth=i.colwidth.slice(),i.colwidth.splice(n,t),i.colwidth.some(r=>r>0)||(i.colwidth=null)),i}function xs(e,n,t=1){const i={...e,colspan:e.colspan+t};if(i.colwidth){i.colwidth=i.colwidth.slice();for(let r=0;r<t;r++)i.colwidth.splice(n,0,0)}return i}var Qe=class Qn extends ye.Y1{constructor(n,t=n){const i=n.node(-1),r=it.get(i),h=n.start(-1),_=r.rectBetween(n.pos-h,t.pos-h),E=n.node(0),I=r.cellsInRect(_).filter(j=>j!=t.pos-h);I.unshift(t.pos-h);const N=I.map(j=>{const U=i.nodeAt(j);if(!U)throw RangeError(`No cell with offset ${j} found`);const Y=h+j+1;return new ye.xm(E.resolve(Y),E.resolve(Y+U.content.size))});super(N[0].$from,N[0].$to,N),this.$anchorCell=n,this.$headCell=t}map(n,t){const i=n.resolve(t.map(this.$anchorCell.pos)),r=n.resolve(t.map(this.$headCell.pos));if(ts(i)&&ts(r)&&ns(i,r)){const h=this.$anchorCell.node(-1)!=i.node(-1);return h&&this.isRowSelection()?Qn.rowSelection(i,r):h&&this.isColSelection()?Qn.colSelection(i,r):new Qn(i,r)}return ye.Bs.between(i,r)}content(){const n=this.$anchorCell.node(-1),t=it.get(n),i=this.$anchorCell.start(-1),r=t.rectBetween(this.$anchorCell.pos-i,this.$headCell.pos-i),h={},_=[];for(let I=r.top;I<r.bottom;I++){const N=[];for(let j=I*t.width+r.left,U=r.left;U<r.right;U++,j++){const Y=t.map[j];if(h[Y])continue;h[Y]=!0;const oe=t.findCell(Y);let ae=n.nodeAt(Y);if(!ae)throw RangeError(`No cell with offset ${Y} found`);const we=r.left-oe.left,be=oe.right-r.right;if(we>0||be>0){let Ve=ae.attrs;if(we>0&&(Ve=Bi(Ve,0,we)),be>0&&(Ve=Bi(Ve,Ve.colspan-be,be)),oe.left<r.left){if(ae=ae.type.createAndFill(Ve),!ae)throw RangeError(`Could not create cell with attrs ${JSON.stringify(Ve)}`)}else ae=ae.type.create(Ve,ae.content)}if(oe.top<r.top||oe.bottom>r.bottom){const Ve={...ae.attrs,rowspan:Math.min(oe.bottom,r.bottom)-Math.max(oe.top,r.top)};ae=oe.top<r.top?ae.type.createAndFill(Ve):ae.type.create(Ve,ae.content)}N.push(ae)}_.push(n.child(I).copy(Ke.HY.from(N)))}const E=this.isColSelection()&&this.isRowSelection()?n:_;return new Ke.p2(Ke.HY.from(E),1,1)}replace(n,t=Ke.p2.empty){const i=n.steps.length,r=this.ranges;for(let _=0;_<r.length;_++){const{$from:E,$to:I}=r[_],N=n.mapping.slice(i);n.replace(N.map(E.pos),N.map(I.pos),_?Ke.p2.empty:t)}const h=ye.Y1.findFrom(n.doc.resolve(n.mapping.slice(i).map(this.to)),-1);h&&n.setSelection(h)}replaceWith(n,t){this.replace(n,new Ke.p2(Ke.HY.from(t),0,0))}forEachCell(n){const t=this.$anchorCell.node(-1),i=it.get(t),r=this.$anchorCell.start(-1),h=i.cellsInRect(i.rectBetween(this.$anchorCell.pos-r,this.$headCell.pos-r));for(let _=0;_<h.length;_++)n(t.nodeAt(h[_]),r+h[_])}isColSelection(){const n=this.$anchorCell.index(-1),t=this.$headCell.index(-1);return!(Math.min(n,t)>0)&&Math.max(n+this.$anchorCell.nodeAfter.attrs.rowspan,t+this.$headCell.nodeAfter.attrs.rowspan)==this.$headCell.node(-1).childCount}static colSelection(n,t=n){const i=n.node(-1),r=it.get(i),h=n.start(-1),_=r.findCell(n.pos-h),E=r.findCell(t.pos-h),I=n.node(0);return _.top<=E.top?(_.top>0&&(n=I.resolve(h+r.map[_.left])),E.bottom<r.height&&(t=I.resolve(h+r.map[r.width*(r.height-1)+E.right-1]))):(E.top>0&&(t=I.resolve(h+r.map[E.left])),_.bottom<r.height&&(n=I.resolve(h+r.map[r.width*(r.height-1)+_.right-1]))),new Qn(n,t)}isRowSelection(){const n=this.$anchorCell.node(-1),t=it.get(n),i=this.$anchorCell.start(-1),r=t.colCount(this.$anchorCell.pos-i),h=t.colCount(this.$headCell.pos-i);return!(Math.min(r,h)>0)&&Math.max(r+this.$anchorCell.nodeAfter.attrs.colspan,h+this.$headCell.nodeAfter.attrs.colspan)==t.width}eq(n){return n instanceof Qn&&n.$anchorCell.pos==this.$anchorCell.pos&&n.$headCell.pos==this.$headCell.pos}static rowSelection(n,t=n){const i=n.node(-1),r=it.get(i),h=n.start(-1),_=r.findCell(n.pos-h),E=r.findCell(t.pos-h),I=n.node(0);return _.left<=E.left?(_.left>0&&(n=I.resolve(h+r.map[_.top*r.width])),E.right<r.width&&(t=I.resolve(h+r.map[r.width*(E.top+1)-1]))):(E.left>0&&(t=I.resolve(h+r.map[E.top*r.width])),_.right<r.width&&(n=I.resolve(h+r.map[r.width*(_.top+1)-1]))),new Qn(n,t)}toJSON(){return{type:"cell",anchor:this.$anchorCell.pos,head:this.$headCell.pos}}static fromJSON(n,t){return new Qn(n.resolve(t.anchor),n.resolve(t.head))}static create(n,t,i=t){return new Qn(n.resolve(t),n.resolve(i))}getBookmark(){return new Bl(this.$anchorCell.pos,this.$headCell.pos)}};Qe.prototype.visible=!1,ye.Y1.jsonID("cell",Qe);var Bl=class gl{constructor(n,t){this.anchor=n,this.head=t}map(n){return new gl(n.map(this.anchor),n.map(this.head))}resolve(n){const t=n.resolve(this.anchor),i=n.resolve(this.head);return"row"==t.parent.type.spec.tableRole&&"row"==i.parent.type.spec.tableRole&&t.index()<t.parent.childCount&&i.index()<i.parent.childCount&&ns(t,i)?new Qe(t,i):ye.Y1.near(i,1)}};function zl(e){if(!(e.selection instanceof Qe))return null;const n=[];return e.selection.forEachCell((t,i)=>{n.push(ln.p.node(i,i+t.nodeSize,{class:"selectedCell"}))}),ln.EH.create(e.doc,n)}var jl=new ye.H$("fix-tables");function ks(e,n,t,i){const r=e.childCount,h=n.childCount;e:for(let _=0,E=0;_<h;_++){const I=n.child(_);for(let N=E,j=Math.min(r,_+3);N<j;N++)if(e.child(N)==I){E=N+1,t+=I.nodeSize;continue e}i(I,t),E<r&&e.child(E).sameMarkup(I)?ks(e.child(E),I,t+1,i):I.nodesBetween(0,I.content.size,i,t+1),t+=I.nodeSize}}function ws(e,n){let t;const i=(r,h)=>{"table"==r.type.spec.tableRole&&(t=function Wl(e,n,t,i){const r=it.get(n);if(!r.problems)return i;i||(i=e.tr);const h=[];for(let I=0;I<r.height;I++)h.push(0);for(let I=0;I<r.problems.length;I++){const N=r.problems[I];if("collision"==N.type){const j=n.nodeAt(N.pos);if(!j)continue;const U=j.attrs;for(let Y=0;Y<U.rowspan;Y++)h[N.row+Y]+=N.n;i.setNodeMarkup(i.mapping.map(t+1+N.pos),null,Bi(U,U.colspan-N.n,N.n))}else if("missing"==N.type)h[N.row]+=N.n;else if("overlong_rowspan"==N.type){const j=n.nodeAt(N.pos);if(!j)continue;i.setNodeMarkup(i.mapping.map(t+1+N.pos),null,{...j.attrs,rowspan:j.attrs.rowspan-N.n})}else if("colwidth mismatch"==N.type){const j=n.nodeAt(N.pos);if(!j)continue;i.setNodeMarkup(i.mapping.map(t+1+N.pos),null,{...j.attrs,colwidth:N.colwidth})}}let _,E;for(let I=0;I<h.length;I++)h[I]&&(null==_&&(_=I),E=I);for(let I=0,N=t+1;I<r.height;I++){const j=n.child(I),U=N+j.nodeSize,Y=h[I];if(Y>0){let oe="cell";j.firstChild&&(oe=j.firstChild.type.spec.tableRole);const ae=[];for(let be=0;be<Y;be++){const Ve=Ot(e.schema)[oe].createAndFill();Ve&&ae.push(Ve)}i.insert(i.mapping.map(0!=I&&_!=I-1||E!=I?U-1:N+1),ae)}N=U}return i.setMeta(jl,{fixTables:!0})}(e,r,h,t))};return n?n.doc!=e.doc&&ks(n.doc,e.doc,0,i):e.doc.descendants(i),t}function is(e,n){const t=e.createAndFill();return new En.wx(t).replace(0,t.content.size,n).doc}function Ss(e,n,t,i,r,h,_,E){if(0==_||_==n.height)return!1;let I=!1;for(let N=r;N<h;N++){const j=_*n.width+N,U=n.map[j];if(n.map[j-n.width]==U){I=!0;const Y=t.nodeAt(U),{top:oe,left:ae}=n.findCell(U);e.setNodeMarkup(e.mapping.slice(E).map(U+i),null,{...Y.attrs,rowspan:_-oe}),e.insert(e.mapping.slice(E).map(n.positionAt(_,ae,t)),Y.type.createAndFill({...Y.attrs,rowspan:oe+Y.attrs.rowspan-_})),N+=Y.attrs.colspan-1}}return I}function Ms(e,n,t,i,r,h,_,E){if(0==_||_==n.width)return!1;let I=!1;for(let N=r;N<h;N++){const j=N*n.width+_,U=n.map[j];if(n.map[j-1]==U){I=!0;const Y=t.nodeAt(U),oe=n.colCount(U),ae=e.mapping.slice(E).map(U+i);e.setNodeMarkup(ae,null,Bi(Y.attrs,_-oe,Y.attrs.colspan-(_-oe))),e.insert(ae+Y.nodeSize,Y.type.createAndFill(Bi(Y.attrs,0,_-oe))),N+=Y.attrs.rowspan-1}}return I}function Es(e,n,t,i,r){let h=t?e.doc.nodeAt(t-1):e.doc;if(!h)throw new Error("No table found");let _=it.get(h);const{top:E,left:I}=i,N=I+r.width,j=E+r.height,U=e.tr;let Y=0;function oe(){if(h=t?U.doc.nodeAt(t-1):U.doc,!h)throw new Error("No table found");_=it.get(h),Y=U.mapping.maps.length}(function Gl(e,n,t,i,r,h,_){const I=Ot(e.doc.type.schema);let N,j;if(r>n.width)for(let U=0,Y=0;U<n.height;U++){const oe=t.child(U);Y+=oe.nodeSize;const ae=[];let we;we=null==oe.lastChild||oe.lastChild.type==I.cell?N||(N=I.cell.createAndFill()):j||(j=I.header_cell.createAndFill());for(let be=n.width;be<r;be++)ae.push(we);e.insert(e.mapping.slice(_).map(Y-1+i),ae)}if(h>n.height){const U=[];for(let ae=0,we=(n.height-1)*n.width;ae<Math.max(n.width,r);ae++){const be=!(ae>=n.width)&&t.nodeAt(n.map[we+ae]).type==I.header_cell;U.push(be?j||(j=I.header_cell.createAndFill()):N||(N=I.cell.createAndFill()))}const Y=I.row.create(null,Ke.HY.from(U)),oe=[];for(let ae=n.height;ae<h;ae++)oe.push(Y);e.insert(e.mapping.slice(_).map(i+t.nodeSize-2),oe)}return!(!N&&!j)})(U,_,h,t,N,j,Y)&&oe(),Ss(U,_,h,t,I,N,E,Y)&&oe(),Ss(U,_,h,t,I,N,j,Y)&&oe(),Ms(U,_,h,t,E,j,I,Y)&&oe(),Ms(U,_,h,t,E,j,N,Y)&&oe();for(let ae=E;ae<j;ae++){const we=_.positionAt(ae,I,h),be=_.positionAt(ae,N,h);U.replace(U.mapping.slice(Y).map(we+t),U.mapping.slice(Y).map(be+t),new Ke.p2(r.rows[ae-E],0,0))}oe(),U.setSelection(new Qe(U.doc.resolve(t+_.positionAt(E,I,h)),U.doc.resolve(t+_.positionAt(j-1,N-1,h)))),n(U)}var Zl=(0,si.$)({ArrowLeft:Lr("horiz",-1),ArrowRight:Lr("horiz",1),ArrowUp:Lr("vert",-1),ArrowDown:Lr("vert",1),"Shift-ArrowLeft":Hr("horiz",-1),"Shift-ArrowRight":Hr("horiz",1),"Shift-ArrowUp":Hr("vert",-1),"Shift-ArrowDown":Hr("vert",1),Backspace:Fr,"Mod-Backspace":Fr,Delete:Fr,"Mod-Delete":Fr});function Nr(e,n,t){return!t.eq(e.selection)&&(n&&n(e.tr.setSelection(t).scrollIntoView()),!0)}function Lr(e,n){return(t,i,r)=>{if(!r)return!1;const h=t.selection;if(h instanceof Qe)return Nr(t,i,ye.Y1.near(h.$headCell,n));if("horiz"!=e&&!h.empty)return!1;const _=Os(r,e,n);if(null==_)return!1;if("horiz"==e)return Nr(t,i,ye.Y1.near(t.doc.resolve(h.head+n),n));{const E=t.doc.resolve(_),I=vs(E,e,n);let N;return N=I?ye.Y1.near(I,1):n<0?ye.Y1.near(t.doc.resolve(E.before(-1)),-1):ye.Y1.near(t.doc.resolve(E.after(-1)),1),Nr(t,i,N)}}}function Hr(e,n){return(t,i,r)=>{if(!r)return!1;const h=t.selection;let _;if(h instanceof Qe)_=h;else{const I=Os(r,e,n);if(null==I)return!1;_=new Qe(t.doc.resolve(I))}const E=vs(_.$headCell,e,n);return!!E&&Nr(t,i,new Qe(_.$anchorCell,E))}}function Fr(e,n){const t=e.selection;if(!(t instanceof Qe))return!1;if(n){const i=e.tr,r=Ot(e.schema).cell.createAndFill().content;t.forEachCell((h,_)=>{h.content.eq(r)||i.replace(i.mapping.map(_+1),i.mapping.map(_+h.nodeSize-1),new Ke.p2(r,0,0))}),i.docChanged&&n(i)}return!0}function Ql(e,n){const i=fo(e.state.doc.resolve(n));return!!i&&(e.dispatch(e.state.tr.setSelection(new Qe(i))),!0)}function ql(e,n,t){if(!Tn(e.state))return!1;let i=function Jl(e){if(!e.size)return null;let{content:n,openStart:t,openEnd:i}=e;for(;1==n.childCount&&(t>0&&i>0||"table"==n.child(0).type.spec.tableRole);)t--,i--,n=n.child(0).content;const r=n.child(0),h=r.type.spec.tableRole,_=r.type.schema,E=[];if("row"==h)for(let I=0;I<n.childCount;I++){let N=n.child(I).content;const j=I?0:Math.max(0,t-1),U=I<n.childCount-1?0:Math.max(0,i-1);(j||U)&&(N=is(Ot(_).row,new Ke.p2(N,j,U)).content),E.push(N)}else{if("cell"!=h&&"header_cell"!=h)return null;E.push(t||i?is(Ot(_).row,new Ke.p2(n,t,i)).content:n)}return function Kl(e,n){const t=[];for(let r=0;r<n.length;r++){const h=n[r];for(let _=h.childCount-1;_>=0;_--){const{rowspan:E,colspan:I}=h.child(_).attrs;for(let N=r;N<r+E;N++)t[N]=(t[N]||0)+I}}let i=0;for(let r=0;r<t.length;r++)i=Math.max(i,t[r]);for(let r=0;r<t.length;r++)if(r>=n.length&&n.push(Ke.HY.empty),t[r]<i){const h=Ot(e).cell.createAndFill(),_=[];for(let E=t[r];E<i;E++)_.push(h);n[r]=n[r].append(Ke.HY.from(_))}return{height:n.length,width:i,rows:n}}(_,E)}(t);const r=e.state.selection;if(r instanceof Qe){i||(i={width:1,height:1,rows:[Ke.HY.from(is(Ot(e.state.schema).cell,t))]});const h=r.$anchorCell.node(-1),_=r.$anchorCell.start(-1),E=it.get(h).rectBetween(r.$anchorCell.pos-_,r.$headCell.pos-_);return i=function Yl({width:e,height:n,rows:t},i,r){if(e!=i){const h=[],_=[];for(let E=0;E<t.length;E++){const I=t[E],N=[];for(let j=h[E]||0,U=0;j<i;U++){let Y=I.child(U%I.childCount);j+Y.attrs.colspan>i&&(Y=Y.type.createChecked(Bi(Y.attrs,Y.attrs.colspan,j+Y.attrs.colspan-i),Y.content)),N.push(Y),j+=Y.attrs.colspan;for(let oe=1;oe<Y.attrs.rowspan;oe++)h[E+oe]=(h[E+oe]||0)+Y.attrs.colspan}_.push(Ke.HY.from(N))}t=_,e=i}if(n!=r){const h=[];for(let _=0,E=0;_<r;_++,E++){const I=[],N=t[E%n];for(let j=0;j<N.childCount;j++){let U=N.child(j);_+U.attrs.rowspan>r&&(U=U.type.create({...U.attrs,rowspan:Math.max(1,r-U.attrs.rowspan)},U.content)),I.push(U)}h.push(Ke.HY.from(I))}t=h,n=r}return{width:e,height:n,rows:t}}(i,E.right-E.left,E.bottom-E.top),Es(e.state,e.dispatch,_,E,i),!0}if(i){const h=Rr(e.state),_=h.start(-1);return Es(e.state,e.dispatch,_,it.get(h.node(-1)).findCell(h.pos-_),i),!0}return!1}function Xl(e,n){var t;if(n.ctrlKey||n.metaKey)return;const i=As(e,n.target);let r;if(n.shiftKey&&e.state.selection instanceof Qe)h(e.state.selection.$anchorCell,n),n.preventDefault();else if(n.shiftKey&&i&&null!=(r=fo(e.state.selection.$anchor))&&(null==(t=rs(e,n))?void 0:t.pos)!=r.pos)h(r,n),n.preventDefault();else if(!i)return;function h(I,N){let j=rs(e,N);const U=null==Ti.getState(e.state);if(!j||!ns(I,j)){if(!U)return;j=I}const Y=new Qe(I,j);if(U||!e.state.selection.eq(Y)){const oe=e.state.tr.setSelection(Y);U&&oe.setMeta(Ti,I.pos),e.dispatch(oe)}}function _(){e.root.removeEventListener("mouseup",_),e.root.removeEventListener("dragstart",_),e.root.removeEventListener("mousemove",E),null!=Ti.getState(e.state)&&e.dispatch(e.state.tr.setMeta(Ti,-1))}function E(I){const N=I,j=Ti.getState(e.state);let U;if(null!=j)U=e.state.doc.resolve(j);else if(As(e,N.target)!=i&&(U=rs(e,n),!U))return _();U&&h(U,N)}e.root.addEventListener("mouseup",_),e.root.addEventListener("dragstart",_),e.root.addEventListener("mousemove",E)}function Os(e,n,t){if(!(e.state.selection instanceof ye.Bs))return null;const{$head:i}=e.state.selection;for(let r=i.depth-1;r>=0;r--){const h=i.node(r);if((t<0?i.index(r):i.indexAfter(r))!=(t<0?0:h.childCount))return null;if("cell"==h.type.spec.tableRole||"header_cell"==h.type.spec.tableRole){const E=i.before(r);return e.endOfTextblock("vert"==n?t>0?"down":"up":t>0?"right":"left")?E:null}}return null}function As(e,n){for(;n&&n!=e.dom;n=n.parentNode)if("TD"==n.nodeName||"TH"==n.nodeName)return n;return null}function rs(e,n){const t=e.posAtCoords({left:n.clientX,top:n.clientY});return t&&t?fo(e.state.doc.resolve(t.pos)):null}var ea=class{constructor(e,n){this.node=e,this.cellMinWidth=n,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),this.colgroup=this.table.appendChild(document.createElement("colgroup")),ss(e,this.colgroup,this.table,n),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(e){return e.type==this.node.type&&(this.node=e,ss(e,this.colgroup,this.table,this.cellMinWidth),!0)}ignoreMutation(e){return"attributes"==e.type&&(e.target==this.table||this.colgroup.contains(e.target))}};function ss(e,n,t,i,r,h){var _;let E=0,I=!0,N=n.firstChild;const j=e.firstChild;if(j){for(let U=0,Y=0;U<j.childCount;U++){const{colspan:oe,colwidth:ae}=j.child(U).attrs;for(let we=0;we<oe;we++,Y++){const be=r==Y?h:ae&&ae[we],Ve=be?be+"px":"";E+=be||i,be||(I=!1),N?(N.style.width!=Ve&&(N.style.width=Ve),N=N.nextSibling):n.appendChild(document.createElement("col")).style.width=Ve}}for(;N;){const U=N.nextSibling;null==(_=N.parentNode)||_.removeChild(N),N=U}I?(t.style.width=E+"px",t.style.minWidth=""):(t.style.width="",t.style.minWidth=E+"px")}}var fn=new ye.H$("tableColumnResizing");function ta({handleWidth:e=5,cellMinWidth:n=25,View:t=ea,lastColumnResizable:i=!0}={}){const r=new ye.Sy({key:fn,state:{init:(h,_)=>(r.spec.props.nodeViews[Ot(_.schema).table.name]=(E,I)=>new t(E,n,I),new na(-1,!1)),apply:(h,_)=>_.apply(h)},props:{attributes:h=>{const _=fn.getState(h);return _&&_.activeHandle>-1?{class:"resize-cursor"}:{}},handleDOMEvents:{mousemove:(h,_)=>{!function ia(e,n,t,i,r){const h=fn.getState(e.state);if(h&&!h.dragging){const _=function la(e){for(;e&&"TD"!=e.nodeName&&"TH"!=e.nodeName;)e=e.classList&&e.classList.contains("ProseMirror")?null:e.parentNode;return e}(n.target);let E=-1;if(_){const{left:I,right:N}=_.getBoundingClientRect();n.clientX-I<=t?E=Is(e,n,"left",t):N-n.clientX<=t&&(E=Is(e,n,"right",t))}if(E!=h.activeHandle){if(!r&&-1!==E){const I=e.state.doc.resolve(E),N=I.node(-1),j=it.get(N),U=I.start(-1);if(j.colCount(I.pos-U)+I.nodeAfter.attrs.colspan-1==j.width-1)return}Ps(e,E)}}}(h,_,e,0,i)},mouseleave:h=>{!function oa(e){const n=fn.getState(e.state);n&&n.activeHandle>-1&&!n.dragging&&Ps(e,-1)}(h)},mousedown:(h,_)=>{!function ra(e,n,t){var i;const r=null!=(i=e.dom.ownerDocument.defaultView)?i:window,h=fn.getState(e.state);if(!h||-1==h.activeHandle||h.dragging)return!1;const _=e.state.doc.nodeAt(h.activeHandle),E=function sa(e,n,{colspan:t,colwidth:i}){const r=i&&i[i.length-1];if(r)return r;const h=e.domAtPos(n);let E=h.node.childNodes[h.offset].offsetWidth,I=t;if(i)for(let N=0;N<t;N++)i[N]&&(E-=i[N],I--);return E/I}(e,h.activeHandle,_.attrs);function I(j){r.removeEventListener("mouseup",I),r.removeEventListener("mousemove",N);const U=fn.getState(e.state);null!=U&&U.dragging&&(function aa(e,n,t){const i=e.state.doc.resolve(n),r=i.node(-1),h=it.get(r),_=i.start(-1),E=h.colCount(i.pos-_)+i.nodeAfter.attrs.colspan-1,I=e.state.tr;for(let N=0;N<h.height;N++){const j=N*h.width+E;if(N&&h.map[j]==h.map[j-h.width])continue;const U=h.map[j],Y=r.nodeAt(U).attrs,oe=1==Y.colspan?0:E-h.colCount(U);if(Y.colwidth&&Y.colwidth[oe]==t)continue;const ae=Y.colwidth?Y.colwidth.slice():ua(Y.colspan);ae[oe]=t,I.setNodeMarkup(_+U,null,{...Y,colwidth:ae})}I.docChanged&&e.dispatch(I)}(e,U.activeHandle,Ds(U.dragging,j,t)),e.dispatch(e.state.tr.setMeta(fn,{setDragging:null})))}function N(j){if(!j.which)return I(j);const U=fn.getState(e.state);if(U&&U.dragging){const Y=Ds(U.dragging,j,t);!function ca(e,n,t,i){const r=e.state.doc.resolve(n),h=r.node(-1),_=r.start(-1),E=it.get(h).colCount(r.pos-_)+r.nodeAfter.attrs.colspan-1;let I=e.domAtPos(r.start(-1)).node;for(;I&&"TABLE"!=I.nodeName;)I=I.parentNode;I&&ss(h,I.firstChild,I,i,E,t)}(e,U.activeHandle,Y,t)}}e.dispatch(e.state.tr.setMeta(fn,{setDragging:{startX:n.clientX,startWidth:E}})),r.addEventListener("mouseup",I),r.addEventListener("mousemove",N),n.preventDefault()}(h,_,n)}},decorations:h=>{const _=fn.getState(h);if(_&&_.activeHandle>-1)return function da(e,n){const t=[],i=e.doc.resolve(n),r=i.node(-1);if(!r)return ln.EH.empty;const h=it.get(r),_=i.start(-1),E=h.colCount(i.pos-_)+i.nodeAfter.attrs.colspan;for(let I=0;I<h.height;I++){const N=E+I*h.width-1;if(!(E!=h.width&&h.map[N]==h.map[N+1]||0!=I&&h.map[N]==h.map[N-h.width])){const j=h.map[N],U=_+j+r.nodeAt(j).nodeSize-1,Y=document.createElement("div");Y.className="column-resize-handle",t.push(ln.p.widget(U,Y))}}return ln.EH.create(e.doc,t)}(h,_.activeHandle)},nodeViews:{}}});return r}var na=class Ur{constructor(n,t){this.activeHandle=n,this.dragging=t}apply(n){const t=this,i=n.getMeta(fn);if(i&&null!=i.setHandle)return new Ur(i.setHandle,!1);if(i&&void 0!==i.setDragging)return new Ur(t.activeHandle,i.setDragging);if(t.activeHandle>-1&&n.docChanged){let r=n.mapping.map(t.activeHandle,-1);return ts(n.doc.resolve(r))||(r=-1),new Ur(r,t.dragging)}return t}};function Is(e,n,t,i){const h=e.posAtCoords({left:n.clientX+("right"==t?-i:i),top:n.clientY});if(!h)return-1;const{pos:_}=h,E=fo(e.state.doc.resolve(_));if(!E)return-1;if("right"==t)return E.pos;const I=it.get(E.node(-1)),N=E.start(-1),j=I.map.indexOf(E.pos-N);return j%I.width==0?-1:N+I.map[j-1]}function Ds(e,n,t){return Math.max(t,e.startWidth+(n.clientX-e.startX))}function Ps(e,n){e.dispatch(e.state.tr.setMeta(fn,{setHandle:n}))}function ua(e){return Array(e).fill(0)}function Hn(e){const n=e.selection,t=Rr(e),i=t.node(-1),r=t.start(-1),h=it.get(i);return{...n instanceof Qe?h.rectBetween(n.$anchorCell.pos-r,n.$headCell.pos-r):h.findCell(t.pos-r),tableStart:r,map:h,table:i}}function Rs(e,{map:n,tableStart:t,table:i},r){let h=r>0?-1:0;(function Fl(e,n,t){const i=Ot(n.type.schema).header_cell;for(let r=0;r<e.height;r++)if(n.nodeAt(e.map[t+r*e.width]).type!=i)return!1;return!0})(n,i,r+h)&&(h=0==r||r==n.width?null:0);for(let _=0;_<n.height;_++){const E=_*n.width+r;if(r>0&&r<n.width&&n.map[E-1]==n.map[E]){const I=n.map[E],N=i.nodeAt(I);e.setNodeMarkup(e.mapping.map(t+I),null,xs(N.attrs,r-n.colCount(I))),_+=N.attrs.rowspan-1}else{const I=null==h?Ot(i.type.schema).cell:i.nodeAt(n.map[E+h]).type,N=n.positionAt(_,r,i);e.insert(e.mapping.map(t+N),I.createAndFill())}}return e}function ha(e,{map:n,table:t,tableStart:i},r){const h=e.mapping.maps.length;for(let _=0;_<n.height;){const E=_*n.width+r,I=n.map[E],N=t.nodeAt(I),j=N.attrs;if(r>0&&n.map[E-1]==I||r<n.width-1&&n.map[E+1]==I)e.setNodeMarkup(e.mapping.slice(h).map(i+I),null,Bi(j,r-n.colCount(I)));else{const U=e.mapping.slice(h).map(i+I);e.delete(U,U+N.nodeSize)}_+=j.rowspan}}function Ns(e,{map:n,tableStart:t,table:i},r){var h;let _=t;for(let N=0;N<r;N++)_+=i.child(N).nodeSize;const E=[];let I=r>0?-1:0;(function ga(e,n,t){var i;const r=Ot(n.type.schema).header_cell;for(let h=0;h<e.width;h++)if((null==(i=n.nodeAt(e.map[h+t*e.width]))?void 0:i.type)!=r)return!1;return!0})(n,i,r+I)&&(I=0==r||r==n.height?null:0);for(let N=0,j=n.width*r;N<n.width;N++,j++)if(r>0&&r<n.height&&n.map[j]==n.map[j-n.width]){const U=n.map[j],Y=i.nodeAt(U).attrs;e.setNodeMarkup(t+U,null,{...Y,rowspan:Y.rowspan+1}),N+=Y.colspan-1}else{const U=null==I?Ot(i.type.schema).cell:null==(h=i.nodeAt(n.map[j+I*n.width]))?void 0:h.type,Y=null==U?void 0:U.createAndFill();Y&&E.push(Y)}return e.insert(_,Ot(i.type.schema).row.create(null,E)),e}function Ca(e,{map:n,table:t,tableStart:i},r){let h=0;for(let N=0;N<r;N++)h+=t.child(N).nodeSize;const _=h+t.child(r).nodeSize,E=e.mapping.maps.length;e.delete(h+i,_+i);const I=new Set;for(let N=0,j=r*n.width;N<n.width;N++,j++){const U=n.map[j];if(!I.has(U))if(I.add(U),r>0&&U==n.map[j-n.width]){const Y=t.nodeAt(U).attrs;e.setNodeMarkup(e.mapping.slice(E).map(U+i),null,{...Y,rowspan:Y.rowspan-1}),N+=Y.colspan-1}else if(r<n.height&&U==n.map[j+n.width]){const Y=t.nodeAt(U),oe=Y.attrs,ae=Y.type.create({...oe,rowspan:Y.attrs.rowspan-1},Y.content),we=n.positionAt(r+1,N,t);e.insert(e.mapping.slice(E).map(i+we),ae),N+=oe.colspan-1}}}function Ls(e){const n=e.content;return 1==n.childCount&&n.child(0).isTextblock&&0==n.child(0).childCount}function Hs(e,n){const t=e.selection;if(!(t instanceof Qe)||t.$anchorCell.pos==t.$headCell.pos)return!1;const i=Hn(e),{map:r}=i;if(function ya({width:e,height:n,map:t},i){let r=i.top*e+i.left,h=r,_=(i.bottom-1)*e+i.left,E=r+(i.right-i.left-1);for(let I=i.top;I<i.bottom;I++){if(i.left>0&&t[h]==t[h-1]||i.right<e&&t[E]==t[E+1])return!0;h+=e,E+=e}for(let I=i.left;I<i.right;I++){if(i.top>0&&t[r]==t[r-e]||i.bottom<n&&t[_]==t[_+e])return!0;r++,_++}return!1}(r,i))return!1;if(n){const h=e.tr,_={};let I,N,E=Ke.HY.empty;for(let j=i.top;j<i.bottom;j++)for(let U=i.left;U<i.right;U++){const Y=r.map[j*r.width+U],oe=i.table.nodeAt(Y);if(!_[Y]&&oe)if(_[Y]=!0,null==I)I=Y,N=oe;else{Ls(oe)||(E=E.append(oe.content));const ae=h.mapping.map(Y+i.tableStart);h.delete(ae,ae+oe.nodeSize)}}if(null==I||null==N)return!0;if(h.setNodeMarkup(I+i.tableStart,null,{...xs(N.attrs,N.attrs.colspan,i.right-i.left-N.attrs.colspan),rowspan:i.bottom-i.top}),E.size){const j=I+1+N.content.size,U=Ls(N)?I+1:j;h.replaceWith(U+i.tableStart,j+i.tableStart,E)}h.setSelection(new Qe(h.doc.resolve(I+i.tableStart))),n(h)}return!0}function Fs(e,n){const t=Ot(e.schema);return function va(e){return(n,t)=>{var i;const r=n.selection;let h,_;if(r instanceof Qe){if(r.$anchorCell.pos!=r.$headCell.pos)return!1;h=r.$anchorCell.nodeAfter,_=r.$anchorCell.pos}else{if(h=function Nl(e){for(let n=e.depth;n>0;n--){const t=e.node(n).type.spec.tableRole;if("cell"===t||"header_cell"===t)return e.node(n)}return null}(r.$from),!h)return!1;_=null==(i=fo(r.$from))?void 0:i.pos}if(null==h||null==_||1==h.attrs.colspan&&1==h.attrs.rowspan)return!1;if(t){let E=h.attrs;const I=[],N=E.colwidth;E.rowspan>1&&(E={...E,rowspan:1}),E.colspan>1&&(E={...E,colspan:1});const j=Hn(n),U=n.tr;for(let oe=0;oe<j.right-j.left;oe++)I.push(N?{...E,colwidth:N&&N[oe]?[N[oe]]:null}:E);let Y;for(let oe=j.top;oe<j.bottom;oe++){let ae=j.map.positionAt(oe,j.left,j.table);oe==j.top&&(ae+=h.nodeSize);for(let we=j.left,be=0;we<j.right;we++,be++)we==j.left&&oe==j.top||U.insert(Y=U.mapping.map(ae+j.tableStart,1),e({node:h,row:oe,col:we}).createAndFill(I[be]))}U.setNodeMarkup(_,e({node:h,row:j.top,col:j.left}),I[0]),r instanceof Qe&&U.setSelection(new Qe(U.doc.resolve(r.$anchorCell.pos),Y?U.doc.resolve(Y):void 0)),t(U)}return!0}}(({node:i})=>t[i.type.spec.tableRole])(e,n)}function Bs(e,n,t){const i=n.map.cellsInRect({left:0,top:0,right:"row"==e?n.map.width:1,bottom:"column"==e?n.map.height:1});for(let r=0;r<i.length;r++){const h=n.table.nodeAt(i[r]);if(h&&h.type!==t.header_cell)return!1}return!0}function jo(e,n){return(n=n||{useDeprecatedLogic:!1}).useDeprecatedLogic?function ka(e){return function(n,t){if(!Tn(n))return!1;if(t){const i=Ot(n.schema),r=Hn(n),h=n.tr,_=r.map.cellsInRect("column"==e?{left:r.left,top:0,right:r.right,bottom:r.map.height}:"row"==e?{left:0,top:r.top,right:r.map.width,bottom:r.bottom}:r),E=_.map(I=>r.table.nodeAt(I));for(let I=0;I<_.length;I++)E[I].type==i.header_cell&&h.setNodeMarkup(r.tableStart+_[I],i.cell,E[I].attrs);if(0==h.steps.length)for(let I=0;I<_.length;I++)h.setNodeMarkup(r.tableStart+_[I],i.header_cell,E[I].attrs);t(h)}return!0}}(e):function(t,i){if(!Tn(t))return!1;if(i){const r=Ot(t.schema),h=Hn(t),_=t.tr,E=Bs("row",h,r),I=Bs("column",h,r),j=("column"===e?E:"row"===e&&I)?1:0,Y="column"==e?I?r.cell:r.header_cell:"row"==e?E?r.cell:r.header_cell:r.cell;h.map.cellsInRect("column"==e?{left:0,top:j,right:1,bottom:h.map.height}:"row"==e?{left:j,top:0,right:h.map.width,bottom:1}:h).forEach(oe=>{const ae=oe+h.tableStart,we=_.doc.nodeAt(ae);we&&_.setNodeMarkup(ae,Y,we.attrs)}),i(_)}return!0}}jo("row",{useDeprecatedLogic:!0}),jo("column",{useDeprecatedLogic:!0});var wa=jo("cell",{useDeprecatedLogic:!0});function zs(e){return function(n,t){if(!Tn(n))return!1;const i=function Sa(e,n){if(n<0){const t=e.nodeBefore;if(t)return e.pos-t.nodeSize;for(let i=e.index(-1)-1,r=e.before();i>=0;i--){const h=e.node(-1).child(i),_=h.lastChild;if(_)return r-1-_.nodeSize;r-=h.nodeSize}}else{if(e.index()<e.parent.childCount-1)return e.pos+e.nodeAfter.nodeSize;const t=e.node(-1);for(let i=e.indexAfter(-1),r=e.after();i<t.childCount;i++){const h=t.child(i);if(h.childCount)return r+1;r+=h.nodeSize}}return null}(Rr(n),e);if(null==i)return!1;if(t){const r=n.doc.resolve(i);t(n.tr.setSelection(ye.Bs.between(r,function Hl(e){return e.node(0).resolve(e.pos+e.nodeAfter.nodeSize)}(r))).scrollIntoView())}return!0}}function Ea({allowTableNodeSelection:e=!1}={}){return new ye.Sy({key:Ti,state:{init:()=>null,apply(n,t){const i=n.getMeta(Ti);if(null!=i)return-1==i?null:i;if(null==t||!n.docChanged)return t;const{deleted:r,pos:h}=n.mapping.mapResult(t);return r?null:h}},props:{decorations:zl,handleDOMEvents:{mousedown:Xl},createSelectionBetween:n=>null!=Ti.getState(n.state)?n.state.selection:null,handleTripleClick:Ql,handleKeyDown:Zl,handlePaste:ql},appendTransaction:(n,t,i)=>function Ul(e,n,t){const i=(n||e).selection,r=(n||e).doc;let h,_;if(i instanceof ye.qv&&(_=i.node.type.spec.tableRole)){if("cell"==_||"header_cell"==_)h=Qe.create(r,i.from);else if("row"==_){const E=r.resolve(i.from+1);h=Qe.rowSelection(E,E)}else if(!t){const E=it.get(i.node),I=i.from+1;h=Qe.create(r,I+1,I+E.map[E.width*E.height-1])}}else i instanceof ye.Bs&&function $l({$from:e,$to:n}){if(e.pos==n.pos||e.pos<e.pos-6)return!1;let t=e.pos,i=n.pos,r=e.depth;for(;r>=0&&!(e.after(r+1)<e.end(r));r--,t++);for(let h=n.depth;h>=0&&!(n.before(h+1)>n.start(h));h--,i--);return t==i&&/row|table/.test(e.node(r).type.spec.tableRole)}(i)?h=ye.Bs.create(r,i.from):i instanceof ye.Bs&&function Vl({$from:e,$to:n}){let t,i;for(let r=e.depth;r>0;r--){const h=e.node(r);if("cell"===h.type.spec.tableRole||"header_cell"===h.type.spec.tableRole){t=h;break}}for(let r=n.depth;r>0;r--){const h=n.node(r);if("cell"===h.type.spec.tableRole||"header_cell"===h.type.spec.tableRole){i=h;break}}return t!==i&&0===n.parentOffset}(i)&&(h=ye.Bs.create(r,i.$from.start(),i.$from.end()));return h&&(n||(n=e.tr)).setSelection(h),n}(i,ws(i,t),e)})}function $s(e,n,t,i,r,h){let _=0,E=!0,I=n.firstChild;const N=e.firstChild;for(let j=0,U=0;j<N.childCount;j+=1){const{colspan:Y,colwidth:oe}=N.child(j).attrs;for(let ae=0;ae<Y;ae+=1,U+=1){const we=r===U?h:oe&&oe[ae],be=we?`${we}px`:"";_+=we||i,we||(E=!1),I?(I.style.width!==be&&(I.style.width=be),I=I.nextSibling):n.appendChild(document.createElement("col")).style.width=be}}for(;I;){const j=I.nextSibling;I.parentNode.removeChild(I),I=j}E?(t.style.width=`${_}px`,t.style.minWidth=""):(t.style.width="",t.style.minWidth=`${_}px`)}class Oa{constructor(n,t){this.node=n,this.cellMinWidth=t,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),this.colgroup=this.table.appendChild(document.createElement("colgroup")),$s(n,this.colgroup,this.table,t),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(n){return n.type===this.node.type&&(this.node=n,$s(n,this.colgroup,this.table,this.cellMinWidth),!0)}ignoreMutation(n){return"attributes"===n.type&&(n.target===this.table||this.colgroup.contains(n.target))}}function Vs(e,n){return n?e.createChecked(null,n):e.createAndFill()}const Br=({editor:e})=>{const{selection:n}=e.state;if(!function Pa(e){return e instanceof Qe}(n))return!1;let t=0;const i=(0,ie.findParentNodeClosestToPos)(n.ranges[0].$from,h=>"table"===h.type.name);return null==i||i.node.descendants(h=>{if("table"===h.type.name)return!1;["tableCell","tableHeader"].includes(h.type.name)&&(t+=1)}),t===n.ranges.length&&(e.commands.deleteTable(),!0)},Ra=ie.Node.create({name:"table",addOptions:()=>({HTMLAttributes:{},resizable:!1,handleWidth:5,cellMinWidth:25,View:Oa,lastColumnResizable:!0,allowTableNodeSelection:!1}),content:"tableRow+",tableRole:"table",isolating:!0,group:"block",parseHTML:()=>[{tag:"table"}],renderHTML({node:e,HTMLAttributes:n}){const{colgroup:t,tableWidth:i,tableMinWidth:r}=function Aa(e,n,t,i){let r=0,h=!0;const _=[],E=e.firstChild;if(!E)return{};for(let U=0,Y=0;U<E.childCount;U+=1){const{colspan:oe,colwidth:ae}=E.child(U).attrs;for(let we=0;we<oe;we+=1,Y+=1){const be=t===Y?i:ae&&ae[we],Ve=be?`${be}px`:"";r+=be||n,be||(h=!1),_.push(["col",Ve?{style:`width: ${Ve}`}:{}])}}const I=h?`${r}px`:"",N=h?"":`${r}px`;return{colgroup:["colgroup",{},..._],tableWidth:I,tableMinWidth:N}}(e,this.options.cellMinWidth);return["table",(0,ie.mergeAttributes)(this.options.HTMLAttributes,n,{style:i?`width: ${i}`:`minWidth: ${r}`}),t,["tbody",0]]},addCommands:()=>({insertTable:({rows:e=3,cols:n=3,withHeaderRow:t=!0}={})=>({tr:i,dispatch:r,editor:h})=>{const _=function Da(e,n,t,i,r){const h=function Ia(e){if(e.cached.tableNodeTypes)return e.cached.tableNodeTypes;const n={};return Object.keys(e.nodes).forEach(t=>{const i=e.nodes[t];i.spec.tableRole&&(n[i.spec.tableRole]=i)}),e.cached.tableNodeTypes=n,n}(e),_=[],E=[];for(let N=0;N<t;N+=1){const j=Vs(h.cell,r);if(j&&E.push(j),i){const U=Vs(h.header_cell,r);U&&_.push(U)}}const I=[];for(let N=0;N<n;N+=1)I.push(h.row.createChecked(null,i&&0===N?_:E));return h.table.createChecked(null,I)}(h.schema,e,n,t);if(r){const E=i.selection.anchor+1;i.replaceSelectionWith(_).scrollIntoView().setSelection(ye.Bs.near(i.doc.resolve(E)))}return!0},addColumnBefore:()=>({state:e,dispatch:n})=>function pa(e,n){if(!Tn(e))return!1;if(n){const t=Hn(e);n(Rs(e.tr,t,t.left))}return!0}(e,n),addColumnAfter:()=>({state:e,dispatch:n})=>function fa(e,n){if(!Tn(e))return!1;if(n){const t=Hn(e);n(Rs(e.tr,t,t.right))}return!0}(e,n),deleteColumn:()=>({state:e,dispatch:n})=>function ma(e,n){if(!Tn(e))return!1;if(n){const t=Hn(e),i=e.tr;if(0==t.left&&t.right==t.map.width)return!1;for(let r=t.right-1;ha(i,t,r),r!=t.left;r--){const h=t.tableStart?i.doc.nodeAt(t.tableStart-1):i.doc;if(!h)throw RangeError("No table found");t.table=h,t.map=it.get(h)}n(i)}return!0}(e,n),addRowBefore:()=>({state:e,dispatch:n})=>function _a(e,n){if(!Tn(e))return!1;if(n){const t=Hn(e);n(Ns(e.tr,t,t.top))}return!0}(e,n),addRowAfter:()=>({state:e,dispatch:n})=>function Ta(e,n){if(!Tn(e))return!1;if(n){const t=Hn(e);n(Ns(e.tr,t,t.bottom))}return!0}(e,n),deleteRow:()=>({state:e,dispatch:n})=>function ba(e,n){if(!Tn(e))return!1;if(n){const t=Hn(e),i=e.tr;if(0==t.top&&t.bottom==t.map.height)return!1;for(let r=t.bottom-1;Ca(i,t,r),r!=t.top;r--){const h=t.tableStart?i.doc.nodeAt(t.tableStart-1):i.doc;if(!h)throw RangeError("No table found");t.table=h,t.map=it.get(t.table)}n(i)}return!0}(e,n),deleteTable:()=>({state:e,dispatch:n})=>function Ma(e,n){const t=e.selection.$anchor;for(let i=t.depth;i>0;i--)if("table"==t.node(i).type.spec.tableRole)return n&&n(e.tr.delete(t.before(i),t.after(i)).scrollIntoView()),!0;return!1}(e,n),mergeCells:()=>({state:e,dispatch:n})=>Hs(e,n),splitCell:()=>({state:e,dispatch:n})=>Fs(e,n),toggleHeaderColumn:()=>({state:e,dispatch:n})=>jo("column")(e,n),toggleHeaderRow:()=>({state:e,dispatch:n})=>jo("row")(e,n),toggleHeaderCell:()=>({state:e,dispatch:n})=>wa(e,n),mergeOrSplit:()=>({state:e,dispatch:n})=>!!Hs(e,n)||Fs(e,n),setCellAttribute:(e,n)=>({state:t,dispatch:i})=>function xa(e,n){return function(t,i){if(!Tn(t))return!1;const r=Rr(t);if(r.nodeAfter.attrs[e]===n)return!1;if(i){const h=t.tr;t.selection instanceof Qe?t.selection.forEachCell((_,E)=>{_.attrs[e]!==n&&h.setNodeMarkup(E,null,{..._.attrs,[e]:n})}):h.setNodeMarkup(r.pos,null,{...r.nodeAfter.attrs,[e]:n}),i(h)}return!0}}(e,n)(t,i),goToNextCell:()=>({state:e,dispatch:n})=>zs(1)(e,n),goToPreviousCell:()=>({state:e,dispatch:n})=>zs(-1)(e,n),fixTables:()=>({state:e,dispatch:n})=>(n&&ws(e),!0),setCellSelection:e=>({tr:n,dispatch:t})=>{if(t){const i=Qe.create(n.doc,e.anchorCell,e.headCell);n.setSelection(i)}return!0}}),addKeyboardShortcuts(){return{Tab:()=>!!this.editor.commands.goToNextCell()||!!this.editor.can().addRowAfter()&&this.editor.chain().addRowAfter().goToNextCell().run(),"Shift-Tab":()=>this.editor.commands.goToPreviousCell(),Backspace:Br,"Mod-Backspace":Br,Delete:Br,"Mod-Delete":Br}},addProseMirrorPlugins(){return[...this.options.resizable&&this.editor.isEditable?[ta({handleWidth:this.options.handleWidth,cellMinWidth:this.options.cellMinWidth,View:this.options.View,lastColumnResizable:this.options.lastColumnResizable})]:[],Ea({allowTableNodeSelection:this.options.allowTableNodeSelection})]},extendNodeSchema:e=>({tableRole:(0,ie.callOrReturn)((0,ie.getExtensionField)(e,"tableRole",{name:e.name,options:e.options,storage:e.storage}))})});function Na(e,n){if(1&e&&(C.TgZ(0,"button",7),C._uU(1),C.qZA()),2&e){const t=n.$implicit;C.Q6J("value",t),C.xp6(1),C.hij(" ",t," ")}}function La(e,n){if(1&e&&(C.TgZ(0,"tui-data-list",5),C.YNc(1,Na,2,2,"button",6),C.qZA()),2&e){const t=C.oxw();C.xp6(1),C.Q6J("ngForOf",t.modes)}}function Ha(e,n){if(1&e){const t=C.EpF();C.TgZ(0,"tui-primitive-textfield",8),C.NdJ("valueChange",function(r){C.CHM(t);const h=C.oxw();return C.KtG(h.onHexChange(r))}),C.qZA()}if(2&e){const t=C.oxw();C.Q6J("maskito",t.hexMask)("tuiTextfieldLabelOutside",!0)("value",t.hex)}}function Fa(e,n){if(1&e){const t=C.EpF();C.TgZ(0,"tui-input-number",9),C.NdJ("ngModelChange",function(r){C.CHM(t);const h=C.oxw();return C.KtG(h.onRgbChange(r,h.color[1],h.color[2],h.color[3]))}),C.qZA(),C.TgZ(1,"tui-input-number",9),C.NdJ("ngModelChange",function(r){C.CHM(t);const h=C.oxw();return C.KtG(h.onRgbChange(h.color[0],r,h.color[2],h.color[3]))}),C.qZA(),C.TgZ(2,"tui-input-number",9),C.NdJ("ngModelChange",function(r){C.CHM(t);const h=C.oxw();return C.KtG(h.onRgbChange(h.color[0],h.color[1],r,h.color[3]))}),C.qZA()}if(2&e){const t=C.oxw();C.Q6J("max",255)("min",0)("ngModel",t.color[0])("tuiTextfieldLabelOutside",!0),C.xp6(1),C.Q6J("max",255)("min",0)("ngModel",t.color[1])("tuiTextfieldLabelOutside",!0),C.xp6(1),C.Q6J("max",255)("min",0)("ngModel",t.color[2])("tuiTextfieldLabelOutside",!0)}}function Ba(e,n){if(1&e){const t=C.EpF();C.TgZ(0,"div",1),C.NdJ("dblclick",function(){const h=C.CHM(t).index,_=C.oxw();return C.KtG(_.onClick(h))})("mousedown",function(){const h=C.CHM(t).index,_=C.oxw();return C.KtG(_.onMouseDown(h))}),C.qZA()}2&e&&C.Udp("left",100*n.$implicit,"%")}function $a(e,n){if(1&e){const t=C.EpF();C.TgZ(0,"button",1),C.NdJ("click",function(){const h=C.CHM(t).$implicit,_=C.oxw();return C.KtG(_.selectedColor.emit(h.value))}),C.qZA()}if(2&e){const t=n.$implicit;C.Udp("background",t.value),C.Q6J("id",t.key)("tuiHint",t.key)("tuiHintDescribe",t.key)}}function Va(e,n){if(1&e&&C._UZ(0,"tui-svg",9),2&e){const t=C.oxw(),i=C.MAs(1);C.ekj("t-arrow_rotated",i.open),C.Q6J("src",t.options.icons.colorSelectorDropdownChevron)}}function Ua(e,n){if(1&e&&C._UZ(0,"tui-svg",14),2&e){const t=C.oxw(3);C.Q6J("src",t.options.icons.colorSelectorDropdownCheck)}}function ja(e,n){if(1&e){const t=C.EpF();C.TgZ(0,"button",12),C.NdJ("click",function(){const h=C.CHM(t).$implicit,_=C.oxw(2),E=C.MAs(1);return C.KtG(_.onModeSelect(h,E))})("keydown.enter.prevent",function(){const h=C.CHM(t).$implicit,_=C.oxw(2),E=C.MAs(1);return C.KtG(_.onModeSelect(h,E))})("keydown.space.prevent",function(){const h=C.CHM(t).$implicit,_=C.oxw(2),E=C.MAs(1);return C.KtG(_.onModeSelect(h,E))}),C._uU(1),C.YNc(2,Ua,1,1,"tui-svg",13),C.qZA()}if(2&e){const t=n.$implicit,i=C.oxw(2);C.uIk("aria-checked",i.isModeActive(t)),C.xp6(1),C.hij(" ",t," "),C.xp6(1),C.Q6J("ngIf",i.isModeActive(t))}}function Wa(e,n){if(1&e&&(C.TgZ(0,"tui-data-list",10),C.YNc(1,ja,3,3,"button",11),C.qZA()),2&e){const t=C.oxw();C.xp6(1),C.Q6J("ngForOf",t.modes)}}function Ja(e,n){if(1&e){const t=C.EpF();C.TgZ(0,"button",20),C.NdJ("click",function(){const h=C.CHM(t).$implicit,_=C.oxw(2);return C.KtG(_.onDirectionChange(h))}),C.qZA()}if(2&e){const t=n.$implicit,i=C.oxw(2);C.ekj("t-direction_active",i.isDirectionActive(t)),C.Q6J("icon",i.getIcon(t))("tuiHint",t)}}function Ka(e,n){if(1&e){const t=C.EpF();C.ynx(0),C._UZ(1,"hr",15),C.TgZ(2,"div",16)(3,"tui-linear-multi-picker",17),C.NdJ("indexChange",function(r){C.CHM(t);const h=C.oxw();return C.KtG(h.onIndexChange(r))})("valueChange",function(r){C.CHM(t);const h=C.oxw();return C.KtG(h.onStopsChange(r))}),C.qZA()(),C.TgZ(4,"div",18),C.YNc(5,Ja,1,4,"button",19),C.qZA(),C.BQk()}if(2&e){const t=C.oxw();C.xp6(2),C.Udp("background",t.gradient),C.xp6(1),C.Q6J("value",t.stopsKeys),C.xp6(2),C.Q6J("ngForOf",t.buttons)}}function Ya(e,n){if(1&e){const t=C.EpF();C.TgZ(0,"tui-color-edit",21),C.NdJ("colorChange",function(r){C.CHM(t);const h=C.oxw();return C.KtG(h.onColorChange(r))}),C.qZA()}if(2&e){const t=C.oxw();C.Q6J("color",t.color)}}function Ga(e,n){if(1&e){const t=C.EpF();C.TgZ(0,"tui-palette",22),C.NdJ("selectedColor",function(r){C.CHM(t);const h=C.oxw();return C.KtG(h.onPalettePick(r))}),C.qZA()}if(2&e){const t=C.oxw();C.Q6J("colors",t.palette)}}Q(5664);const qc=["*"];function ou(e,n){if(1&e&&C._UZ(0,"div",4),2&e){const t=C.oxw();C.Udp("background",t.background)}}function ru(e,n){if(1&e){const t=C.EpF();C.TgZ(0,"tui-color-selector",5),C.NdJ("colorChange",function(r){C.CHM(t);const h=C.oxw();return C.KtG(h.value=r)}),C.qZA()}if(2&e){const t=n.$implicit,i=C.oxw();C.Q6J("colors",i.colors)("tuiActiveZoneParent",t)("color",i.value)}}let lu=(()=>{var e;class n{constructor(){this.color=[0,0,0,1],this.colorChange=new C.vpe,this.hexMask={mask:new RegExp("^[A-F\\d]{0,6}$","gi")},this.modes=["HEX","RGB"],this.mode=this.modes[0]}get isHex(){return this.mode===this.modes[0]}get hex(){return function Vt(e,n,t){return`#${[e,n,t].map(i=>i.toString(16).padStart(2,"0")).join("")}`}(this.color[0],this.color[1],this.color[2]).replace("#","")}get opacity(){return Math.round(100*this.color[3])}onHexChange(i){if(6!==i.length)return;const r=function Wi(e){const n=e.replace("#","").split("").map((t,i,r)=>3===r.length?t+t:t).join("").match(/.{2}/g);return n?n.map(t=>Number.parseInt(t,16)):[0,0,0]}(i);this.updateColor([r[0],r[1],r[2],this.color[3]])}onRgbChange(...i){this.updateColor(i)}updateColor(i){this.color=i,this.colorChange.emit(i)}}return(e=n).\u0275fac=function(i){return new(i||e)},e.\u0275cmp=C.Xpm({type:e,selectors:[["tui-color-edit"]],inputs:{color:"color"},outputs:{colorChange:"colorChange"},standalone:!0,features:[C.jDz],decls:6,vars:8,consts:[["tuiDropdownAlign","left","tuiDropdownLimitWidth","min","tuiTextfieldSize","m",1,"t-select","tui-group__auto-width-item",3,"tuiTextfieldLabelOutside","ngModel","ngModelChange"],["size","s",4,"tuiDataList"],["tuiTextfieldSize","m","tuiValueAccessor","",3,"maskito","tuiTextfieldLabelOutside","value","valueChange",4,"ngIf","ngIfElse"],["rgb",""],["decimal","never","tuiTextfieldPostfix","%","tuiTextfieldSize","m",1,"t-opacity","tui-group__auto-width-item",3,"max","min","ngModel","tuiTextfieldLabelOutside","ngModelChange"],["size","s"],["tuiOption","",3,"value",4,"ngFor","ngForOf"],["tuiOption","",3,"value"],["tuiTextfieldSize","m","tuiValueAccessor","",3,"maskito","tuiTextfieldLabelOutside","value","valueChange"],["decimal","never","tuiTextfieldSize","m",1,"t-rgb",3,"max","min","ngModel","tuiTextfieldLabelOutside","ngModelChange"]],template:function(i,r){if(1&i&&(C.TgZ(0,"tui-select",0),C.NdJ("ngModelChange",function(_){return r.mode=_}),C.YNc(1,La,2,1,"tui-data-list",1),C.qZA(),C.YNc(2,Ha,1,3,"tui-primitive-textfield",2),C.YNc(3,Fa,3,12,"ng-template",null,3,C.W1O),C.TgZ(5,"tui-input-number",4),C.NdJ("ngModelChange",function(_){return r.onRgbChange(r.color[0],r.color[1],r.color[2],_/100)}),C.qZA()),2&i){const h=C.MAs(4);C.Q6J("tuiTextfieldLabelOutside",!0)("ngModel",r.mode),C.xp6(2),C.Q6J("ngIf",r.isHex)("ngIfElse",h),C.xp6(3),C.Q6J("max",100)("min",0)("ngModel",r.opacity)("tuiTextfieldLabelOutside",!0)}},dependencies:[ct.Jy,ct.uJ,ct.OI,Mi.Ek,Le.cn,Le.xT,Le.sz,Le.Tq,Ne.u5,Ne.JJ,Ne.On,Nt.pc,Nt.qi,Nt.vK,Nt.gX,Lt.KW,Lt.yc,Lt.B1,Te.O5,vi.U5,vi.ro,Zi.S,Zi.n,Te.sg,Ei._H,Ei.qS,Ei.g5],styles:["[_nghost-%COMP%]{display:flex}.t-select[_ngcontent-%COMP%]{width:5.875rem}.t-opacity[_ngcontent-%COMP%]{width:4.275rem}.t-rgb[_ngcontent-%COMP%], .t-opacity[_ngcontent-%COMP%]{text-align:center}"],changeDetection:0}),n})();function Ws(e,n,t){const{left:i,top:r,width:h,height:_}=t.getBoundingClientRect();return[(0,kt.Ki)(e-i,0,h)/h,(0,kt.Ki)(n-r,0,_)/_]}let ho=(()=>{var e;class n extends $i.y{constructor(){const i=(0,C.f3M)(C.SBq).nativeElement,r=(0,C.f3M)(Te.K0),h=(0,Ie.mL)(i,"mousedown").pipe((0,Ie.mp)(),(0,xe.w)(_=>{const E=(0,Ie.mL)(r,"mousemove").pipe((0,ze.U)(({clientX:I,clientY:N})=>Ws(I,N,i)),(0,Oe.R)((0,Ie.mL)(r,"mouseup")));return _.target===i?E.pipe((0,Ce.O)(Ws(_.clientX,_.clientY,i))):E}),(0,Oe.R)((0,C.f3M)(Se.a3,{self:!0})));super(_=>h.subscribe(_))}}return(e=n).\u0275fac=function(i){return new(i||e)},e.\u0275prov=C.Yz7({token:e,factory:e.\u0275fac}),n})(),au=(()=>{var e;class n{constructor(){this.value=[0,0],this.valueChange=new C.vpe,(0,C.f3M)(ho).pipe((0,Oe.R)((0,C.f3M)(Se.a3,{self:!0}))).subscribe(i=>{this.value=i,this.valueChange.emit([i[0],i[1]])})}get left(){return 100*this.value[0]}get top(){return 100*this.value[1]}}return(e=n).\u0275fac=function(i){return new(i||e)},e.\u0275cmp=C.Xpm({type:e,selectors:[["tui-flat-picker"]],inputs:{value:"value"},outputs:{valueChange:"valueChange"},standalone:!0,features:[C._Bn([Se.a3,ho]),C.jDz],decls:1,vars:4,consts:[[1,"t-circle"]],template:function(i,r){1&i&&C._UZ(0,"div",0),2&i&&C.Udp("left",r.left,"%")("top",r.top,"%")},styles:["[_nghost-%COMP%]{position:relative;display:block}.t-circle[_ngcontent-%COMP%]{position:absolute;width:1rem;height:1rem;border-radius:100%;margin:-.5rem 0 0 -.5rem;box-shadow:inset 0 0 0 1px var(--tui-base-01),0 0 0 1px var(--tui-base-03)}"],changeDetection:0}),n})(),cu=(()=>{var e;class n{constructor(){this.value=0,this.valueChange=new C.vpe,(0,C.f3M)(ho).pipe((0,Oe.R)((0,C.f3M)(Se.a3,{self:!0}))).subscribe(([i])=>{this.value=i,this.valueChange.emit(i)})}get left(){return 100*this.value}}return(e=n).\u0275fac=function(i){return new(i||e)},e.\u0275cmp=C.Xpm({type:e,selectors:[["tui-linear-picker"]],inputs:{value:"value"},outputs:{valueChange:"valueChange"},standalone:!0,features:[C._Bn([Se.a3,ho]),C.jDz],decls:1,vars:2,consts:[[1,"t-circle"]],template:function(i,r){1&i&&C._UZ(0,"div",0),2&i&&C.Udp("left",r.left,"%")},styles:["[_nghost-%COMP%]{position:relative;display:block;height:1rem;box-sizing:border-box}.t-circle[_ngcontent-%COMP%]{position:absolute;width:1rem;height:1rem;border-radius:100%;margin:0 -.5rem;box-shadow:inset 0 0 0 2px var(--tui-base-01),0 0 0 1px var(--tui-base-03)}"],changeDetection:0}),n})(),uu=(()=>{var e;class n{constructor(){this.sanitizer=(0,C.f3M)($n.H7),this.colorChange=new C.vpe,this.point=[0,1],this.hue=0,this.opacity=1}set color(i){if(this.currentColor.every((E,I)=>E===i[I])&&i[3]===this.opacity)return;const[r,h,_]=function wi(e,n,t){const i=Math.max(e,n,t),r=i-Math.min(e,n,t),h=r&&(i===e?(n-t)/r:i===n?2+(t-e)/r:4+(e-n)/r);return[60*(h<0?h+6:h),i&&r/i,i]}(i[0],i[1],i[2]);this.opacity=i[3],this.hue=r/360,this.point=[h,1-_/255]}get currentColor(){return this.getCurrentColor(this.hue,this.point)}get base(){return`rgb(${Ji(360*this.hue,1,255)})`}get gradient(){return this.sanitizer.bypassSecurityTrustStyle(`linear-gradient(to right, rgba(${this.currentColor.join(",")}, 0), rgb(${this.currentColor.join(",")}))`)}onPointChange(i){this.point=i,this.updateColor()}onHueChange(i){this.hue=i,this.updateColor()}onOpacityChange(i){this.opacity=(0,kt.FG)(i,2),this.updateColor()}getCurrentColor(i,r){return Ji(360*i,r[0],255*(1-r[1]))}updateColor(){this.colorChange.emit([...this.currentColor,this.opacity])}}return(e=n).\u0275fac=function(i){return new(i||e)},e.\u0275cmp=C.Xpm({type:e,selectors:[["tui-color-picker"]],inputs:{color:"color"},outputs:{colorChange:"colorChange"},standalone:!0,features:[C.jDz],decls:5,vars:7,consts:[[1,"t-flat",3,"value","valueChange"],[1,"t-wrapper","t-wrapper_hue"],[1,"t-hue",3,"value","valueChange"],[1,"t-wrapper","t-wrapper_opacity"],[1,"t-opacity",3,"value","valueChange"]],template:function(i,r){1&i&&(C.TgZ(0,"tui-flat-picker",0),C.NdJ("valueChange",function(_){return r.onPointChange(_)}),C.qZA(),C.TgZ(1,"div",1)(2,"tui-linear-picker",2),C.NdJ("valueChange",function(_){return r.onHueChange(_)}),C.qZA()(),C.TgZ(3,"div",3)(4,"tui-linear-picker",4),C.NdJ("valueChange",function(_){return r.onOpacityChange(_)}),C.qZA()()),2&i&&(C.Udp("background-color",r.base),C.Q6J("value",r.point),C.xp6(2),C.Q6J("value",r.hue),C.xp6(1),C.Udp("background",r.gradient),C.xp6(1),C.Q6J("value",r.opacity))},dependencies:[au,cu],styles:['[_nghost-%COMP%]{position:relative;z-index:0;display:block}.t-flat[_ngcontent-%COMP%]{height:14rem;background:linear-gradient(#0000,#000),linear-gradient(to right,#fff,#fff0);margin-bottom:.25rem;overflow:hidden}.t-wrapper[_ngcontent-%COMP%]{position:relative;margin:1rem 1.25rem;border-radius:.5rem}.t-wrapper[_ngcontent-%COMP%]:after{position:absolute;top:0;left:0;width:100%;height:100%;content:"";box-shadow:inset 0 0 0 1px #00000014;pointer-events:none;border-radius:inherit}.t-wrapper_hue[_ngcontent-%COMP%]{background:red}.t-wrapper_opacity[_ngcontent-%COMP%]:before{position:absolute;top:0;left:0;width:100%;height:100%;content:"";z-index:-1;background-image:linear-gradient(45deg,var(--tui-base-03) 25%,transparent 25%,transparent 75%,var(--tui-base-03) 75%,var(--tui-base-03)),linear-gradient(45deg,var(--tui-base-03) 25%,transparent 25%,transparent 75%,var(--tui-base-03) 75%,var(--tui-base-03));background-size:.375rem .375rem;background-position:0 0,.1875rem .1875rem;border-radius:inherit}.t-hue[_ngcontent-%COMP%]{background:linear-gradient(to right,red,#ff0,#0f0,#0ff,#00f,#f0f,red);border-radius:inherit;margin:0 .5rem}.t-opacity[_ngcontent-%COMP%]{border-radius:inherit;margin:0 .5rem}'],changeDetection:0}),(0,Ae.gn)([at.UM],n.prototype,"getCurrentColor",null),n})();const Gs=(0,Me.jH)({translate:"no",spellcheck:!1,enableDefaultStyles:!0,colors:new Map([["color-black-100","#909090"],["color-black-200","#666666"],["color-black-300","#333333"],["color-blue-100","#1771e6"],["color-blue-200","#1464cc"],["color-blue-300","#0953b3"],["color-gray-100","#f5f5f6"],["color-gray-200","#e7e8ea"],["color-gray-300","#cbcfd3"],["color-gray-400","#959ba4"],["color-gray-500","#79818c"],["color-gray-600","#616871"],["color-green-100","#39b54a"],["color-green-200","#2ca53a"],["color-green-300","#168a21"],["color-light-blue-100","#ecf1f7"],["color-light-blue-200","#e4ebf3"],["color-light-blue-300","#dde4ed"],["color-red-100","#e01f19"],["color-red-200","#d3120e"],["color-red-300","#c40b08"],["color-yellow-100","#FFDD2C"],["color-yellow-200","#FCC521"],["color-yellow-300","#FAB618"],["transparent","transparent"]]),blankColor:"rgb(51, 51, 51)",linkOptions:{protocol:"https://"},fontOptions:function pu(e){return[{px:13,name:e.small},{px:15,name:e.normal},{px:17,name:e.large},{px:24,family:"var(--tui-font-heading)",name:e.subtitle,headingLevel:2,weight:"bold"},{px:30,family:"var(--tui-font-heading)",name:e.title,headingLevel:1,weight:"bold"}]},icons:{undo:"tuiIconUndoLarge",redo:"tuiIconRedoLarge",quote:"tuiIconQuoteLarge",link:"tuiIconLinkLarge",anchor:"tuiIconAnchorLarge",attach:"tuiIconPaperclipLarge",sub:"tuiIconSubscriptLarge",sup:"tuiIconSuperscriptLarge",tex:"tuiIconTeXLarge",image:"tuiIconImageLarge",hr:"tuiIconHrLarge",clear:"tuiIconClearFormatLarge",groupAdd:"tuiIconPlusLarge",groupRemove:"tuiIconCloseLarge",detailsAdd:"tuiIconSpoilerLarge",detailsRemove:"tuiIconSpoilerDeleteLarge",popupLinkSave:"tuiIconCheckCircleLarge",popupLinkRemove:"tuiIconCloseLarge",popupPreviewLinkEdit:"tuiIconEdit2Large",popupPreviewLinkClear:"tuiIconUnlinkLarge",paint:"tuiIconPaintLarge",textAlignPreview:"tuiIconAlignLeftLarge",textAlignLeft:"tuiIconAlignLeftLarge",textAlignCenter:"tuiIconAlignCenterLarge",textAlignRight:"tuiIconAlignRightLarge",textAlignJustify:"tuiIconAlignJustifyLarge",textColor:"tuiIconColorLarge",textHilite:"tuiIconHiliteLarge",listPreview:"tuiIconListLarge",listUnOrdered:"tuiIconListLarge",listOrdered:"tuiIconOLLarge",indent:"tuiIconIndentLarge",outdent:"tuiIconOutdentLarge",fontSize:"tuiIconFontLarge",insertTable:"tuiIconTableLarge",addRowTable:"tuiIconAddRowLarge",code:"tuiIconCodeLarge",fontStylePreview:"tuiIconFormatLarge",fontStyleBold:"tuiIconBoldLarge",fontStyleItalic:"tuiIconItalicLarge",fontStyleUnderline:"tuiIconUnderlineLarge",fontStyleStrike:"tuiIconStrikeThroughLarge",colorSelectorDropdownChevron:"tuiIconChevronDown",colorSelectorDropdownCheck:"tuiIconCheck"}}),mu=new C.OlP("[TUI_EDITOR_COLOR_SELECTOR_MODE_NAMES]",{factory:()=>["Solid color","Gradient"]});function Zs(e){return e.slice(0,Math.max(0,e.length-1)).replace("linear-gradient(","")}new C.OlP("[TUI_EDITOR_TOOLBAR_TEXTS]",{factory:(0,Sn.v)("toolbarTools")}),new C.OlP("[TUI_EDITOR_TABLE_COMMANDS]",{factory:(0,Sn.v)("editorTableCommands")}),new C.OlP("[TUI_EDITOR_LINK_TEXTS]",{factory:(0,Sn.v)("editorEditLink")}),new C.OlP("[TUI_EDITOR_CODE_OPTIONS]",{factory:(0,Sn.v)("editorCodeOptions")}),new C.OlP("[TUI_EDITOR_FONT_OPTIONS]",{factory:(0,Sn.v)("editorFontOptions")});const yu=["\\s*(","(?:","#(?:[a-f0-9]{6}|[a-f0-9]{3})","|","(?:rgb|hsl)","\\(\\s*(?:\\d{1,3}\\s*,\\s*){2}\\d{1,3}\\s*\\)","|","(?:rgba|hsla)","\\(\\s*(?:\\d{1,3}\\s*,\\s*){2}\\d{1,3}\\s*,\\s*\\d*\\.?\\d+\\)","|","[_a-z-][_a-z0-9-]*",")",")","(?:\\s+","(","(?:[+-]?\\d*\\.?\\d+)(?:%|[a-z]+)?","))?","(?:","\\s*,\\s*","\\s*)?"];function vu(e,n){const t=1===n?"100%":`${n}%`;return null!=e&&e.includes("%")?e:t}function Qs(e){const n=new RegExp(yu.join(""),"gi"),t=e.startsWith("to")||e.match(/^\d/)?e.slice(Math.max(0,e.indexOf(",")+1)).trim():e,i=e.startsWith("to")?e.split(",")[0]:"to bottom";let r=[],h=n.exec(t);for(;null!==h;)r=r.concat({color:h[1],position:vu(h[2],r.length)}),h=n.exec(t);return r=r.filter(({color:_})=>_.startsWith("#")||_.startsWith("rgb")),{stops:r,side:i}}let xu=(()=>{var e;class n{constructor(){this.value=[0,1],this.valueChange=new C.vpe,this.indexChange=new C.vpe,this.index=NaN,(0,C.f3M)(ho).pipe((0,Oe.R)((0,C.f3M)(Se.a3,{self:!0}))).subscribe(([i])=>this.onPicker(i))}onMouseUp(){this.index=NaN}onMouseDown(i){this.updateIndex(i)}onClick(i){this.value.length>2&&this.updateValue(this.value.filter((r,h)=>h!==i))}onPicker(i){Number.isNaN(this.index)&&(this.updateIndex(this.value.length),this.value=[...this.value,0]),!this.value.some((r,h)=>r===i&&h!==this.index)&&this.updateValue(this.value.map((r,h)=>h===this.index?i:r))}updateIndex(i){this.index=i,this.indexChange.emit(i)}updateValue(i){this.value=i,this.valueChange.emit(i)}}return(e=n).\u0275fac=function(i){return new(i||e)},e.\u0275cmp=C.Xpm({type:e,selectors:[["tui-linear-multi-picker"]],hostBindings:function(i,r){1&i&&C.NdJ("mouseup",function(){return r.onMouseUp()},!1,C.evT)},inputs:{value:"value"},outputs:{valueChange:"valueChange",indexChange:"indexChange"},standalone:!0,features:[C._Bn([Se.a3,ho]),C.jDz],decls:1,vars:1,consts:[["class","t-circle",3,"left","dblclick","mousedown",4,"ngFor","ngForOf"],[1,"t-circle",3,"dblclick","mousedown"]],template:function(i,r){1&i&&C.YNc(0,Ba,1,2,"div",0),2&i&&C.Q6J("ngForOf",r.value)},dependencies:[Te.sg],styles:["[_nghost-%COMP%]{position:relative;display:block;height:1rem;box-sizing:border-box}.t-circle[_ngcontent-%COMP%]{position:absolute;width:1rem;height:1rem;border-radius:100%;margin:0 -.5rem;box-shadow:inset 0 0 0 2px var(--tui-base-01),0 0 0 1px var(--tui-base-03)}"],changeDetection:0}),n})(),ku=(()=>{var e;class n{constructor(){this.colors=new Map,this.selectedColor=new C.vpe,this.originalOrder=(i,r)=>0}}return(e=n).\u0275fac=function(i){return new(i||e)},e.\u0275cmp=C.Xpm({type:e,selectors:[["tui-palette"]],inputs:{colors:"colors"},outputs:{selectedColor:"selectedColor"},standalone:!0,features:[C.jDz],decls:2,vars:4,consts:[["type","button","class","t-button",3,"id","background","tuiHint","tuiHintDescribe","click",4,"ngFor","ngForOf"],["type","button",1,"t-button",3,"id","tuiHint","tuiHintDescribe","click"]],template:function(i,r){1&i&&(C.YNc(0,$a,1,5,"button",0),C.ALo(1,"keyvalue")),2&i&&C.Q6J("ngForOf",C.xi3(1,1,r.colors,r.originalOrder))},dependencies:[Te.Nd,Te.sg,bt.go,bt.D,bt.xn,bt.t6,bt.$o,bt.DM],styles:["[_nghost-%COMP%]{display:flex;flex-wrap:wrap;padding:.875rem}.t-button[_ngcontent-%COMP%]{-webkit-appearance:none;appearance:none;padding:0;border:0;background:none;font-size:inherit;line-height:inherit;text-decoration:none;width:1.5625rem;height:1.5625rem;box-sizing:border-box;margin:.375rem;border-radius:var(--tui-radius-m);border:1px solid rgba(0,0,0,.08)}"],changeDetection:0}),n})();const wu=[0,0,0,0],qs=[[0,[0,0,0,1]],[1,[255,255,255,1]]],Su={"to top right":"tuiIconArrowUpRight","to right":"tuiIconArrowRight","to bottom right":"tuiIconArrowDownRight","to bottom":"tuiIconArrowDown","to bottom left":"tuiIconArrowDownLeft","to left":"tuiIconArrowLeft","to top left":"tuiIconArrowUpLeft","to top":"tuiIconArrowUp"};let Mu=(()=>{var e;class n{constructor(){this.sanitizer=(0,C.f3M)($n.H7),this.stops=new Map(qs),this.currentStop=0,this.direction="to bottom",this.colors=new Map,this.colorChange=new C.vpe,this.options=(0,C.f3M)(Gs),this.modes=(0,C.f3M)(mu),this.color=[0,0,0,1],this.currentMode=this.modes[0],this.buttons=["to top right","to right","to bottom right","to bottom","to bottom left","to left","to top left","to top"]}set colorSetter(i){this.parse(i)}get palette(){return this.filterPalette(this.colors,this.isGradient)}get stopsKeys(){return this.getStopsKeys(this.stops)}get currentColor(){return this.isGradient?this.getStop(this.currentStop):this.color}get gradient(){return this.sanitizer.bypassSecurityTrustStyle(this.getGradient("to right"))}get isGradient(){return this.currentMode===this.modes[1]}getIcon(i){return Su[i]}isModeActive(i){return this.currentMode===i}isDirectionActive(i){return this.direction===i}onPalettePick(i){this.updateColor(i)}onDirectionChange(i){this.direction=i,this.updateColor(this.getGradient(i))}onModeSelect(i,r){this.currentMode=i,r.open=!1,this.updateColor(i===this.modes[0]?`rgba(${this.color.join(", ")})`:this.getGradient(this.direction))}onIndexChange(i){this.currentStop=this.stopsKeys[i]}onColorChange(i){this.isGradient?(this.stops.set(this.currentStop,i),this.updateColor(this.getGradient(this.direction))):this.updateColor(`rgba(${i.join(", ")})`)}onStopsChange(i){const r=this.stopsKeys.find(_=>!i.includes(_)),h=i.find(_=>!this.stopsKeys.includes(_));void 0===r&&void 0!==h&&this.addStop(h),void 0!==r&&void 0===h&&this.removeStop(r),void 0!==r&&void 0!==h&&this.replaceStop(r,h),this.updateColor(this.getGradient(this.direction))}getStopsKeys(i){return Array.from(i.keys())}filterPalette(i,r){const h=new Map(i);return h.forEach((_,E)=>{(_.startsWith("linear-gradient")&&!r||!_.startsWith("linear-gradient")&&r)&&h.delete(E)}),h}updateColor(i){this.colorChange.emit(i)}getGradient(i){return`linear-gradient(${i}, ${[...this.stopsKeys].sort(Me.A2).map(r=>`rgba(${this.getStop(r).join(", ")}) ${100*r}%`).join(", ")})`}getStop(i){return this.stops.get(i)||wu}addStop(i){const r=this.stopsKeys.reduce((h,_)=>Math.abs(_-i)<Math.abs(h-i)?_:h,this.stopsKeys[0]);this.stops.set(i,this.getStop(r)),this.stops=new Map(this.stops),this.currentStop=i}removeStop(i){this.stops.delete(i),this.stops=new Map(this.stops),this.currentStop=this.stopsKeys[0]}replaceStop(i,r){const h=this.getStop(i);this.currentStop=r,this.stops=new Map(this.stopsKeys.map(_=>_===i?[r,h]:[_,this.getStop(_)]))}parse(i){i.startsWith("linear-gradient")?this.parseGradient(i):this.parseColor(i)}parseGradient(i){if(i===this.getGradient(this.direction))return;const r=Qs(Zs(i));this.currentMode=this.modes[1],this.direction=r.side,this.currentStop=0,this.stops=new Map(r.stops.length?r.stops.map(({color:h,position:_})=>[parseFloat(_)/100,xn(h)]):qs)}parseColor(i){this.currentMode=this.modes[0],this.currentStop=0,this.color=xn(i)}}return(e=n).\u0275fac=function(i){return new(i||e)},e.\u0275cmp=C.Xpm({type:e,selectors:[["tui-color-selector"]],inputs:{colors:"colors",colorSetter:["color","colorSetter"]},outputs:{colorChange:"colorChange"},standalone:!0,features:[C.jDz],decls:12,vars:7,consts:[[1,"t-select",3,"content"],["dropdown",""],["appearance","","size","s","tuiButton","","type","button",3,"iconRight"],["arrow",""],["menu",""],[4,"ngIf"],[3,"color","colorChange"],["tuiGroup","","class","t-edit",3,"color","colorChange",4,"ngIf"],["class","t-palette",3,"colors","selectedColor",4,"ngIf"],[1,"t-arrow",3,"src"],["role","menu","size","s",1,"t-menu"],["role","menuitemradio","tuiOption","",3,"click","keydown.enter.prevent","keydown.space.prevent",4,"ngFor","ngForOf"],["role","menuitemradio","tuiOption","",3,"click","keydown.enter.prevent","keydown.space.prevent"],["class","t-checkmark",3,"src",4,"ngIf"],[1,"t-checkmark",3,"src"],[1,"t-hr"],[1,"t-wrapper"],[1,"t-gradient",3,"value","indexChange","valueChange"],[1,"t-buttons"],["appearance","","size","xs","tuiHintDescribe","","tuiIconButton","","type","button","class","t-direction",3,"t-direction_active","icon","tuiHint","click",4,"ngFor","ngForOf"],["appearance","","size","xs","tuiHintDescribe","","tuiIconButton","","type","button",1,"t-direction",3,"icon","tuiHint","click"],["tuiGroup","",1,"t-edit",3,"color","colorChange"],[1,"t-palette",3,"colors","selectedColor"]],template:function(i,r){if(1&i&&(C.TgZ(0,"tui-hosted-dropdown",0,1)(2,"button",2),C._uU(3),C.qZA(),C.YNc(4,Va,1,3,"ng-template",null,3,C.W1O),C.YNc(6,Wa,2,1,"ng-template",null,4,C.W1O),C.qZA(),C.YNc(8,Ka,6,4,"ng-container",5),C.TgZ(9,"tui-color-picker",6),C.NdJ("colorChange",function(_){return r.onColorChange(_)}),C.qZA(),C.YNc(10,Ya,1,1,"tui-color-edit",7),C.YNc(11,Ga,1,1,"tui-palette",8)),2&i){const h=C.MAs(5),_=C.MAs(7);C.Q6J("content",_),C.xp6(2),C.Q6J("iconRight",h),C.xp6(1),C.hij(" ",r.currentMode," "),C.xp6(5),C.Q6J("ngIf",r.isGradient),C.xp6(1),C.Q6J("color",r.currentColor),C.xp6(1),C.Q6J("ngIf",!r.isGradient),C.xp6(1),C.Q6J("ngIf",r.palette.size)}},dependencies:[Te.O5,wn.jh,wn.o1,Pe.fN,Pe.v0,ve.EI,ve.PN,Nt.pc,Nt.qi,Nt.vK,Te.sg,bt.go,bt.D,bt.xn,bt.t6,bt.$o,bt.DM,xu,uu,lu,ku,ot.gZ],styles:['[_nghost-%COMP%]{position:relative;z-index:0;display:block;width:22.6rem}.t-wrapper[_ngcontent-%COMP%]{position:relative;margin:1.25rem;border-radius:.5rem}.t-wrapper[_ngcontent-%COMP%]:after{position:absolute;top:0;left:0;width:100%;height:100%;content:"";box-shadow:inset 0 0 0 1px #00000014;pointer-events:none;border-radius:inherit}.t-wrapper[_ngcontent-%COMP%]:before{position:absolute;top:0;left:0;width:100%;height:100%;content:"";z-index:-1;background-image:linear-gradient(45deg,var(--tui-base-03) 25%,transparent 25%,transparent 75%,var(--tui-base-03) 75%,var(--tui-base-03)),linear-gradient(45deg,var(--tui-base-03) 25%,transparent 25%,transparent 75%,var(--tui-base-03) 75%,var(--tui-base-03));background-size:.375rem .375rem;background-position:0 0,.1875rem .1875rem;border-radius:inherit}.t-hr[_ngcontent-%COMP%]{height:1px;margin:0 0 0 -1px;border:none;background:var(--tui-base-03)}.t-gradient[_ngcontent-%COMP%]{margin:0 .5rem;border-radius:inherit}.t-select[_ngcontent-%COMP%]{margin:.75rem .5rem}.t-arrow[_ngcontent-%COMP%]{transition-property:transform;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out}.t-arrow_rotated[_ngcontent-%COMP%]{transform:rotate(180deg)}.t-menu[_ngcontent-%COMP%]{width:11.25rem}.t-checkmark[_ngcontent-%COMP%]{margin-left:auto;width:1rem;height:1rem}.t-buttons[_ngcontent-%COMP%]{display:flex;padding:0 .75rem 1.25rem}.t-direction[_ngcontent-%COMP%]{color:var(--tui-text-02);margin:0 .375rem}.t-direction[_ngcontent-%COMP%]:hover, .t-direction_active[_ngcontent-%COMP%]{color:var(--tui-text-01);background:var(--tui-secondary-hover)}.t-edit[_ngcontent-%COMP%]{margin:1.25rem}.t-palette[_ngcontent-%COMP%]{box-sizing:border-box;box-shadow:inset 0 1px var(--tui-base-03)}'],changeDetection:0}),(0,Ae.gn)([at.UM],n.prototype,"getStopsKeys",null),(0,Ae.gn)([at.UM],n.prototype,"filterPalette",null),n})();new C.OlP("[TIPTAP_EDITOR]"),new C.OlP("[LAZY_TIPTAP_EDITOR]",{factory:()=>{const e=new Vi.t(1);return Promise.resolve().then(Q.bind(Q,9911)).then(n=>e.next(n.Editor)),e}}),new C.OlP("[INITIALIZATION_TIPTAP_CONTAINER]");ie.Extension.create({name:"backgroundColor",addOptions:()=>({types:["textStyle"]}),addGlobalAttributes(){return[{types:this.options.types,attributes:{backgroundColor:{default:null,renderHTML:({backgroundColor:e})=>e?{style:`background-color: ${e}`}:{},parseHTML:({style:e})=>e.backgroundColor.replaceAll(/['"]+/g,""),keepOnSplit:!1}}}]},addCommands:()=>({setBackgroundColor:e=>({chain:n})=>n().setMark("textStyle",{backgroundColor:e}).run(),unsetBackgroundColor:()=>({chain:e})=>e().setMark("textStyle",{backgroundColor:null}).run()})});ie.Node.create({name:"details",addOptions:()=>({HTMLAttributes:{}}),addAttributes:()=>({opened:{default:!0,keepOnSplit:!1,parseHTML:e=>"true"===e.getAttribute("data-opened"),renderHTML:e=>({"data-opened":e.opened})}}),content:"summary detailsContent",group:"block",allowGapCursor:!0,isolating:!0,parseHTML:()=>[{tag:"details"}],renderHTML({HTMLAttributes:e}){return["div",{class:"t-details-wrapper t-details-wrapper_rendered"},["details",(0,ie.mergeAttributes)(this.options.HTMLAttributes,e),0],["button",{class:"t-details-arrow"}]]},addNodeView:()=>({node:e})=>{const n=document.createElement("div"),t=document.createElement("details"),i=document.createElement("button");return n.className="t-details-wrapper",i.className="t-details-arrow",t.open=e.attrs.opened,i.addEventListener("click",()=>{t.open=!t.open,e.attrs.opened=t.open}),n.append(t,i),{dom:n,contentDOM:t}},addCommands(){return{setDetails:()=>({commands:e,state:n})=>{const t=function rl(e,n){const t=n??e.selection.$head.parent.textContent,i=e.doc.cut(e.selection.from,e.selection.to);return i.content.size?(0,ie.getHTMLFromFragment)(i.content,e.schema):t}(n);return e.insertContent(`<details data-opened="true"><summary><p></p></summary><div data-type="details-content"><p>${t}</p></div></details><p></p>`)},removeDetails:()=>({state:e,dispatch:n})=>function ol(e,n,t){const i=e.selection.$anchor;for(let r=i.depth;r>0;r--)if(i.node(r).type.name===t)return n&&n(e.tr.delete(i.before(r),i.after(r)).scrollIntoView()),!0;return!1}(e,n,this.name)}}}),ie.Node.create({name:"detailsContent",content:"block+",group:"block",allowGapCursor:!0,parseHTML:()=>[{tag:'div[data-type="details-content"]'}],renderHTML({HTMLAttributes:e}){return["div",(0,ie.mergeAttributes)(this.options.HTMLAttributes,e,{"data-type":"details-content"}),0]}}),ie.Node.create({name:"summary",addOptions:()=>({HTMLAttributes:{}}),content:"paragraph",group:"block",parseHTML:()=>[{tag:"summary"}],renderHTML({HTMLAttributes:e}){return["summary",(0,ie.mergeAttributes)(this.options.HTMLAttributes,e),0]}}),ie.Extension.create({name:"fontColor",addOptions:()=>({types:["textStyle"]}),addGlobalAttributes(){return[{types:this.options.types,attributes:{fontColor:{default:null,renderHTML:({fontColor:e})=>e?{style:`color: ${e}`}:{},parseHTML:({style:e})=>e.color.replaceAll(/['"]+/g,""),keepOnSplit:!1}}}]},addCommands:()=>({setFontColor:e=>({chain:n})=>n().setMark("textStyle",{fontColor:e}).run(),unsetFontColor:()=>({chain:e})=>e().setMark("textStyle",{fontColor:null}).run()})}),ie.Mark.create({name:"jumpAnchor",priority:1e3,keepOnSplit:!1,addAttributes:()=>({id:{default:null,parseHTML:e=>e.getAttribute("id"),renderHTML:e=>e.id?{id:e.id}:{}}}),parseHTML:()=>[{tag:'a[data-type="jump-anchor"]'}],renderHTML:({HTMLAttributes:e})=>["a",(0,ie.mergeAttributes)({"data-type":"jump-anchor"},e),0],addCommands(){return{setAnchor:e=>({chain:n})=>n().extendMarkRange("jumpAnchor").setMark("jumpAnchor",{id:e}).run(),removeAnchor:()=>({chain:e})=>e().unsetMark(this.name,{extendEmptyMarkRange:!0}).run()}}});const Nu=ie.Extension.create({name:"starterKit",addExtensions(){const e=[],n=this.options;return!1!==(null==n?void 0:n.blockquote)&&e.push(Qi.configure(null==n?void 0:n.blockquote)),!1!==(null==n?void 0:n.bold)&&e.push(Mn.configure(null==n?void 0:n.bold)),!1!==(null==n?void 0:n.bulletList)&&e.push(ko.configure(null==n?void 0:n.bulletList)),!1!==(null==n?void 0:n.code)&&e.push(sn.configure(null==n?void 0:n.code)),!1!==(null==n?void 0:n.codeBlock)&&e.push(wo.configure(null==n?void 0:n.codeBlock)),!1!==(null==n?void 0:n.document)&&e.push(So.configure(null==n?void 0:n.document)),!1!==(null==n?void 0:n.dropcursor)&&e.push(On.configure(null==n?void 0:n.dropcursor)),!1!==(null==n?void 0:n.gapcursor)&&e.push(no.configure(null==n?void 0:n.gapcursor)),!1!==(null==n?void 0:n.hardBreak)&&e.push(Jn.configure(null==n?void 0:n.hardBreak)),!1!==(null==n?void 0:n.heading)&&e.push(io.configure({levels:[1,2,3,4,5,6],...null==n?void 0:n.heading}).extend({addKeyboardShortcuts(){return this.options.levels.reduce((t,i)=>({...t||{},[`Mod-Alt-${i}`]:()=>null==this?void 0:this.editor.commands.toggleHeading({level:i})}),{})}})),!1!==(null==n?void 0:n.history)&&e.push(Ko.configure({depth:100,newGroupDelay:500,...null==n?void 0:n.history})),!1!==(null==n?void 0:n.horizontalRule)&&e.push(Yo.configure(null==n?void 0:n.horizontalRule)),!1!==(null==n?void 0:n.italic)&&e.push(Qo.configure(null==n?void 0:n.italic)),!1!==(null==n?void 0:n.listItem)&&e.push(qo.configure(null==n?void 0:n.listItem)),!1!==(null==n?void 0:n.orderedList)&&e.push(Do.configure(null==n?void 0:n.orderedList)),!1!==(null==n?void 0:n.paragraph)&&e.push(lo.configure(null==n?void 0:n.paragraph)),!1!==(null==n?void 0:n.strike)&&e.push(pi.configure(null==n?void 0:n.strike)),!1!==(null==n?void 0:n.text)&&e.push(dn.configure(null==n?void 0:n.text)),e}});co.extend({}).configure({autoplay:!1,ccLanguage:"en",interfaceLanguage:"en",allowFullscreen:!0,disableKBcontrols:!0}),new C.OlP("[TUI_EDITOR_CONTENT_PROCESSOR]",{factory:()=>Co.y}),new C.OlP("[TUI_ATTACH_FILES_OPTIONS]",{factory:()=>({accept:"*/*",multiple:!0})}),new C.OlP("[TUI_ATTACH_FILES_LOADER]"),new C.OlP("[TUI_IMAGE_LOADER]",{factory:()=>e=>{const n=new FileReader;return n.readAsDataURL(e),(0,Ie.mL)(n,"load").pipe((0,ze.U)(()=>String(n.result)))}}),new C.OlP("[TUI_EDITOR_EXTENSIONS]"),new C.OlP("[LAZY_EDITOR_EXTENSIONS]");let Ku=(()=>{var e;class n extends $e.M${constructor(){super(...arguments),this.domSanitizer=(0,C.f3M)($n.H7),this.colors=new Map,this.open=!1}get nativeFocusableElement(){return this.computedDisabled||!this.textfield?null:this.textfield.nativeFocusableElement}get focused(){return!!this.dropdown&&this.dropdown.focused}get background(){return this.sanitize(this.value,this.domSanitizer)}onClick(){this.open=!this.open}onFocused(i){this.updateFocused(i)}getFallbackValue(){return"#000000"}sanitize(i,r){return i.startsWith("linear-gradient(")?r.bypassSecurityTrustStyle(function Ju({stops:e,side:n}){return`linear-gradient(${n}, ${e.map(({color:t,position:i})=>`rgba(${xn(t).join(", ")}) ${i}`).join(", ")})`}(Qs(Zs(i)))):i}}return(e=n).\u0275fac=function(){let t;return function(r){return(t||(t=C.n5z(e)))(r||e)}}(),e.\u0275cmp=C.Xpm({type:e,selectors:[["tui-input-color"]],viewQuery:function(i,r){if(1&i&&(C.Gf(Lt.yc,5),C.Gf(wn.o1,5)),2&i){let h;C.iGM(h=C.CRH())&&(r.textfield=h.first),C.iGM(h=C.CRH())&&(r.dropdown=h.first)}},hostBindings:function(i,r){1&i&&C.NdJ("click",function(){return r.onClick()})},inputs:{colors:"colors"},standalone:!0,features:[C._Bn([],[(0,Mi.fx)({maxHeight:600})]),C.qOj,C.jDz],ngContentSelectors:qc,decls:7,vars:12,consts:[[1,"t-wrapper",3,"content","open","openChange"],[1,"t-textfield",3,"disabled","focusable","invalid","nativeId","pseudoActive","pseudoFocus","pseudoHover","readOnly","tuiTextfieldIconLeft","value","valueChange","focusedChange"],["color",""],["picker",""],[1,"t-color"],[3,"colors","tuiActiveZoneParent","color","colorChange"]],template:function(i,r){if(1&i&&(C.F$t(),C.TgZ(0,"tui-hosted-dropdown",0),C.NdJ("openChange",function(_){return r.open=_}),C.TgZ(1,"tui-primitive-textfield",1),C.NdJ("valueChange",function(_){return r.value=_})("focusedChange",function(_){return r.onFocused(_)}),C.Hsn(2),C.qZA()(),C.YNc(3,ou,1,2,"ng-template",null,2,C.W1O),C.YNc(5,ru,1,3,"ng-template",null,3,C.W1O)),2&i){const h=C.MAs(4),_=C.MAs(6);C.Q6J("content",_)("open",r.open),C.xp6(1),C.Q6J("disabled",r.disabled)("focusable",r.focusable)("invalid",r.computedInvalid)("nativeId",r.nativeId)("pseudoActive",r.pseudoActive)("pseudoFocus",r.computedFocused)("pseudoHover",r.pseudoHover)("readOnly",r.readOnly)("tuiTextfieldIconLeft",h)("value",r.value)}},dependencies:[wn.jh,wn.o1,Lt.KW,Lt.yc,Lt.B1,Le.cn,Le.aR,Mu,Si.e],styles:["[_nghost-%COMP%]{display:block;border-radius:var(--tui-radius-m);text-align:left}.t-wrapper[_ngcontent-%COMP%]{display:flex;border-radius:inherit}.t-textfield[_ngcontent-%COMP%]{border-radius:inherit;text-align:inherit}.t-color[_ngcontent-%COMP%]{width:1.5rem;height:1.5rem;box-shadow:inset 0 0 0 1px var(--tui-base-03-dark);border-radius:.125rem;pointer-events:auto!important}"],changeDetection:0}),(0,Ae.gn)([at.UM],n.prototype,"sanitize",null),n})();const cl=["id","class","src","style","controls","loop","muted","preload","autoplay","width","height","controlsList"];ie.Extension.create({name:"fileLink",addCommands:()=>({setFileLink:e=>({state:n,chain:t})=>{const{selection:i}=n,h='<span style="font-size: 15px"> </span>';return(Math.abs(i.to-i.from)>0?t().toggleMark("link",{href:e.link},{extendEmptyMarkRange:!0}).setTextSelection(i.to).insertContent(h):t().insertContent(`<a href="${e.link}">${e.name}</a>${h}`)).setTextSelection(i.to).run()}})}),ie.Extension.create({name:"fontSize",addOptions:()=>({types:["textStyle"]}),addGlobalAttributes(){return[{types:this.options.types,attributes:{fontSize:{default:null,parseHTML:({style:e})=>e.fontSize,renderHTML:({fontSize:e})=>e?{style:`font-size: ${e}`}:{}}}}]},addCommands:()=>({setFontSize:e=>({chain:n})=>n().setMark("textStyle",{fontSize:e}).run(),unsetFontSize:()=>({chain:e})=>e().setMark("textStyle",{fontSize:null}).removeEmptyTextStyle().run()})}),ie.Extension.create({name:"indent",addKeyboardShortcuts(){return{Tab:()=>!function Zu(e){return e.isActive("bulletList")||e.isActive("orderedList")}(this.editor)&&this.editor.commands.insertContent("\t")}}});function $r(e){return e.reduce((n,t)=>(n[t]={parseHTML:i=>null==i?void 0:i.getAttribute(`${t}`)},n),{})}Al.extend({addAttributes(){var e;return{...null==(e=this.parent)?void 0:e.call(this),...$r(["download"])}},addCommands(){var e;return{...null==(e=this.parent)?void 0:e.call(this),toggleLink:n=>({chain:t,state:i})=>{{const{selection:r,doc:h}=i,_=h.cut(r.to,r.to+1),I=" "===(0,ie.getHTMLFromFragment)(_.content,i.schema).replaceAll(/<\/?[^>]+(>|$)/g,""),N=t().toggleMark(this.name,n,{extendEmptyMarkRange:!0});return(I?N.setTextSelection(r.to+1):N.setTextSelection(r.to).insertContent('<span style="font-size: 15px"> </span>')).run()}}}},addPasteRules(){return[(0,ie.markPasteRule)({find:e=>Pr(e).filter(n=>{var t,i;return(null==(i=(t=this.options).validate)?void 0:i.call(t,n.value))??!0}).filter(n=>n.isLink).map(n=>({text:n.value,index:n.start,data:n})),type:this.type,getAttributes:e=>{var n;return{href:null==(n=e.data)?void 0:n.href}}})]}}).configure({openOnClick:!1}),Ra.extend({renderHTML({node:e,HTMLAttributes:n}){var r,h;let t=0,i=!0;try{const _=(null==(r=e.content)?void 0:r.content)[0];null==(h=null==_?void 0:_.content)||h.content.forEach(E=>{E.attrs.colwidth?E.attrs.colwidth.forEach(I=>{I?t+=I:(i=!1,t+=this.options.cellMinWidth)}):(i=!1,t+=this.options.cellMinWidth*(E.attrs.colspan||1))})}catch{i=!1}return n.style=i&&t>0?`width: ${t}px;`:t&&t>0?`min-width: ${t}px`:null,["div",{class:"tui-table-wrapper"},["table",(0,ie.mergeAttributes)(this.options.HTMLAttributes,n),["tbody",0]]]}}).configure({resizable:!0}).extend(),ie.Extension.create({addGlobalAttributes:()=>[{types:["tableCell","tableHeader"],attributes:{background:{default:null,renderHTML:({background:e})=>e?{style:`background: ${e}`}:null,parseHTML:({style:e})=>e.background,keepOnSplit:!1}}}],addCommands:()=>({setCellBackground:e=>({chain:n})=>n().updateAttributes("tableCell",{background:e}).updateAttributes("tableHeader",{background:e}).run(),unsetCellBackground:()=>({chain:e})=>e().updateAttributes("tableCell",{background:null}).updateAttributes("tableHeader",{background:null}).run()})});function dl(e){const n=[];return e.content.forEach(t=>{t instanceof Ke.NB&&n.push([t.type.name,t.attrs])}),n}Nu.configure({heading:{levels:[1,2,3,4,5,6]}}),Q.e(296).then(Q.bind(Q,3296)).then(({TextAlign:e})=>e.configure({types:["heading","paragraph"]})),Promise.resolve().then(Q.bind(Q,3740)).then(({TextStyle:e})=>e),Q.e(157).then(Q.bind(Q,157)).then(({Underline:e})=>e),Q.e(483).then(Q.bind(Q,1483)).then(({Subscript:e})=>e),Q.e(639).then(Q.bind(Q,9639)).then(({Superscript:e})=>e),Promise.resolve().then(Q.bind(Q,5664)).then(({default:e})=>e.configure({inline:!0,allowBase64:!0})),Q.e(216).then(Q.bind(Q,3216)).then(({TableRow:e})=>e),Q.e(994).then(Q.bind(Q,6994)).then(({TableCell:e})=>e),Q.e(971).then(Q.bind(Q,4971)).then(({TableHeader:e})=>e),new C.OlP("[TUI_IFRAME_EDITOR_OPTIONS]",{factory:()=>({minWidth:100,maxWidth:1/0,minHeight:100,maxHeight:1/0})}),new C.OlP("[TUI_IMAGE_EDITOR_OPTIONS]",{factory:()=>({minWidth:100,maxWidth:1/0})}),ie.Node.create({name:"audio",group:"block",content:"source+",addAttributes:()=>$r(cl),parseHTML:()=>[{tag:"audio"}],renderHTML:({node:e,HTMLAttributes:n})=>["audio",n,...dl(e)]}),ie.Node.create({name:"source",addAttributes:()=>$r(["src","type","width","height","media","sizes","srcset"]),parseHTML:()=>[{tag:"source"}],renderHTML:({HTMLAttributes:e})=>["source",(0,ie.mergeAttributes)(e)]}),ie.Node.create({name:"video",group:"block",content:"source+",addAttributes:()=>$r(cl),parseHTML:()=>[{tag:"video"}],renderHTML:({node:e,HTMLAttributes:n})=>["video",n,...dl(e)]}),new C.OlP("[TUI_EDITOR_VALUE_TRANSFORMER]");var ld=Q(5332),ad=Q(1498),cd=Q(5995),ud=Q(3778),dd=Q(108),pd=Q(4559),fd=Q(5537),hd=Q(201),md=Q(9273),gd=Q(4824),_d=Q(4098),Td=Q(2362);let Cd=(()=>{var e;class n{transform(i){return i*Math.PI/180}}return e=n,(0,z.Z)(n,"\u0275fac",function(i){return new(i||e)}),(0,z.Z)(n,"\u0275pipe",C.Yjl({name:"rad",type:e,pure:!0,standalone:!0})),n})();var bd=Q(4220);function yd(e,n){if(1&e&&C._UZ(0,"tui-data-list-wrapper",32),2&e){const t=C.oxw();C.Q6J("items",t.items)}}const vd=(()=>{var e;class n{constructor(){(0,z.Z)(this,"x1",20),(0,z.Z)(this,"y1",20),(0,z.Z)(this,"w1",100),(0,z.Z)(this,"h1",50),(0,z.Z)(this,"x2",50),(0,z.Z)(this,"y2",50),(0,z.Z)(this,"w2",100),(0,z.Z)(this,"h2",50),(0,z.Z)(this,"c2","#00ff00"),(0,z.Z)(this,"dX",0),(0,z.Z)(this,"dY",0),(0,z.Z)(this,"dWidth",100),(0,z.Z)(this,"dHeight",100),(0,z.Z)(this,"globalCompositeOperation","source-over"),(0,z.Z)(this,"mouth",30),(0,z.Z)(this,"blur",0),(0,z.Z)(this,"offset",0),(0,z.Z)(this,"font",'bold 40px "Lucida Bright"'),(0,z.Z)(this,"text","PAC-MAN"),(0,z.Z)(this,"color","#ffa500"),(0,z.Z)(this,"file",null),(0,z.Z)(this,"image",new Image),(0,z.Z)(this,"items",["source-over","multiply","screen"]),this.image.onload=()=>{URL.revokeObjectURL(this.image.src)}}onFile(i){this.file=i,i&&(this.image.src=URL.createObjectURL(i))}}return e=n,(0,z.Z)(n,"\u0275fac",function(i){return new(i||e)}),(0,z.Z)(n,"\u0275cmp",C.Xpm({type:e,selectors:[["audio-page"]],standalone:!0,features:[C.jDz],decls:71,vars:61,consts:[["tuiLabel","x",1,"child"],["max","300","min","0","tuiSlider","","type","range",3,"ngModel","ngModelChange"],["tuiLabel","y",1,"child"],["max","150","min","0","tuiSlider","","type","range",3,"ngModel","ngModelChange"],["tuiLabel","width",1,"child"],["tuiLabel","height",1,"child"],[1,"row"],["tuiTextfieldSize","m",1,"child",3,"ngModel","ngModelChange"],[3,"items",4,"tuiDataList"],[1,"child",3,"ngModel","ngModelChange"],["accept","image/*","tuiInputFiles",""],[1,"child",3,"expanded"],[1,"controls"],["tuiLabel","dX"],["tuiLabel","dY"],["tuiLabel","dWidth"],["tuiLabel","dHeight"],["waCanvas2d",""],[3,"dHeight","dWidth","dX","dY","image"],["fillStyle","#f00"],[3,"height","width","x","y"],[3,"fillStyle","globalCompositeOperation"],["tuiLabel","Pac-Man mouth",1,"child"],["max","45","min","0.01","tuiSlider","","type","range",3,"ngModel","ngModelChange"],["tuiLabel","Pac-Man shadow blur",1,"child"],["max","10","min","0","tuiSlider","","type","range",3,"ngModel","ngModelChange"],["tuiLabel","Pac-Man shadow distance",1,"child"],["waCanvas2d","",3,"height","transform","width"],["fillStyle","gold","shadowColor","grey",3,"shadowBlur","shadowOffsetY"],[3,"endAngle","radius","startAngle","x","y"],[3,"x","y"],[3,"fillStyle","font","maxWidth","text","x","y"],[3,"items"]],template:function(i,r){1&i&&(C.TgZ(0,"h2"),C._uU(1,"Basic example"),C.qZA(),C.TgZ(2,"section")(3,"fieldset")(4,"label",0)(5,"input",1),C.NdJ("ngModelChange",function(_){return r.x1=_}),C.qZA()(),C.TgZ(6,"label",2)(7,"input",3),C.NdJ("ngModelChange",function(_){return r.y1=_}),C.qZA()(),C.TgZ(8,"label",4)(9,"input",1),C.NdJ("ngModelChange",function(_){return r.w1=_}),C.qZA()(),C.TgZ(10,"label",5)(11,"input",3),C.NdJ("ngModelChange",function(_){return r.h1=_}),C.qZA()()(),C.TgZ(12,"fieldset")(13,"label",0)(14,"input",1),C.NdJ("ngModelChange",function(_){return r.x2=_}),C.qZA()(),C.TgZ(15,"label",2)(16,"input",3),C.NdJ("ngModelChange",function(_){return r.y2=_}),C.qZA()(),C.TgZ(17,"label",4)(18,"input",1),C.NdJ("ngModelChange",function(_){return r.w2=_}),C.qZA()(),C.TgZ(19,"label",5)(20,"input",3),C.NdJ("ngModelChange",function(_){return r.h2=_}),C.qZA()(),C.TgZ(21,"div",6)(22,"tui-select",7),C.NdJ("ngModelChange",function(_){return r.globalCompositeOperation=_}),C._uU(23," Overlay "),C.YNc(24,yd,1,1,"tui-data-list-wrapper",8),C.qZA(),C.TgZ(25,"tui-input-color",7),C.NdJ("ngModelChange",function(_){return r.c2=_}),C._uU(26," Color "),C.qZA()()(),C.TgZ(27,"fieldset")(28,"tui-input-files",9),C.NdJ("ngModelChange",function(_){return r.onFile(_)}),C._UZ(29,"input",10),C.qZA(),C.TgZ(30,"tui-expand",11)(31,"div",12)(32,"label",13)(33,"input",1),C.NdJ("ngModelChange",function(_){return r.dX=_}),C.qZA()(),C.TgZ(34,"label",14)(35,"input",3),C.NdJ("ngModelChange",function(_){return r.dY=_}),C.qZA()(),C.TgZ(36,"label",15)(37,"input",1),C.NdJ("ngModelChange",function(_){return r.dWidth=_}),C.qZA()(),C.TgZ(38,"label",16)(39,"input",3),C.NdJ("ngModelChange",function(_){return r.dHeight=_}),C.qZA()()()()()(),C.TgZ(40,"canvas",17),C._UZ(41,"canvas-draw-image",18),C.TgZ(42,"canvas-path",19),C._UZ(43,"canvas-rect",20),C.qZA(),C.TgZ(44,"canvas-path",21),C._UZ(45,"canvas-rect",20),C.qZA()(),C.TgZ(46,"h2"),C._uU(47,"Path example"),C.qZA(),C.TgZ(48,"section")(49,"fieldset")(50,"label",22)(51,"input",23),C.NdJ("ngModelChange",function(_){return r.mouth=_}),C.qZA()(),C.TgZ(52,"label",24)(53,"input",25),C.NdJ("ngModelChange",function(_){return r.blur=_}),C.qZA()(),C.TgZ(54,"label",26)(55,"input",25),C.NdJ("ngModelChange",function(_){return r.offset=_}),C.qZA()()(),C.TgZ(56,"fieldset")(57,"tui-input",7),C.NdJ("ngModelChange",function(_){return r.text=_}),C._uU(58," Text "),C.qZA(),C.TgZ(59,"tui-input",7),C.NdJ("ngModelChange",function(_){return r.font=_}),C._uU(60," Font "),C.qZA(),C.TgZ(61,"tui-input-color",7),C.NdJ("ngModelChange",function(_){return r.color=_}),C._uU(62," color "),C.qZA()()(),C.TgZ(63,"canvas",27),C.ALo(64,"transform"),C.TgZ(65,"canvas-path",28),C._UZ(66,"canvas-arc",29),C.ALo(67,"rad"),C.ALo(68,"rad"),C._UZ(69,"canvas-line-to",30),C.qZA(),C._UZ(70,"canvas-text",31),C.qZA()),2&i&&(C.xp6(5),C.Q6J("ngModel",r.x1),C.xp6(2),C.Q6J("ngModel",r.y1),C.xp6(2),C.Q6J("ngModel",r.w1),C.xp6(2),C.Q6J("ngModel",r.h1),C.xp6(3),C.Q6J("ngModel",r.x2),C.xp6(2),C.Q6J("ngModel",r.y2),C.xp6(2),C.Q6J("ngModel",r.w2),C.xp6(2),C.Q6J("ngModel",r.h2),C.xp6(2),C.Q6J("ngModel",r.globalCompositeOperation),C.xp6(3),C.Q6J("ngModel",r.c2),C.xp6(3),C.Q6J("ngModel",r.file),C.xp6(2),C.Q6J("expanded",!!r.file),C.xp6(3),C.Q6J("ngModel",r.dX),C.xp6(2),C.Q6J("ngModel",r.dY),C.xp6(2),C.Q6J("ngModel",r.dWidth),C.xp6(2),C.Q6J("ngModel",r.dHeight),C.xp6(2),C.Q6J("dHeight",r.dHeight)("dWidth",r.dWidth)("dX",r.dX)("dY",r.dY)("image",r.image),C.xp6(2),C.Q6J("height",r.h1)("width",r.w1)("x",r.x1)("y",r.y1),C.xp6(1),C.Q6J("fillStyle",r.c2)("globalCompositeOperation",r.globalCompositeOperation),C.xp6(1),C.Q6J("height",r.h2)("width",r.w2)("x",r.x2)("y",r.y2),C.xp6(6),C.Q6J("ngModel",r.mouth),C.xp6(2),C.Q6J("ngModel",r.blur),C.xp6(2),C.Q6J("ngModel",r.offset),C.xp6(2),C.Q6J("ngModel",r.text),C.xp6(2),C.Q6J("ngModel",r.font),C.xp6(2),C.Q6J("ngModel",r.color),C.xp6(2),C.Q6J("height",300)("transform",C.lcZ(64,55,"scale(2, 2)"))("width",600),C.xp6(2),C.Q6J("shadowBlur",r.blur)("shadowOffsetY",r.offset),C.xp6(1),C.Q6J("endAngle",C.lcZ(67,57,-r.mouth))("radius",30)("startAngle",C.lcZ(68,59,r.mouth))("x",50)("y",75),C.xp6(3),C.Q6J("x",50)("y",75),C.xp6(1),C.Q6J("fillStyle",r.color)("font",r.font)("maxWidth",200)("text",r.text)("x",90)("y",90))},dependencies:[Te.ez,Ne.u5,Ne.Fj,Ne.eT,Ne.JJ,Ne.On,le.tZ,ld.C,ad.L,cd.X,ud.f,dd.l,pd.B,fd.$,hd.f,md.l,gd.T,_d.S,Td.g,Cd,bd.a,Mt,on,zi,ne.U,ne.A,zn.c2,zn.iN,Ye.ij,Ye.SV,ct.Jy,ct.uJ,ct.OI,ni.Qf,ni.K3,ni.wU,Ku,yi.zX,yi.eC,Nt.gX,Le.cn,Le.sz],styles:["[_nghost-%COMP%]{display:block;max-width:800px;margin:0 auto}.row[_ngcontent-%COMP%]{display:flex;min-width:100%;gap:12px}.child[_ngcontent-%COMP%]{flex:1;min-width:100px}.controls[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}input[_ngcontent-%COMP%]{margin:0}fieldset[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;border:none;background:whitesmoke;padding:12px;margin:12px 0;gap:12px;border-radius:1.25rem}canvas[_ngcontent-%COMP%]{display:block;width:300px;height:150px;margin:0 auto 40px;border-radius:6px;box-shadow:0 12px 36px #0003}"],changeDetection:0})),n})()},4589:()=>{},1571:()=>{},4087:(Fn,tt,Q)=>{"use strict";var z=Q(4589);Q.o(z,"TuiPortalService")&&Q.d(tt,{TuiPortalService:function(){return z.TuiPortalService}});var Ne=Q(1571);Q.o(Ne,"TuiPortalService")&&Q.d(tt,{TuiPortalService:function(){return Ne.TuiPortalService}})},9911:(Fn,tt,Q)=>{"use strict";Q.r(tt),Q.d(tt,{CommandManager:()=>K,Editor:()=>Lo,Extension:()=>Mt,InputRule:()=>Ge,Mark:()=>Gn,Node:()=>Ft,NodePos:()=>dn,NodeView:()=>fi,PasteRule:()=>Bn,Tracker:()=>b,callOrReturn:()=>d,combineTransactionSteps:()=>Ke,createChainableState:()=>$t,createDocument:()=>jn,createNodeFromContent:()=>Lt,createStyleTag:()=>No,defaultBlockAt:()=>ln,deleteProps:()=>Ai,elementFromString:()=>Nt,escapeForRegEx:()=>s,extensions:()=>pi,findChildren:()=>Ze,findChildrenInRange:()=>Pi,findDuplicates:()=>ei,findParentNode:()=>gn,findParentNodeClosestToPos:()=>eo,fromString:()=>x,generateHTML:()=>Wn,generateJSON:()=>Eo,generateText:()=>to,getAttributes:()=>Jn,getAttributesFromExtensions:()=>F,getChangedRanges:()=>ut,getDebugJSON:()=>Ri,getExtensionField:()=>k,getHTMLFromFragment:()=>li,getMarkAttributes:()=>si,getMarkRange:()=>rn,getMarkType:()=>pt,getMarksBetween:()=>_n,getNodeAtPosition:()=>Ni,getNodeAttributes:()=>no,getNodeType:()=>V,getRenderedAttributes:()=>te,getSchema:()=>ai,getSchemaByResolvedExtensions:()=>L,getSchemaTypeByName:()=>W,getSchemaTypeNameByName:()=>Un,getSplittedAttributes:()=>An,getText:()=>ci,getTextBetween:()=>zn,getTextContentFromNodes:()=>pe,getTextSerializersFromSchema:()=>ct,injectExtensionAttributesToParseRule:()=>M,inputRulesPlugin:()=>Ci,isActive:()=>In,isAtEndOfNode:()=>yt,isAtStartOfNode:()=>_t,isEmptyObject:()=>m,isExtensionRulesEnabled:()=>q,isFunction:()=>R,isList:()=>Kn,isMacOS:()=>ri,isMarkActive:()=>gt,isNodeActive:()=>Mn,isNodeEmpty:()=>vt,isNodeSelection:()=>Dn,isNumber:()=>Xn,isPlainObject:()=>ti,isRegExp:()=>ge,isString:()=>u,isTextSelection:()=>xn,isiOS:()=>kn,markInputRule:()=>Ho,markPasteRule:()=>a,mergeAttributes:()=>Z,mergeDeep:()=>on,minMax:()=>Vt,nodeInputRule:()=>Fo,nodePasteRule:()=>f,objectIncludes:()=>Et,pasteRulesPlugin:()=>bi,posToDOMRect:()=>cn,removeDuplicates:()=>io,resolveFocusPosition:()=>wi,selectionToInsertionEnd:()=>bt,splitExtensions:()=>P,textInputRule:()=>Bo,textPasteRule:()=>T,textblockTypeInputRule:()=>co,wrappingInputRule:()=>uo});var z=Q(7825),Te=Q(7387),Ne=Q(3861),le=Q(7834),ne=Q(2938);const Ye=(l,o)=>!l.selection.empty&&(o&&o(l.tr.deleteSelection().scrollIntoView()),!0);function Le(l,o){let{$cursor:c}=l.selection;return!c||(o?!o.endOfTextblock("backward",l):c.parentOffset>0)?null:c}const Ae=(l,o,c)=>{let p=Le(l,c);if(!p)return!1;let g=ze(p);if(!g){let v=p.blockRange(),S=v&&(0,ne.k9)(v);return null!=S&&(o&&o(l.tr.lift(v,S).scrollIntoView()),!0)}let y=g.nodeBefore;if(!y.type.spec.isolating&&ee(l,g,o))return!0;if(0==p.parent.content.size&&(Me(y,"end")||z.qv.isSelectable(y))){let v=(0,ne.dR)(l.doc,p.before(),p.after(),le.p2.empty);if(v&&v.slice.size<v.to-v.from){if(o){let S=l.tr.step(v);S.setSelection(Me(y,"end")?z.Y1.findFrom(S.doc.resolve(S.mapping.map(g.pos,-1)),-1):z.qv.create(S.doc,g.pos-y.nodeSize)),o(S.scrollIntoView())}return!0}}return!(!y.isAtom||g.depth!=p.depth-1||(o&&o(l.tr.delete(g.pos-y.nodeSize,g.pos).scrollIntoView()),0))};function Se(l,o,c){let g=o.nodeBefore,y=o.pos-1;for(;!g.isTextblock;y--){if(g.type.spec.isolating)return!1;let H=g.lastChild;if(!H)return!1;g=H}let S=o.nodeAfter,O=o.pos+1;for(;!S.isTextblock;O++){if(S.type.spec.isolating)return!1;let H=S.firstChild;if(!H)return!1;S=H}let D=(0,ne.dR)(l.doc,y,O,le.p2.empty);if(!D||D.from!=y||D instanceof ne.Pu&&D.slice.size>=O-y)return!1;if(c){let H=l.tr.step(D);H.setSelection(z.Bs.create(H.doc,y)),c(H.scrollIntoView())}return!0}function Me(l,o,c=!1){for(let p=l;p;p="start"==o?p.firstChild:p.lastChild){if(p.isTextblock)return!0;if(c&&1!=p.childCount)return!1}return!1}const rt=(l,o,c)=>{let{$head:p,empty:g}=l.selection,y=p;if(!g)return!1;if(p.parent.isTextblock){if(c?!c.endOfTextblock("backward",l):p.parentOffset>0)return!1;y=ze(p)}let v=y&&y.nodeBefore;return!(!v||!z.qv.isSelectable(v)||(o&&o(l.tr.setSelection(z.qv.create(l.doc,y.pos-v.nodeSize)).scrollIntoView()),0))};function ze(l){if(!l.parent.type.spec.isolating)for(let o=l.depth-1;o>=0;o--){if(l.index(o)>0)return l.doc.resolve(l.before(o+1));if(l.node(o).type.spec.isolating)break}return null}function me(l,o){let{$cursor:c}=l.selection;return!c||(o?!o.endOfTextblock("forward",l):c.parentOffset<c.parent.content.size)?null:c}const xe=(l,o,c)=>{let p=me(l,c);if(!p)return!1;let g=ke(p);if(!g)return!1;let y=g.nodeAfter;if(ee(l,g,o))return!0;if(0==p.parent.content.size&&(Me(y,"start")||z.qv.isSelectable(y))){let v=(0,ne.dR)(l.doc,p.before(),p.after(),le.p2.empty);if(v&&v.slice.size<v.to-v.from){if(o){let S=l.tr.step(v);S.setSelection(Me(y,"start")?z.Y1.findFrom(S.doc.resolve(S.mapping.map(g.pos)),1):z.qv.create(S.doc,S.mapping.map(g.pos))),o(S.scrollIntoView())}return!0}}return!(!y.isAtom||g.depth!=p.depth-1||(o&&o(l.tr.delete(g.pos,g.pos+y.nodeSize).scrollIntoView()),0))},Ce=(l,o,c)=>{let{$head:p,empty:g}=l.selection,y=p;if(!g)return!1;if(p.parent.isTextblock){if(c?!c.endOfTextblock("forward",l):p.parentOffset<p.parent.content.size)return!1;y=ke(p)}let v=y&&y.nodeAfter;return!(!v||!z.qv.isSelectable(v)||(o&&o(l.tr.setSelection(z.qv.create(l.doc,y.pos)).scrollIntoView()),0))};function ke(l){if(!l.parent.type.spec.isolating)for(let o=l.depth-1;o>=0;o--){let c=l.node(o);if(l.index(o)+1<c.childCount)return l.doc.resolve(l.after(o+1));if(c.type.spec.isolating)break}return null}const Ee=(l,o)=>{let{$head:c,$anchor:p}=l.selection;return!(!c.parent.type.spec.code||!c.sameParent(p)||(o&&o(l.tr.insertText("\n").scrollIntoView()),0))};function $e(l){for(let o=0;o<l.edgeCount;o++){let{type:c}=l.edge(o);if(c.isTextblock&&!c.hasRequiredAttrs())return c}return null}const Fe=(l,o)=>{let{$head:c,$anchor:p}=l.selection;if(!c.parent.type.spec.code||!c.sameParent(p))return!1;let g=c.node(-1),y=c.indexAfter(-1),v=$e(g.contentMatchAt(y));if(!v||!g.canReplaceWith(y,y,v))return!1;if(o){let S=c.after(),O=l.tr.replaceWith(S,S,v.createAndFill());O.setSelection(z.Y1.near(O.doc.resolve(S),1)),o(O.scrollIntoView())}return!0},st=(l,o)=>{let c=l.selection,{$from:p,$to:g}=c;if(c instanceof z.C1||p.parent.inlineContent||g.parent.inlineContent)return!1;let y=$e(g.parent.contentMatchAt(g.indexAfter()));if(!y||!y.isTextblock)return!1;if(o){let v=(!p.parentOffset&&g.index()<g.parent.childCount?p:g).pos,S=l.tr.insert(v,y.createAndFill());S.setSelection(z.Bs.create(S.doc,v+1)),o(S.scrollIntoView())}return!0},qe=(l,o)=>{let{$cursor:c}=l.selection;if(!c||c.parent.content.size)return!1;if(c.depth>1&&c.after()!=c.end(-1)){let y=c.before();if((0,ne.Ax)(l.doc,y))return o&&o(l.tr.split(y).scrollIntoView()),!0}let p=c.blockRange(),g=p&&(0,ne.k9)(p);return null!=g&&(o&&o(l.tr.lift(p,g).scrollIntoView()),!0)},We=function at(l){return(o,c)=>{let{$from:p,$to:g}=o.selection;if(o.selection instanceof z.qv&&o.selection.node.isBlock)return!(!p.parentOffset||!(0,ne.Ax)(o.doc,p.pos)||(c&&c(o.tr.split(p.pos).scrollIntoView()),0));if(!p.parent.isBlock)return!1;if(c){let y=g.parentOffset==g.parent.content.size,v=o.tr;(o.selection instanceof z.Bs||o.selection instanceof z.C1)&&v.deleteSelection();let S=0==p.depth?null:$e(p.node(-1).contentMatchAt(p.indexAfter(-1))),O=l&&l(g.parent,y),D=O?[O]:y&&S?[{type:S}]:void 0,H=(0,ne.Ax)(v.doc,v.mapping.map(p.pos),1,D);if(!D&&!H&&(0,ne.Ax)(v.doc,v.mapping.map(p.pos),1,S?[{type:S}]:void 0)&&(S&&(D=[{type:S}]),H=!0),H&&(v.split(v.mapping.map(p.pos),1,D),!y&&!p.parentOffset&&p.parent.type!=S)){let $=v.mapping.map(p.before()),J=v.doc.resolve($);S&&p.node(-1).canReplaceWith(J.index(),J.index()+1,S)&&v.setNodeMarkup(v.mapping.map(p.before()),S)}c(v.scrollIntoView())}return!0}}();function ee(l,o,c){let y,v,p=o.nodeBefore,g=o.nodeAfter;if(p.type.spec.isolating||g.type.spec.isolating)return!1;if(function G(l,o,c){let p=o.nodeBefore,g=o.nodeAfter,y=o.index();return!(!(p&&g&&p.type.compatibleContent(g.type))||(!p.content.size&&o.parent.canReplace(y-1,y)?(c&&c(l.tr.delete(o.pos-p.nodeSize,o.pos).scrollIntoView()),0):!o.parent.canReplace(y,y+1)||!g.isTextblock&&!(0,ne.Mn)(l.doc,o.pos)||(c&&c(l.tr.clearIncompatible(o.pos,p.type,p.contentMatchAt(p.childCount)).join(o.pos).scrollIntoView()),0)))}(l,o,c))return!0;let S=o.parent.canReplace(o.index(),o.index()+1);if(S&&(y=(v=p.contentMatchAt(p.childCount)).findWrapping(g.type))&&v.matchType(y[0]||g.type).validEnd){if(c){let $=o.pos+g.nodeSize,J=le.HY.empty;for(let ue=y.length-1;ue>=0;ue--)J=le.HY.from(y[ue].create(null,J));J=le.HY.from(p.copy(J));let X=l.tr.step(new ne.FC(o.pos-1,$,o.pos,$,new le.p2(J,1,0),y.length,!0)),re=$+2*y.length;(0,ne.Mn)(X.doc,re)&&X.join(re),c(X.scrollIntoView())}return!0}let O=z.Y1.findFrom(o,1),D=O&&O.$from.blockRange(O.$to),H=D&&(0,ne.k9)(D);if(null!=H&&H>=o.depth)return c&&c(l.tr.lift(D,H).scrollIntoView()),!0;if(S&&Me(g,"start",!0)&&Me(p,"end")){let $=p,J=[];for(;J.push($),!$.isTextblock;)$=$.lastChild;let X=g,re=1;for(;!X.isTextblock;X=X.firstChild)re++;if($.canReplace($.childCount,$.childCount,X.content)){if(c){let ue=le.HY.empty;for(let fe=J.length-1;fe>=0;fe--)ue=le.HY.from(J[fe].copy(ue));c(l.tr.step(new ne.FC(o.pos-J.length,o.pos+g.nodeSize,o.pos+re,o.pos+g.nodeSize-re,new le.p2(ue,J.length,0),0,!0)).scrollIntoView())}return!0}}return!1}function se(l){return function(o,c){let p=o.selection,g=l<0?p.$from:p.$to,y=g.depth;for(;g.node(y).isInline;){if(!y)return!1;y--}return!!g.node(y).isTextblock&&(c&&c(o.tr.setSelection(z.Bs.create(o.doc,l<0?g.start(y):g.end(y)))),!0)}}const he=se(-1),ve=se(1);function Pe(l,o=null){return function(c,p){let g=!1;for(let y=0;y<c.selection.ranges.length&&!g;y++){let{$from:{pos:v},$to:{pos:S}}=c.selection.ranges[y];c.doc.nodesBetween(v,S,(O,D)=>{if(g)return!1;if(O.isTextblock&&!O.hasMarkup(l,o))if(O.type==l)g=!0;else{let H=c.doc.resolve(D),$=H.index();g=H.parent.canReplaceWith($,$+1,l)}})}if(!g)return!1;if(p){let y=c.tr;for(let v=0;v<c.selection.ranges.length;v++){let{$from:{pos:S},$to:{pos:O}}=c.selection.ranges[v];y.setBlockType(S,O,l,o)}p(y.scrollIntoView())}return!0}}function Wt(...l){return function(o,c,p){for(let g=0;g<l.length;g++)if(l[g](o,c,p))return!0;return!1}}let zt=Wt(Ye,Ae,rt),At=Wt(Ye,xe,Ce);const Ct={Enter:Wt(Ee,st,qe,We),"Mod-Enter":Fe,Backspace:zt,"Mod-Backspace":zt,"Shift-Backspace":zt,Delete:At,"Mod-Delete":At,"Mod-a":(l,o)=>(o&&o(l.tr.setSelection(new z.C1(l.doc))),!0)},Jt={"Ctrl-h":Ct.Backspace,"Alt-Backspace":Ct["Mod-Backspace"],"Ctrl-d":Ct.Delete,"Ctrl-Alt-Backspace":Ct["Mod-Delete"],"Alt-Delete":Ct["Mod-Delete"],"Alt-d":Ct["Mod-Delete"],"Ctrl-a":he,"Ctrl-e":ve};for(let l in Ct)Jt[l]=Ct[l];function $t(l){const{state:o,transaction:c}=l;let{selection:p}=c,{doc:g}=c,{storedMarks:y}=c;return{...o,apply:o.apply.bind(o),applyTransaction:o.applyTransaction.bind(o),plugins:o.plugins,schema:o.schema,reconfigure:o.reconfigure.bind(o),toJSON:o.toJSON.bind(o),get storedMarks(){return y},get selection(){return p},get doc(){return g},get tr(){return p=c.selection,g=c.doc,y=c.storedMarks,c}}}typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform();class K{constructor(o){this.editor=o.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=o.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:o,editor:c,state:p}=this,{view:g}=c,{tr:y}=p,v=this.buildProps(y);return Object.fromEntries(Object.entries(o).map(([S,O])=>[S,(...H)=>{const $=O(...H)(v);return!y.getMeta("preventDispatch")&&!this.hasCustomState&&g.dispatch(y),$}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(o,c=!0){const{rawCommands:p,editor:g,state:y}=this,{view:v}=g,S=[],O=!!o,D=o||y.tr,$={...Object.fromEntries(Object.entries(p).map(([J,X])=>[J,(...ue)=>{const ce=this.buildProps(D,c),fe=X(...ue)(ce);return S.push(fe),$}])),run:()=>(!O&&c&&!D.getMeta("preventDispatch")&&!this.hasCustomState&&v.dispatch(D),S.every(J=>!0===J))};return $}createCan(o){const{rawCommands:c,state:p}=this,y=o||p.tr,v=this.buildProps(y,!1);return{...Object.fromEntries(Object.entries(c).map(([O,D])=>[O,(...H)=>D(...H)({...v,dispatch:void 0})])),chain:()=>this.createChain(y,!1)}}buildProps(o,c=!0){const{rawCommands:p,editor:g,state:y}=this,{view:v}=g,S={tr:o,editor:g,view:v,state:$t({state:y,transaction:o}),dispatch:c?()=>{}:void 0,chain:()=>this.createChain(o,c),can:()=>this.createCan(o),get commands(){return Object.fromEntries(Object.entries(p).map(([O,D])=>[O,(...H)=>D(...H)(S)]))}};return S}}class w{constructor(){this.callbacks={}}on(o,c){return this.callbacks[o]||(this.callbacks[o]=[]),this.callbacks[o].push(c),this}emit(o,...c){const p=this.callbacks[o];return p&&p.forEach(g=>g.apply(this,c)),this}off(o,c){const p=this.callbacks[o];return p&&(c?this.callbacks[o]=p.filter(g=>g!==c):delete this.callbacks[o]),this}removeAllListeners(){this.callbacks={}}}function k(l,o,c){return void 0===l.config[o]&&l.parent?k(l.parent,o,c):"function"==typeof l.config[o]?l.config[o].bind({...c,parent:l.parent?k(l.parent,o,c):null}):l.config[o]}function P(l){return{baseExtensions:l.filter(g=>"extension"===g.type),nodeExtensions:l.filter(g=>"node"===g.type),markExtensions:l.filter(g=>"mark"===g.type)}}function F(l){const o=[],{nodeExtensions:c,markExtensions:p}=P(l),g=[...c,...p],y={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return l.forEach(v=>{const O=k(v,"addGlobalAttributes",{name:v.name,options:v.options,storage:v.storage});O&&O().forEach(H=>{H.types.forEach($=>{Object.entries(H.attributes).forEach(([J,X])=>{o.push({type:$,name:J,attribute:{...y,...X}})})})})}),g.forEach(v=>{const O=k(v,"addAttributes",{name:v.name,options:v.options,storage:v.storage});if(!O)return;const D=O();Object.entries(D).forEach(([H,$])=>{const J={...y,...$};"function"==typeof(null==J?void 0:J.default)&&(J.default=J.default()),null!=J&&J.isRequired&&void 0===(null==J?void 0:J.default)&&delete J.default,o.push({type:v.name,name:H,attribute:J})})}),o}function V(l,o){if("string"==typeof l){if(!o.nodes[l])throw Error(`There is no node type named '${l}'. Maybe you forgot to add the extension?`);return o.nodes[l]}return l}function Z(...l){return l.filter(o=>!!o).reduce((o,c)=>{const p={...o};return Object.entries(c).forEach(([g,y])=>{if(p[g])if("class"===g){const S=y?y.split(" "):[],O=p[g]?p[g].split(" "):[],D=S.filter(H=>!O.includes(H));p[g]=[...O,...D].join(" ")}else p[g]="style"===g?[p[g],y].join("; "):y;else p[g]=y}),p},{})}function te(l,o){return o.filter(c=>c.attribute.rendered).map(c=>c.attribute.renderHTML?c.attribute.renderHTML(l.attrs)||{}:{[c.name]:l.attrs[c.name]}).reduce((c,p)=>Z(c,p),{})}function R(l){return"function"==typeof l}function d(l,o=void 0,...c){return R(l)?o?l.bind(o)(...c):l(...c):l}function m(l={}){return 0===Object.keys(l).length&&l.constructor===Object}function x(l){return"string"!=typeof l?l:l.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(l):"true"===l||"false"!==l&&l}function M(l,o){return l.style?l:{...l,getAttrs:c=>{const p=l.getAttrs?l.getAttrs(c):l.attrs;if(!1===p)return!1;const g=o.reduce((y,v)=>{const S=v.attribute.parseHTML?v.attribute.parseHTML(c):x(c.getAttribute(v.name));return null==S?y:{...y,[v.name]:S}},{});return{...p,...g}}}}function A(l){return Object.fromEntries(Object.entries(l).filter(([o,c])=>("attrs"!==o||!m(c))&&null!=c))}function L(l,o){var c;const p=F(l),{nodeExtensions:g,markExtensions:y}=P(l),v=null===(c=g.find(D=>k(D,"topNode")))||void 0===c?void 0:c.name,S=Object.fromEntries(g.map(D=>{const H=p.filter(fe=>fe.type===D.name),$={name:D.name,options:D.options,storage:D.storage,editor:o},X=A({...l.reduce((fe,Be)=>{const _e=k(Be,"extendNodeSchema",$);return{...fe,..._e?_e(D):{}}},{}),content:d(k(D,"content",$)),marks:d(k(D,"marks",$)),group:d(k(D,"group",$)),inline:d(k(D,"inline",$)),atom:d(k(D,"atom",$)),selectable:d(k(D,"selectable",$)),draggable:d(k(D,"draggable",$)),code:d(k(D,"code",$)),defining:d(k(D,"defining",$)),isolating:d(k(D,"isolating",$)),attrs:Object.fromEntries(H.map(fe=>{var Be;return[fe.name,{default:null===(Be=null==fe?void 0:fe.attribute)||void 0===Be?void 0:Be.default}]}))}),re=d(k(D,"parseHTML",$));re&&(X.parseDOM=re.map(fe=>M(fe,H)));const ue=k(D,"renderHTML",$);ue&&(X.toDOM=fe=>ue({node:fe,HTMLAttributes:te(fe,H)}));const ce=k(D,"renderText",$);return ce&&(X.toText=ce),[D.name,X]})),O=Object.fromEntries(y.map(D=>{const H=p.filter(ce=>ce.type===D.name),$={name:D.name,options:D.options,storage:D.storage,editor:o},X=A({...l.reduce((ce,fe)=>{const Be=k(fe,"extendMarkSchema",$);return{...ce,...Be?Be(D):{}}},{}),inclusive:d(k(D,"inclusive",$)),excludes:d(k(D,"excludes",$)),group:d(k(D,"group",$)),spanning:d(k(D,"spanning",$)),code:d(k(D,"code",$)),attrs:Object.fromEntries(H.map(ce=>{var fe;return[ce.name,{default:null===(fe=null==ce?void 0:ce.attribute)||void 0===fe?void 0:fe.default}]}))}),re=d(k(D,"parseHTML",$));re&&(X.parseDOM=re.map(ce=>M(ce,H)));const ue=k(D,"renderHTML",$);return ue&&(X.toDOM=ce=>ue({mark:ce,HTMLAttributes:te(ce,H)})),[D.name,X]}));return new le.V_({topNode:v,nodes:S,marks:O})}function W(l,o){return o.nodes[l]||o.marks[l]||null}function q(l,o){return Array.isArray(o)?o.some(c=>("string"==typeof c?c:c.name)===l.name):o}const pe=(l,o=500)=>{let c="";const p=l.parentOffset;return l.parent.nodesBetween(Math.max(0,p-o),p,(g,y,v,S)=>{var O,D;const H=(null===(D=(O=g.type.spec).toText)||void 0===D?void 0:D.call(O,{node:g,pos:y,parent:v,index:S}))||g.textContent||"%leaf%";c+=H.slice(0,Math.max(0,p-y))}),c};function ge(l){return"[object RegExp]"===Object.prototype.toString.call(l)}class Ge{constructor(o){this.find=o.find,this.handler=o.handler}}const mn=(l,o)=>{if(ge(o))return o.exec(l);const c=o(l);if(!c)return null;const p=[c.text];return p.index=c.index,p.input=l,p.data=c.data,c.replaceWith&&(c.text.includes(c.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),p.push(c.replaceWith)),p};function yn(l){var o;const{editor:c,from:p,to:g,text:y,rules:v,plugin:S}=l,{view:O}=c;if(O.composing)return!1;const D=O.state.doc.resolve(p);if(D.parent.type.spec.code||null!==(o=D.nodeBefore||D.nodeAfter)&&void 0!==o&&o.marks.find(J=>J.type.spec.code))return!1;let H=!1;const $=pe(D)+y;return v.forEach(J=>{if(H)return;const X=mn($,J.find);if(!X)return;const re=O.state.tr,ue=$t({state:O.state,transaction:re}),ce={from:p-(X[0].length-y.length),to:g},{commands:fe,chain:Be,can:_e}=new K({editor:c,state:ue});null===J.handler({state:ue,range:ce,match:X,commands:fe,chain:Be,can:_e})||!re.steps.length||(re.setMeta(S,{transform:re,from:p,to:g,text:y}),O.dispatch(re),H=!0)}),H}function Ci(l){const{editor:o,rules:c}=l,p=new z.Sy({state:{init:()=>null,apply:(g,y)=>g.getMeta(p)||(g.selectionSet||g.docChanged?null:y)},props:{handleTextInput:(g,y,v,S)=>yn({editor:o,from:y,to:v,text:S,rules:c,plugin:p}),handleDOMEvents:{compositionend:g=>(setTimeout(()=>{const{$cursor:y}=g.state.selection;y&&yn({editor:o,from:y.pos,to:y.pos,text:"",rules:c,plugin:p})}),!1)},handleKeyDown(g,y){if("Enter"!==y.key)return!1;const{$cursor:v}=g.state.selection;return!!v&&yn({editor:o,from:v.pos,to:v.pos,text:"\n",rules:c,plugin:p})}},isInputRules:!0});return p}function Xn(l){return"number"==typeof l}class Bn{constructor(o){this.find=o.find,this.handler=o.handler}}const _o=(l,o,c)=>{if(ge(o))return[...l.matchAll(o)];const p=o(l,c);return p?p.map(g=>{const y=[g.text];return y.index=g.index,y.input=l,y.data=g.data,g.replaceWith&&(g.text.includes(g.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),y.push(g.replaceWith)),y}):[]};function bi(l){const{editor:o,rules:c}=l;let p=null,g=!1,y=!1,v=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,S=typeof DragEvent<"u"?new DragEvent("drop"):null;return c.map(D=>new z.Sy({view(H){const $=J=>{var X;p=null!==(X=H.dom.parentElement)&&void 0!==X&&X.contains(J.target)?H.dom.parentElement:null};return window.addEventListener("dragstart",$),{destroy(){window.removeEventListener("dragstart",$)}}},props:{handleDOMEvents:{drop:(H,$)=>(y=p===H.dom.parentElement,S=$,!1),paste:(H,$)=>{var J;const X=null===(J=$.clipboardData)||void 0===J?void 0:J.getData("text/html");return v=$,g=!(null==X||!X.includes("data-pm-slice")),!1}}},appendTransaction:(H,$,J)=>{const X=H[0],re="paste"===X.getMeta("uiEvent")&&!g,ue="drop"===X.getMeta("uiEvent")&&!y;if(!re&&!ue)return;const ce=$.doc.content.findDiffStart(J.doc.content),fe=$.doc.content.findDiffEnd(J.doc.content);if(!Xn(ce)||!fe||ce===fe.b)return;const Be=J.tr,_e=$t({state:J,transaction:Be});return function To(l){const{editor:o,state:c,from:p,to:g,rule:y,pasteEvent:v,dropEvent:S}=l,{commands:O,chain:D,can:H}=new K({editor:o,state:c}),$=[];return c.doc.nodesBetween(p,g,(X,re)=>{if(!X.isTextblock||X.type.spec.code)return;const ue=Math.max(p,re),ce=Math.min(g,re+X.content.size),fe=X.textBetween(ue-re,ce-re,void 0,"\ufffc");_o(fe,y.find,v).forEach(_e=>{if(void 0===_e.index)return;const Je=ue+_e.index+1,nt=Je+_e[0].length,Tt={from:c.tr.mapping.map(Je),to:c.tr.mapping.map(nt)},Bt=y.handler({state:c,range:Tt,match:_e,commands:O,chain:D,can:H,pasteEvent:v,dropEvent:S});$.push(Bt)})}),$.every(X=>null!==X)}({editor:o,state:_e,from:Math.max(ce-1,0),to:fe.b-1,rule:D,pasteEvent:v,dropEvent:S})&&Be.steps.length?(S=typeof DragEvent<"u"?new DragEvent("drop"):null,v=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,Be):void 0}}))}function ei(l){const o=l.filter((c,p)=>l.indexOf(c)!==p);return[...new Set(o)]}class vn{constructor(o,c){this.splittableMarks=[],this.editor=c,this.extensions=vn.resolve(o),this.schema=L(this.extensions,c),this.extensions.forEach(p=>{var g;this.editor.extensionStorage[p.name]=p.storage;const y={name:p.name,options:p.options,storage:p.storage,editor:this.editor,type:W(p.name,this.schema)};"mark"===p.type&&(null===(g=d(k(p,"keepOnSplit",y)))||void 0===g||g)&&this.splittableMarks.push(p.name);const v=k(p,"onBeforeCreate",y);v&&this.editor.on("beforeCreate",v);const S=k(p,"onCreate",y);S&&this.editor.on("create",S);const O=k(p,"onUpdate",y);O&&this.editor.on("update",O);const D=k(p,"onSelectionUpdate",y);D&&this.editor.on("selectionUpdate",D);const H=k(p,"onTransaction",y);H&&this.editor.on("transaction",H);const $=k(p,"onFocus",y);$&&this.editor.on("focus",$);const J=k(p,"onBlur",y);J&&this.editor.on("blur",J);const X=k(p,"onDestroy",y);X&&this.editor.on("destroy",X)})}static resolve(o){const c=vn.sort(vn.flatten(o)),p=ei(c.map(g=>g.name));return p.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${p.map(g=>`'${g}'`).join(", ")}]. This can lead to issues.`),c}static flatten(o){return o.map(c=>{const g=k(c,"addExtensions",{name:c.name,options:c.options,storage:c.storage});return g?[c,...this.flatten(g())]:c}).flat(10)}static sort(o){return o.sort((p,g)=>{const y=k(p,"priority")||100,v=k(g,"priority")||100;return y>v?-1:y<v?1:0})}get commands(){return this.extensions.reduce((o,c)=>{const g=k(c,"addCommands",{name:c.name,options:c.options,storage:c.storage,editor:this.editor,type:W(c.name,this.schema)});return g?{...o,...g()}:o},{})}get plugins(){const{editor:o}=this,c=vn.sort([...this.extensions].reverse()),p=[],g=[],y=c.map(v=>{const S={name:v.name,options:v.options,storage:v.storage,editor:o,type:W(v.name,this.schema)},O=[],D=k(v,"addKeyboardShortcuts",S);let H={};if("mark"===v.type&&v.config.exitable&&(H.ArrowRight=()=>Gn.handleExit({editor:o,mark:v})),D){const ue=Object.fromEntries(Object.entries(D()).map(([ce,fe])=>[ce,()=>fe({editor:o})]));H={...H,...ue}}const $=(0,Ne.h)(H);O.push($);const J=k(v,"addInputRules",S);q(v,o.options.enableInputRules)&&J&&p.push(...J());const X=k(v,"addPasteRules",S);q(v,o.options.enablePasteRules)&&X&&g.push(...X());const re=k(v,"addProseMirrorPlugins",S);if(re){const ue=re();O.push(...ue)}return O}).flat();return[Ci({editor:o,rules:p}),...bi({editor:o,rules:g}),...y]}get attributes(){return F(this.extensions)}get nodeViews(){const{editor:o}=this,{nodeExtensions:c}=P(this.extensions);return Object.fromEntries(c.filter(p=>!!k(p,"addNodeView")).map(p=>{const g=this.attributes.filter(O=>O.type===p.name),y={name:p.name,options:p.options,storage:p.storage,editor:o,type:V(p.name,this.schema)},v=k(p,"addNodeView",y);return v?[p.name,(O,D,H,$)=>{const J=te(O,g);return v()({editor:o,node:O,getPos:H,decorations:$,HTMLAttributes:J,extension:p})}]:[]}))}}function ti(l){return"Object"===function zi(l){return Object.prototype.toString.call(l).slice(8,-1)}(l)&&l.constructor===Object&&Object.getPrototypeOf(l)===Object.prototype}function on(l,o){const c={...l};return ti(l)&&ti(o)&&Object.keys(o).forEach(p=>{ti(o[p])?p in l?c[p]=on(l[p],o[p]):Object.assign(c,{[p]:o[p]}):Object.assign(c,{[p]:o[p]})}),c}class Mt{constructor(o={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...o},this.name=this.config.name,o.defaultOptions&&Object.keys(o.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=d(k(this,"addOptions",{name:this.name}))),this.storage=d(k(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(o={}){return new Mt(o)}configure(o={}){const c=this.extend();return c.options=on(this.options,o),c.storage=d(k(c,"addStorage",{name:c.name,options:c.options})),c}extend(o={}){const c=new Mt({...this.config,...o});return c.parent=this,this.child=c,c.name=o.name?o.name:c.parent.name,o.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${c.name}".`),c.options=d(k(c,"addOptions",{name:c.name})),c.storage=d(k(c,"addStorage",{name:c.name,options:c.options})),c}}function zn(l,o,c){const{from:p,to:g}=o,{blockSeparator:y="\n\n",textSerializers:v={}}=c||{};let S="",O=!0;return l.nodesBetween(p,g,(D,H,$,J)=>{var X;const re=null==v?void 0:v[D.type.name];re?(D.isBlock&&!O&&(S+=y,O=!0),$&&(S+=re({node:D,pos:H,parent:$,index:J,range:o}))):D.isText?(S+=null===(X=null==D?void 0:D.text)||void 0===X?void 0:X.slice(Math.max(p,H)-H,g-H),O=!1):D.isBlock&&!O&&(S+=y,O=!0)}),S}function ct(l){return Object.fromEntries(Object.entries(l.nodes).filter(([,o])=>o.spec.toText).map(([o,c])=>[o,c.spec.toText]))}const ni=Mt.create({name:"clipboardTextSerializer",addProseMirrorPlugins(){return[new z.Sy({key:new z.H$("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:l}=this,{state:o,schema:c}=l,{doc:p,selection:g}=o,{ranges:y}=g;return zn(p,{from:Math.min(...y.map(H=>H.$from.pos)),to:Math.max(...y.map(H=>H.$to.pos))},{textSerializers:ct(c)})}}})]}});function Et(l,o,c={strict:!0}){const p=Object.keys(o);return!p.length||p.every(g=>c.strict?o[g]===l[g]:ge(o[g])?o[g].test(l[g]):o[g]===l[g])}function ki(l,o,c={}){return l.find(p=>p.type===o&&Et(p.attrs,c))}function oi(l,o,c={}){return!!ki(l,o,c)}function rn(l,o,c={}){if(!l||!o)return;let p=l.parent.childAfter(l.parentOffset);if(l.parentOffset===p.offset&&0!==p.offset&&(p=l.parent.childBefore(l.parentOffset)),!p.node)return;const g=ki([...p.node.marks],o,c);if(!g)return;let y=p.index,v=l.start()+p.offset,S=y+1,O=v+p.node.nodeSize;for(ki([...p.node.marks],o,c);y>0&&g.isInSet(l.parent.child(y-1).marks);)y-=1,v-=l.parent.child(y).nodeSize;for(;S<l.parent.childCount&&oi([...l.parent.child(S).marks],o,c);)O+=l.parent.child(S).nodeSize,S+=1;return{from:v,to:O}}function pt(l,o){if("string"==typeof l){if(!o.marks[l])throw Error(`There is no mark type named '${l}'. Maybe you forgot to add the extension?`);return o.marks[l]}return l}function xn(l){return l instanceof z.Bs}function Vt(l=0,o=0,c=0){return Math.min(Math.max(l,o),c)}function wi(l,o=null){if(!o)return null;const c=z.Y1.atStart(l),p=z.Y1.atEnd(l);if("start"===o||!0===o)return c;if("end"===o)return p;const g=c.from,y=p.to;return"all"===o?z.Bs.create(l,Vt(0,g,y),Vt(l.content.size,g,y)):z.Bs.create(l,Vt(o,g,y),Vt(o,g,y))}function kn(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}const Si=l=>{const o=l.childNodes;for(let c=o.length-1;c>=0;c-=1){const p=o[c];3===p.nodeType&&p.nodeValue&&/^(\n\s\s|\n)$/.test(p.nodeValue)?l.removeChild(p):1===p.nodeType&&Si(p)}return l};function Nt(l){const o=`<body>${l}</body>`,c=(new window.DOMParser).parseFromString(o,"text/html").body;return Si(c)}function Lt(l,o,c){if(c={slice:!0,parseOptions:{},...c},"object"==typeof l&&null!==l)try{return Array.isArray(l)&&l.length>0?le.HY.fromArray(l.map(p=>o.nodeFromJSON(p))):o.nodeFromJSON(l)}catch(p){return console.warn("[tiptap warn]: Invalid content.","Passed value:",l,"Error:",p),Lt("",o,c)}if("string"==typeof l){const p=le.aw.fromSchema(o);return c.slice?p.parseSlice(Nt(l),c.parseOptions).content:p.parse(Nt(l),c.parseOptions)}return Lt("",o,c)}function bt(l,o,c){const p=l.steps.length-1;if(p<o)return;const g=l.steps[p];if(!(g instanceof ne.Pu||g instanceof ne.FC))return;let v=0;l.mapping.maps[p].forEach((S,O,D,H)=>{0===v&&(v=H)}),l.setSelection(z.Y1.near(l.doc.resolve(v),c))}function ri(){return typeof navigator<"u"&&/Mac/.test(navigator.platform)}function Mn(l,o,c={}){const{from:p,to:g,empty:y}=l.selection,v=o?V(o,l.schema):null,S=[];l.doc.nodesBetween(p,g,($,J)=>{if($.isText)return;const X=Math.max(p,J),re=Math.min(g,J+$.nodeSize);S.push({node:$,from:X,to:re})});const O=g-p,D=S.filter($=>!v||v.name===$.node.type.name).filter($=>Et($.node.attrs,c,{strict:!1}));return y?!!D.length:D.reduce(($,J)=>$+J.to-J.from,0)>=O}function Un(l,o){return o.nodes[l]?"node":o.marks[l]?"mark":null}function Ai(l,o){const c="string"==typeof o?[o]:o;return Object.keys(l).reduce((p,g)=>(c.includes(g)||(p[g]=l[g]),p),{})}function jn(l,o,c={}){return Lt(l,o,{slice:!1,parseOptions:c})}function si(l,o){const c=pt(o,l.schema),{from:p,to:g,empty:y}=l.selection,v=[];y?(l.storedMarks&&v.push(...l.storedMarks),v.push(...l.selection.$head.marks())):l.doc.nodesBetween(p,g,O=>{v.push(...O.marks)});const S=v.find(O=>O.type.name===c.name);return S?{...S.attrs}:{}}function Ke(l,o){const c=new ne.wx(l);return o.forEach(p=>{p.steps.forEach(g=>{c.step(g)})}),c}function ln(l){for(let o=0;o<l.edgeCount;o+=1){const{type:c}=l.edge(o);if(c.isTextblock&&!c.hasRequiredAttrs())return c}return null}function Ze(l,o){const c=[];return l.descendants((p,g)=>{o(p)&&c.push({node:p,pos:g})}),c}function Pi(l,o,c){const p=[];return l.nodesBetween(o.from,o.to,(g,y)=>{c(g)&&p.push({node:g,pos:y})}),p}function eo(l,o){for(let c=l.depth;c>0;c-=1){const p=l.node(c);if(o(p))return{pos:c>0?l.before(c):0,start:l.start(c),depth:c,node:p}}}function gn(l){return o=>eo(o.$from,l)}function li(l,o){const c=le.PW.fromSchema(o).serializeFragment(l),g=document.implementation.createHTMLDocument().createElement("div");return g.appendChild(c),g.innerHTML}function ai(l,o){return L(vn.resolve(l),o)}function Wn(l,o){const c=ai(o);return li(le.NB.fromJSON(c,l).content,c)}function Eo(l,o){const c=ai(o),p=Nt(l);return le.aw.fromSchema(c).parse(p).toJSON()}function ci(l,o){return zn(l,{from:0,to:l.content.size},o)}function to(l,o,c){const{blockSeparator:p="\n\n",textSerializers:g={}}=c||{},y=ai(o);return ci(le.NB.fromJSON(y,l),{blockSeparator:p,textSerializers:{...ct(y),...g}})}function no(l,o){const c=V(o,l.schema),{from:p,to:g}=l.selection,y=[];l.doc.nodesBetween(p,g,S=>{y.push(S)});const v=y.reverse().find(S=>S.type.name===c.name);return v?{...v.attrs}:{}}function Jn(l,o){const c=Un("string"==typeof o?o:o.name,l.schema);return"node"===c?no(l,o):"mark"===c?si(l,o):{}}function io(l,o=JSON.stringify){const c={};return l.filter(p=>{const g=o(p);return!Object.prototype.hasOwnProperty.call(c,g)&&(c[g]=!0)})}function ut(l){const{mapping:o,steps:c}=l,p=[];return o.maps.forEach((g,y)=>{const v=[];if(g.ranges.length)g.forEach((S,O)=>{v.push({from:S,to:O})});else{const{from:S,to:O}=c[y];if(void 0===S||void 0===O)return;v.push({from:S,to:O})}v.forEach(({from:S,to:O})=>{const D=o.slice(y).map(S,-1),H=o.slice(y).map(O),$=o.invert().map(D,-1),J=o.invert().map(H);p.push({oldRange:{from:$,to:J},newRange:{from:D,to:H}})})}),function an(l){const o=io(l);return 1===o.length?o:o.filter((c,p)=>!o.filter((y,v)=>v!==p).some(y=>c.oldRange.from>=y.oldRange.from&&c.oldRange.to<=y.oldRange.to&&c.newRange.from>=y.newRange.from&&c.newRange.to<=y.newRange.to))}(p)}function Ri(l,o=0){const p=l.type===l.type.schema.topNodeType?0:1,g=o,y=g+l.nodeSize,v=l.marks.map(D=>{const H={type:D.type.name};return Object.keys(D.attrs).length&&(H.attrs={...D.attrs}),H}),S={...l.attrs},O={type:l.type.name,from:g,to:y};return Object.keys(S).length&&(O.attrs=S),v.length&&(O.marks=v),l.content.childCount&&(O.content=[],l.forEach((D,H)=>{var $;null===($=O.content)||void 0===$||$.push(Ri(D,o+H+p))})),l.text&&(O.text=l.text),O}function _n(l,o,c){const p=[];return l===o?c.resolve(l).marks().forEach(g=>{const v=rn(c.resolve(l-1),g.type);v&&p.push({mark:g,...v})}):c.nodesBetween(l,o,(g,y)=>{!g||void 0===(null==g?void 0:g.nodeSize)||p.push(...g.marks.map(v=>({from:y,to:y+g.nodeSize,mark:v})))}),p}const Ni=(l,o,c,p=20)=>{const g=l.doc.resolve(c);let y=p,v=null;for(;y>0&&null===v;){const S=g.node(y);(null==S?void 0:S.type.name)===o?v=S:y-=1}return[v,y]};function An(l,o,c){return Object.fromEntries(Object.entries(c).filter(([p])=>{const g=l.find(y=>y.type===o&&y.name===p);return!!g&&g.attribute.keepOnSplit}))}function gt(l,o,c={}){const{empty:p,ranges:g}=l.selection,y=o?pt(o,l.schema):null;if(p)return!!(l.storedMarks||l.selection.$from.marks()).filter($=>!y||y.name===$.type.name).find($=>Et($.attrs,c,{strict:!1}));let v=0;const S=[];if(g.forEach(({$from:$,$to:J})=>{const X=$.pos,re=J.pos;l.doc.nodesBetween(X,re,(ue,ce)=>{if(!ue.isText&&!ue.marks.length)return;const fe=Math.max(X,ce),Be=Math.min(re,ce+ue.nodeSize);v+=Be-fe,S.push(...ue.marks.map(Je=>({mark:Je,from:fe,to:Be})))})}),0===v)return!1;const O=S.filter($=>!y||y.name===$.mark.type.name).filter($=>Et($.mark.attrs,c,{strict:!1})).reduce(($,J)=>$+J.to-J.from,0),D=S.filter($=>!y||$.mark.type!==y&&$.mark.type.excludes(y)).reduce(($,J)=>$+J.to-J.from,0);return(O>0?O+D:O)>=v}function In(l,o,c={}){if(!o)return Mn(l,null,c)||gt(l,null,c);const p=Un(o,l.schema);return"node"===p?Mn(l,o,c):"mark"===p&&gt(l,o,c)}const yt=(l,o)=>{const{$from:c,$to:p,$anchor:g}=l.selection;if(o){const y=gn(S=>S.type.name===o)(l.selection);if(!y)return!1;const v=l.doc.resolve(y.pos+1);return g.pos+1===v.end()}return!(p.parentOffset<p.parent.nodeSize-2||c.pos!==p.pos)},_t=l=>{const{$from:o,$to:c}=l.selection;return!(o.parentOffset>0||o.pos!==c.pos)};function Kn(l,o){const{nodeExtensions:c}=P(o),p=c.find(v=>v.name===l);if(!p)return!1;const y=d(k(p,"group",{name:p.name,options:p.options,storage:p.storage}));return"string"==typeof y&&y.split(" ").includes("list")}function vt(l){var o;const c=null===(o=l.type.createAndFill())||void 0===o?void 0:o.toJSON(),p=l.toJSON();return JSON.stringify(c)===JSON.stringify(p)}function Dn(l){return l instanceof z.qv}function cn(l,o,c){const g=l.state.doc.content.size,y=Vt(o,0,g),v=Vt(c,0,g),S=l.coordsAtPos(y),O=l.coordsAtPos(v,-1),D=Math.min(S.top,O.top),H=Math.max(S.bottom,O.bottom),$=Math.min(S.left,O.left),J=Math.max(S.right,O.right),fe={top:D,bottom:H,left:$,right:J,width:J-$,height:H-D,x:$,y:D};return{...fe,toJSON:()=>fe}}function ui(l,o){const c=l.storedMarks||l.selection.$to.parentOffset&&l.selection.$from.marks();if(c){const p=c.filter(g=>null==o?void 0:o.includes(g.type.name));l.tr.ensureMarks(p)}}const Pn=(l,o)=>{const c=gn(v=>v.type===o)(l.selection);if(!c)return!0;const p=l.doc.resolve(Math.max(0,c.pos-1)).before(c.depth);if(void 0===p)return!0;const g=l.doc.nodeAt(p);return c.node.type===(null==g?void 0:g.type)&&(0,ne.Mn)(l.doc,c.pos)&&l.join(c.pos),!0},Li=(l,o)=>{const c=gn(v=>v.type===o)(l.selection);if(!c)return!0;const p=l.doc.resolve(c.start).after(c.depth);if(void 0===p)return!0;const g=l.doc.nodeAt(p);return c.node.type===(null==g?void 0:g.type)&&(0,ne.Mn)(l.doc,p)&&l.join(p),!0};var ro=Object.freeze({__proto__:null,blur:()=>({editor:l,view:o})=>(requestAnimationFrame(()=>{var c;l.isDestroyed||(o.dom.blur(),null===(c=null==window?void 0:window.getSelection())||void 0===c||c.removeAllRanges())}),!0),clearContent:(l=!1)=>({commands:o})=>o.setContent("",l),clearNodes:()=>({state:l,tr:o,dispatch:c})=>{const{selection:p}=o,{ranges:g}=p;return c&&g.forEach(({$from:y,$to:v})=>{l.doc.nodesBetween(y.pos,v.pos,(S,O)=>{if(S.type.isText)return;const{doc:D,mapping:H}=o,$=D.resolve(H.map(O)),J=D.resolve(H.map(O+S.nodeSize)),X=$.blockRange(J);if(!X)return;const re=(0,ne.k9)(X);if(S.type.isTextblock){const{defaultType:ue}=$.parent.contentMatchAt($.index());o.setNodeMarkup(X.start,ue)}(re||0===re)&&o.lift(X,re)})}),!0},command:l=>o=>l(o),createParagraphNear:()=>({state:l,dispatch:o})=>st(l,o),cut:(l,o)=>({editor:c,tr:p})=>{const{state:g}=c,y=g.doc.slice(l.from,l.to);p.deleteRange(l.from,l.to);const v=p.mapping.map(o);return p.insert(v,y.content),p.setSelection(new z.Bs(p.doc.resolve(v-1))),!0},deleteCurrentNode:()=>({tr:l,dispatch:o})=>{const{selection:c}=l,p=c.$anchor.node();if(p.content.size>0)return!1;const g=l.selection.$anchor;for(let y=g.depth;y>0;y-=1)if(g.node(y).type===p.type){if(o){const S=g.before(y),O=g.after(y);l.delete(S,O).scrollIntoView()}return!0}return!1},deleteNode:l=>({tr:o,state:c,dispatch:p})=>{const g=V(l,c.schema),y=o.selection.$anchor;for(let v=y.depth;v>0;v-=1)if(y.node(v).type===g){if(p){const O=y.before(v),D=y.after(v);o.delete(O,D).scrollIntoView()}return!0}return!1},deleteRange:l=>({tr:o,dispatch:c})=>{const{from:p,to:g}=l;return c&&o.delete(p,g),!0},deleteSelection:()=>({state:l,dispatch:o})=>Ye(l,o),enter:()=>({commands:l})=>l.keyboardShortcut("Enter"),exitCode:()=>({state:l,dispatch:o})=>Fe(l,o),extendMarkRange:(l,o={})=>({tr:c,state:p,dispatch:g})=>{const y=pt(l,p.schema),{doc:v,selection:S}=c,{$from:O,from:D,to:H}=S;if(g){const $=rn(O,y,o);if($&&$.from<=D&&$.to>=H){const J=z.Bs.create(v,$.from,$.to);c.setSelection(J)}}return!0},first:l=>o=>{const c="function"==typeof l?l(o):l;for(let p=0;p<c.length;p+=1)if(c[p](o))return!0;return!1},focus:(l=null,o={})=>({editor:c,view:p,tr:g,dispatch:y})=>{o={scrollIntoView:!0,...o};const v=()=>{kn()&&p.dom.focus(),requestAnimationFrame(()=>{c.isDestroyed||(p.focus(),null!=o&&o.scrollIntoView&&c.commands.scrollIntoView())})};if(p.hasFocus()&&null===l||!1===l)return!0;if(y&&null===l&&!xn(c.state.selection))return v(),!0;const S=wi(g.doc,l)||c.state.selection,O=c.state.selection.eq(S);return y&&(O||g.setSelection(S),O&&g.storedMarks&&g.setStoredMarks(g.storedMarks),v()),!0},forEach:(l,o)=>c=>l.every((p,g)=>o(p,{...c,index:g})),insertContent:(l,o)=>({tr:c,commands:p})=>p.insertContentAt({from:c.selection.from,to:c.selection.to},l,o),insertContentAt:(l,o,c)=>({tr:p,dispatch:g,editor:y})=>{if(g){c={parseOptions:{},updateSelection:!0,...c};const v=Lt(o,y.schema,{parseOptions:{preserveWhitespace:"full",...c.parseOptions}});if("<>"===v.toString())return!0;let{from:S,to:O}="number"==typeof l?{from:l,to:l}:{from:l.from,to:l.to},D=!0,H=!0;if(((l=>l.toString().startsWith("<"))(v)?v:[v]).forEach(J=>{J.check(),D=!!D&&J.isText&&0===J.marks.length,H=!!H&&J.isBlock}),S===O&&H){const{parent:J}=p.doc.resolve(S);J.isTextblock&&!J.type.spec.code&&!J.childCount&&(S-=1,O+=1)}D?Array.isArray(o)?p.insertText(o.map(J=>J.text||"").join(""),S,O):p.insertText("object"==typeof o&&o&&o.text?o.text:o,S,O):p.replaceWith(S,O,v),c.updateSelection&&bt(p,p.steps.length-1,-1)}return!0},joinUp:()=>({state:l,dispatch:o})=>((l,o)=>{let g,c=l.selection,p=c instanceof z.qv;if(p){if(c.node.isTextblock||!(0,ne.Mn)(l.doc,c.from))return!1;g=c.from}else if(g=(0,ne.GJ)(l.doc,c.from,-1),null==g)return!1;if(o){let y=l.tr.join(g);p&&y.setSelection(z.qv.create(y.doc,g-l.doc.resolve(g).nodeBefore.nodeSize)),o(y.scrollIntoView())}return!0})(l,o),joinDown:()=>({state:l,dispatch:o})=>((l,o)=>{let p,c=l.selection;if(c instanceof z.qv){if(c.node.isTextblock||!(0,ne.Mn)(l.doc,c.to))return!1;p=c.to}else if(p=(0,ne.GJ)(l.doc,c.to,1),null==p)return!1;return o&&o(l.tr.join(p).scrollIntoView()),!0})(l,o),joinBackward:()=>({state:l,dispatch:o})=>Ae(l,o),joinForward:()=>({state:l,dispatch:o})=>xe(l,o),joinItemBackward:()=>({tr:l,state:o,dispatch:c})=>{try{const p=(0,ne.GJ)(o.doc,o.selection.$from.pos,-1);return null!=p&&(l.join(p,2),c&&c(l),!0)}catch{return!1}},joinItemForward:()=>({state:l,dispatch:o,tr:c})=>{try{const p=(0,ne.GJ)(l.doc,l.selection.$from.pos,1);return null!=p&&(c.join(p,2),o&&o(c),!0)}catch{return!1}},joinTextblockBackward:()=>({state:l,dispatch:o})=>((l,o,c)=>{let p=Le(l,void 0);if(!p)return!1;let g=ze(p);return!!g&&Se(l,g,o)})(l,o),joinTextblockForward:()=>({state:l,dispatch:o})=>((l,o,c)=>{let p=me(l,void 0);if(!p)return!1;let g=ke(p);return!!g&&Se(l,g,o)})(l,o),keyboardShortcut:l=>({editor:o,view:c,tr:p,dispatch:g})=>{const y=function Xi(l){const o=l.split(/-(?!$)/);let p,g,y,v,c=o[o.length-1];"Space"===c&&(c=" ");for(let S=0;S<o.length-1;S+=1){const O=o[S];if(/^(cmd|meta|m)$/i.test(O))v=!0;else if(/^a(lt)?$/i.test(O))p=!0;else if(/^(c|ctrl|control)$/i.test(O))g=!0;else if(/^s(hift)?$/i.test(O))y=!0;else{if(!/^mod$/i.test(O))throw new Error(`Unrecognized modifier name: ${O}`);kn()||ri()?v=!0:g=!0}}return p&&(c=`Alt-${c}`),g&&(c=`Ctrl-${c}`),v&&(c=`Meta-${c}`),y&&(c=`Shift-${c}`),c}(l).split(/-(?!$)/),v=y.find(D=>!["Alt","Ctrl","Meta","Shift"].includes(D)),S=new KeyboardEvent("keydown",{key:"Space"===v?" ":v,altKey:y.includes("Alt"),ctrlKey:y.includes("Ctrl"),metaKey:y.includes("Meta"),shiftKey:y.includes("Shift"),bubbles:!0,cancelable:!0}),O=o.captureTransaction(()=>{c.someProp("handleKeyDown",D=>D(c,S))});return null==O||O.steps.forEach(D=>{const H=D.map(p.mapping);H&&g&&p.maybeStep(H)}),!0},lift:(l,o={})=>({state:c,dispatch:p})=>!!Mn(c,V(l,c.schema),o)&&((l,o)=>{let{$from:c,$to:p}=l.selection,g=c.blockRange(p),y=g&&(0,ne.k9)(g);return null!=y&&(o&&o(l.tr.lift(g,y).scrollIntoView()),!0)})(c,p),liftEmptyBlock:()=>({state:l,dispatch:o})=>qe(l,o),liftListItem:l=>({state:o,dispatch:c})=>function Dt(l){return function(o,c){let{$from:p,$to:g}=o.selection,y=p.blockRange(g,v=>v.childCount>0&&v.firstChild.type==l);return!!y&&(!c||(p.node(y.depth-1).type==l?function Pt(l,o,c,p){let g=l.tr,y=p.end,v=p.$to.end(p.depth);y<v&&(g.step(new ne.FC(y-1,v,y,v,new le.p2(le.HY.from(c.create(null,p.parent.copy())),1,0),1,!0)),p=new le.Ts(g.doc.resolve(p.$from.pos),g.doc.resolve(v),p.depth));const S=(0,ne.k9)(p);if(null==S)return!1;g.lift(p,S);let O=g.mapping.map(y,-1)-1;return(0,ne.Mn)(g.doc,O)&&g.join(O),o(g.scrollIntoView()),!0}(o,c,l,y):function St(l,o,c){let p=l.tr,g=c.parent;for(let X=c.end,re=c.endIndex-1,ue=c.startIndex;re>ue;re--)X-=g.child(re).nodeSize,p.delete(X-1,X+1);let y=p.doc.resolve(c.start),v=y.nodeAfter;if(p.mapping.map(c.end)!=c.start+y.nodeAfter.nodeSize)return!1;let S=0==c.startIndex,O=c.endIndex==g.childCount,D=y.node(-1),H=y.index(-1);if(!D.canReplace(H+(S?0:1),H+1,v.content.append(O?le.HY.empty:le.HY.from(g))))return!1;let $=y.pos,J=$+v.nodeSize;return p.step(new ne.FC($-(S?1:0),J+(O?1:0),$+1,J-1,new le.p2((S?le.HY.empty:le.HY.from(g.copy(le.HY.empty))).append(O?le.HY.empty:le.HY.from(g.copy(le.HY.empty))),S?0:1,O?0:1),S?0:1)),o(p.scrollIntoView()),!0}(o,c,y)))}}(V(l,o.schema))(o,c),newlineInCode:()=>({state:l,dispatch:o})=>Ee(l,o),resetAttributes:(l,o)=>({tr:c,state:p,dispatch:g})=>{let y=null,v=null;const S=Un("string"==typeof l?l:l.name,p.schema);return!!S&&("node"===S&&(y=V(l,p.schema)),"mark"===S&&(v=pt(l,p.schema)),g&&c.selection.ranges.forEach(O=>{p.doc.nodesBetween(O.$from.pos,O.$to.pos,(D,H)=>{y&&y===D.type&&c.setNodeMarkup(H,void 0,Ai(D.attrs,o)),v&&D.marks.length&&D.marks.forEach($=>{v===$.type&&c.addMark(H,H+D.nodeSize,v.create(Ai($.attrs,o)))})})}),!0)},scrollIntoView:()=>({tr:l,dispatch:o})=>(o&&l.scrollIntoView(),!0),selectAll:()=>({tr:l,commands:o})=>o.setTextSelection({from:0,to:l.doc.content.size}),selectNodeBackward:()=>({state:l,dispatch:o})=>rt(l,o),selectNodeForward:()=>({state:l,dispatch:o})=>Ce(l,o),selectParentNode:()=>({state:l,dispatch:o})=>((l,o)=>{let g,{$from:c,to:p}=l.selection,y=c.sharedDepth(p);return 0!=y&&(g=c.before(y),o&&o(l.tr.setSelection(z.qv.create(l.doc,g))),!0)})(l,o),selectTextblockEnd:()=>({state:l,dispatch:o})=>ve(l,o),selectTextblockStart:()=>({state:l,dispatch:o})=>he(l,o),setContent:(l,o=!1,c={})=>({tr:p,editor:g,dispatch:y})=>{const{doc:v}=p,S=jn(l,g.schema,c);return y&&p.replaceWith(0,v.content.size,S).setMeta("preventUpdate",!o),!0},setMark:(l,o={})=>({tr:c,state:p,dispatch:g})=>{const{selection:y}=c,{empty:v,ranges:S}=y,O=pt(l,p.schema);if(g)if(v){const D=si(p,O);c.addStoredMark(O.create({...D,...o}))}else S.forEach(D=>{const H=D.$from.pos,$=D.$to.pos;p.doc.nodesBetween(H,$,(J,X)=>{const re=Math.max(X,H),ue=Math.min(X+J.nodeSize,$);J.marks.find(fe=>fe.type===O)?J.marks.forEach(fe=>{O===fe.type&&c.addMark(re,ue,O.create({...fe.attrs,...o}))}):c.addMark(re,ue,O.create(o))})});return function et(l,o,c){var p;const{selection:g}=o;let y=null;if(xn(g)&&(y=g.$cursor),y){const S=null!==(p=l.storedMarks)&&void 0!==p?p:y.marks();return!!c.isInSet(S)||!S.some(O=>O.type.excludes(c))}const{ranges:v}=g;return v.some(({$from:S,$to:O})=>{let D=0===S.depth&&l.doc.inlineContent&&l.doc.type.allowsMarkType(c);return l.doc.nodesBetween(S.pos,O.pos,(H,$,J)=>{if(D)return!1;if(H.isInline){const X=!J||J.type.allowsMarkType(c),re=!!c.isInSet(H.marks)||!H.marks.some(ue=>ue.type.excludes(c));D=X&&re}return!D}),D})}(p,c,O)},setMeta:(l,o)=>({tr:c})=>(c.setMeta(l,o),!0),setNode:(l,o={})=>({state:c,dispatch:p,chain:g})=>{const y=V(l,c.schema);return y.isTextblock?g().command(({commands:v})=>!!Pe(y,o)(c)||v.clearNodes()).command(({state:v})=>Pe(y,o)(v,p)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},setNodeSelection:l=>({tr:o,dispatch:c})=>{if(c){const{doc:p}=o,g=Vt(l,0,p.content.size),y=z.qv.create(p,g);o.setSelection(y)}return!0},setTextSelection:l=>({tr:o,dispatch:c})=>{if(c){const{doc:p}=o,{from:g,to:y}="number"==typeof l?{from:l,to:l}:l,v=z.Bs.atStart(p).from,S=z.Bs.atEnd(p).to,O=Vt(g,v,S),D=Vt(y,v,S),H=z.Bs.create(p,O,D);o.setSelection(H)}return!0},sinkListItem:l=>({state:o,dispatch:c})=>function Rt(l){return function(o,c){let{$from:p,$to:g}=o.selection,y=p.blockRange(g,D=>D.childCount>0&&D.firstChild.type==l);if(!y)return!1;let v=y.startIndex;if(0==v)return!1;let S=y.parent,O=S.child(v-1);if(O.type!=l)return!1;if(c){let D=O.lastChild&&O.lastChild.type==S.type,H=le.HY.from(D?l.create():null),$=new le.p2(le.HY.from(l.create(null,le.HY.from(S.type.create(null,H)))),D?3:1,0),J=y.start,X=y.end;c(o.tr.step(new ne.FC(J-(D?3:1),X,J,X,$,1,!0)).scrollIntoView())}return!0}}(V(l,o.schema))(o,c),splitBlock:({keepMarks:l=!0}={})=>({tr:o,state:c,dispatch:p,editor:g})=>{const{selection:y,doc:v}=o,{$from:S,$to:O}=y,H=An(g.extensionManager.attributes,S.node().type.name,S.node().attrs);if(y instanceof z.qv&&y.node.isBlock)return!(!S.parentOffset||!(0,ne.Ax)(v,S.pos)||(p&&(l&&ui(c,g.extensionManager.splittableMarks),o.split(S.pos).scrollIntoView()),0));if(!S.parent.isBlock)return!1;if(p){const $=O.parentOffset===O.parent.content.size;y instanceof z.Bs&&o.deleteSelection();const J=0===S.depth?void 0:ln(S.node(-1).contentMatchAt(S.indexAfter(-1)));let X=$&&J?[{type:J,attrs:H}]:void 0,re=(0,ne.Ax)(o.doc,o.mapping.map(S.pos),1,X);if(!X&&!re&&(0,ne.Ax)(o.doc,o.mapping.map(S.pos),1,J?[{type:J}]:void 0)&&(re=!0,X=J?[{type:J,attrs:H}]:void 0),re&&(o.split(o.mapping.map(S.pos),1,X),J&&!$&&!S.parentOffset&&S.parent.type!==J)){const ue=o.mapping.map(S.before()),ce=o.doc.resolve(ue);S.node(-1).canReplaceWith(ce.index(),ce.index()+1,J)&&o.setNodeMarkup(o.mapping.map(S.before()),J)}l&&ui(c,g.extensionManager.splittableMarks),o.scrollIntoView()}return!0},splitListItem:l=>({tr:o,state:c,dispatch:p,editor:g})=>{var y;const v=V(l,c.schema),{$from:S,$to:O}=c.selection,D=c.selection.node;if(D&&D.isBlock||S.depth<2||!S.sameParent(O))return!1;const H=S.node(-1);if(H.type!==v)return!1;const $=g.extensionManager.attributes;if(0===S.parent.content.size&&S.node(-1).childCount===S.indexAfter(-1)){if(2===S.depth||S.node(-3).type!==v||S.index(-2)!==S.node(-2).childCount-1)return!1;if(p){let ce=le.HY.empty;const fe=S.index(-1)?1:S.index(-2)?2:3;for(let Bt=S.depth-fe;Bt>=S.depth-3;Bt-=1)ce=le.HY.from(S.node(Bt).copy(ce));const Be=S.indexAfter(-1)<S.node(-2).childCount?1:S.indexAfter(-2)<S.node(-3).childCount?2:3,_e=An($,S.node().type.name,S.node().attrs),Je=(null===(y=v.contentMatch.defaultType)||void 0===y?void 0:y.createAndFill(_e))||void 0;ce=ce.append(le.HY.from(v.createAndFill(null,Je)||void 0));const nt=S.before(S.depth-(fe-1));o.replace(nt,S.after(-Be),new le.p2(ce,4-fe,0));let Tt=-1;o.doc.nodesBetween(nt,o.doc.content.size,(Bt,hi)=>{if(Tt>-1)return!1;Bt.isTextblock&&0===Bt.content.size&&(Tt=hi+1)}),Tt>-1&&o.setSelection(z.Bs.near(o.doc.resolve(Tt))),o.scrollIntoView()}return!0}const J=O.pos===S.end()?H.contentMatchAt(0).defaultType:null,X=An($,H.type.name,H.attrs),re=An($,S.node().type.name,S.node().attrs);o.delete(S.pos,O.pos);const ue=J?[{type:v,attrs:X},{type:J,attrs:re}]:[{type:v,attrs:X}];if(!(0,ne.Ax)(o.doc,S.pos,2))return!1;if(p){const{selection:ce,storedMarks:fe}=c,{splittableMarks:Be}=g.extensionManager,_e=fe||ce.$to.parentOffset&&ce.$from.marks();if(o.split(S.pos,2,ue).scrollIntoView(),!_e||!p)return!0;const Je=_e.filter(nt=>Be.includes(nt.type.name));o.ensureMarks(Je)}return!0},toggleList:(l,o,c,p={})=>({editor:g,tr:y,state:v,dispatch:S,chain:O,commands:D,can:H})=>{const{extensions:$,splittableMarks:J}=g.extensionManager,X=V(l,v.schema),re=V(o,v.schema),{selection:ue,storedMarks:ce}=v,{$from:fe,$to:Be}=ue,_e=fe.blockRange(Be),Je=ce||ue.$to.parentOffset&&ue.$from.marks();if(!_e)return!1;const nt=gn(Tt=>Kn(Tt.type.name,$))(ue);if(_e.depth>=1&&nt&&_e.depth-nt.depth<=1){if(nt.node.type===X)return D.liftListItem(re);if(Kn(nt.node.type.name,$)&&X.validContent(nt.node.content)&&S)return O().command(()=>(y.setNodeMarkup(nt.pos,X),!0)).command(()=>Pn(y,X)).command(()=>Li(y,X)).run()}return c&&Je&&S?O().command(()=>{const Tt=H().wrapInList(X,p),Bt=Je.filter(hi=>J.includes(hi.type.name));return y.ensureMarks(Bt),!!Tt||D.clearNodes()}).wrapInList(X,p).command(()=>Pn(y,X)).command(()=>Li(y,X)).run():O().command(()=>!!H().wrapInList(X,p)||D.clearNodes()).wrapInList(X,p).command(()=>Pn(y,X)).command(()=>Li(y,X)).run()},toggleMark:(l,o={},c={})=>({state:p,commands:g})=>{const{extendEmptyMarkRange:y=!1}=c,v=pt(l,p.schema);return gt(p,v,o)?g.unsetMark(v,{extendEmptyMarkRange:y}):g.setMark(v,o)},toggleNode:(l,o,c={})=>({state:p,commands:g})=>{const y=V(l,p.schema),v=V(o,p.schema);return Mn(p,y,c)?g.setNode(v):g.setNode(y,c)},toggleWrap:(l,o={})=>({state:c,commands:p})=>{const g=V(l,c.schema);return Mn(c,g,o)?p.lift(g):p.wrapIn(g,o)},undoInputRule:()=>({state:l,dispatch:o})=>{const c=l.plugins;for(let p=0;p<c.length;p+=1){const g=c[p];let y;if(g.spec.isInputRules&&(y=g.getState(l))){if(o){const v=l.tr,S=y.transform;for(let O=S.steps.length-1;O>=0;O-=1)v.step(S.steps[O].invert(S.docs[O]));if(y.text){const O=v.doc.resolve(y.from).marks();v.replaceWith(y.from,y.to,l.schema.text(y.text,O))}else v.delete(y.from,y.to)}return!0}}return!1},unsetAllMarks:()=>({tr:l,dispatch:o})=>{const{selection:c}=l,{empty:p,ranges:g}=c;return p||o&&g.forEach(y=>{l.removeMark(y.$from.pos,y.$to.pos)}),!0},unsetMark:(l,o={})=>({tr:c,state:p,dispatch:g})=>{var y;const{extendEmptyMarkRange:v=!1}=o,{selection:S}=c,O=pt(l,p.schema),{$from:D,empty:H,ranges:$}=S;if(!g)return!0;if(H&&v){let{from:J,to:X}=S;const re=null===(y=D.marks().find(ce=>ce.type===O))||void 0===y?void 0:y.attrs,ue=rn(D,O,re);ue&&(J=ue.from,X=ue.to),c.removeMark(J,X,O)}else $.forEach(J=>{c.removeMark(J.$from.pos,J.$to.pos,O)});return c.removeStoredMark(O),!0},updateAttributes:(l,o={})=>({tr:c,state:p,dispatch:g})=>{let y=null,v=null;const S=Un("string"==typeof l?l:l.name,p.schema);return!!S&&("node"===S&&(y=V(l,p.schema)),"mark"===S&&(v=pt(l,p.schema)),g&&c.selection.ranges.forEach(O=>{const D=O.$from.pos,H=O.$to.pos;p.doc.nodesBetween(D,H,($,J)=>{y&&y===$.type&&c.setNodeMarkup(J,void 0,{...$.attrs,...o}),v&&$.marks.length&&$.marks.forEach(X=>{if(v===X.type){const re=Math.max(J,D),ue=Math.min(J+$.nodeSize,H);c.addMark(re,ue,v.create({...X.attrs,...o}))}})})}),!0)},wrapIn:(l,o={})=>({state:c,dispatch:p})=>function He(l,o=null){return function(c,p){let{$from:g,$to:y}=c.selection,v=g.blockRange(y),S=v&&(0,ne.nd)(v,l,o);return!!S&&(p&&p(c.tr.wrap(v,S).scrollIntoView()),!0)}}(V(l,c.schema),o)(c,p),wrapInList:(l,o={})=>({state:c,dispatch:p})=>function tn(l,o=null){return function(c,p){let{$from:g,$to:y}=c.selection,v=g.blockRange(y),S=!1,O=v;if(!v)return!1;if(v.depth>=2&&g.node(v.depth-1).type.compatibleContent(l)&&0==v.startIndex){if(0==g.index(v.depth-1))return!1;let H=c.doc.resolve(v.start-2);O=new le.Ts(H,H,v.depth),v.endIndex<v.parent.childCount&&(v=new le.Ts(g,c.doc.resolve(y.end(v.depth)),v.depth)),S=!0}let D=(0,ne.nd)(O,l,o,v);return!!D&&(p&&p(function wt(l,o,c,p,g){let y=le.HY.empty;for(let H=c.length-1;H>=0;H--)y=le.HY.from(c[H].type.create(c[H].attrs,y));l.step(new ne.FC(o.start-(p?2:0),o.end,o.start,o.end,new le.p2(y,0,0),c.length,!0));let v=0;for(let H=0;H<c.length;H++)c[H].type==g&&(v=H+1);let S=c.length-v,O=o.start+c.length-(p?2:0),D=o.parent;for(let H=o.startIndex,$=o.endIndex,J=!0;H<$;H++,J=!1)!J&&(0,ne.Ax)(l.doc,O,S)&&(l.split(O,S),O+=2*S),O+=D.child(H).nodeSize;return l}(c.tr,v,D,S,l).scrollIntoView()),!0)}}(V(l,c.schema),o)(c,p)});const so=Mt.create({name:"commands",addCommands:()=>({...ro})}),Do=Mt.create({name:"editable",addProseMirrorPlugins(){return[new z.Sy({key:new z.H$("editable"),props:{editable:()=>this.editor.options.editable}})]}}),lo=Mt.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:l}=this;return[new z.Sy({key:new z.H$("focusEvents"),props:{handleDOMEvents:{focus:(o,c)=>{l.isFocused=!0;const p=l.state.tr.setMeta("focus",{event:c}).setMeta("addToHistory",!1);return o.dispatch(p),!1},blur:(o,c)=>{l.isFocused=!1;const p=l.state.tr.setMeta("blur",{event:c}).setMeta("addToHistory",!1);return o.dispatch(p),!1}}}})]}}),Po=Mt.create({name:"keymap",addKeyboardShortcuts(){const l=()=>this.editor.commands.first(({commands:v})=>[()=>v.undoInputRule(),()=>v.command(({tr:S})=>{const{selection:O,doc:D}=S,{empty:H,$anchor:$}=O,{pos:J,parent:X}=$,re=$.parent.isTextblock?S.doc.resolve(J-1):$,fe=re.parent.type.spec.isolating&&1===re.parent.childCount?$.pos-$.parentOffset===$.pos:z.Y1.atStart(D).from===J;return!(!(H&&fe&&X.type.isTextblock)||X.textContent.length)&&v.clearNodes()}),()=>v.deleteSelection(),()=>v.joinBackward(),()=>v.selectNodeBackward()]),o=()=>this.editor.commands.first(({commands:v})=>[()=>v.deleteSelection(),()=>v.deleteCurrentNode(),()=>v.joinForward(),()=>v.selectNodeForward()]),p={Enter:()=>this.editor.commands.first(({commands:v})=>[()=>v.newlineInCode(),()=>v.createParagraphNear(),()=>v.liftEmptyBlock(),()=>v.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:l,"Mod-Backspace":l,"Shift-Backspace":l,Delete:o,"Mod-Delete":o,"Mod-a":()=>this.editor.commands.selectAll()},g={...p},y={...p,"Ctrl-h":l,"Alt-Backspace":l,"Ctrl-d":o,"Ctrl-Alt-Backspace":o,"Alt-Delete":o,"Alt-d":o,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return kn()||ri()?y:g},addProseMirrorPlugins(){return[new z.Sy({key:new z.H$("clearDocument"),appendTransaction:(l,o,c)=>{if(!l.some(re=>re.docChanged)||o.doc.eq(c.doc))return;const{empty:g,from:y,to:v}=o.selection,S=z.Y1.atStart(o.doc).from,O=z.Y1.atEnd(o.doc).to;if(g||y!==S||v!==O||0!==c.doc.textBetween(0,c.doc.content.size," "," ").length)return;const $=c.tr,J=$t({state:c,transaction:$}),{commands:X}=new K({editor:this.editor,state:J});return X.clearNodes(),$.steps.length?$:void 0}})]}}),Ro=Mt.create({name:"tabindex",addProseMirrorPlugins(){return[new z.Sy({key:new z.H$("tabindex"),props:{attributes:this.editor.isEditable?{tabindex:"0"}:{}}})]}});var pi=Object.freeze({__proto__:null,ClipboardTextSerializer:ni,Commands:so,Editable:Do,FocusEvents:lo,Keymap:Po,Tabindex:Ro});class dn{constructor(o,c,p=!1,g=null){this.currentNode=null,this.actualDepth=null,this.isBlock=p,this.resolvedPos=o,this.editor=c,this.currentNode=g}get name(){return this.node.type.name}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var o;return null!==(o=this.actualDepth)&&void 0!==o?o:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(o){let c=this.from,p=this.to;if(this.isBlock){if(0===this.content.size)return void console.error(`You can\u2019t set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);c=this.from+1,p=this.to-1}this.editor.commands.insertContentAt({from:c,to:p},o)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(0===this.depth)return null;const o=this.resolvedPos.start(this.resolvedPos.depth-1),c=this.resolvedPos.doc.resolve(o);return new dn(c,this.editor)}get before(){let o=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return o.depth!==this.depth&&(o=this.resolvedPos.doc.resolve(this.from-3)),new dn(o,this.editor)}get after(){let o=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return o.depth!==this.depth&&(o=this.resolvedPos.doc.resolve(this.to+3)),new dn(o,this.editor)}get children(){const o=[];return this.node.content.forEach((c,p)=>{const g=c.isBlock&&!c.isTextblock,v=this.resolvedPos.doc.resolve(this.pos+p+(g?0:1));if(!g&&v.depth<=this.depth)return;const S=new dn(v,this.editor,g,g?c:null);g&&(S.actualDepth=this.depth+1),o.push(new dn(v,this.editor,g,g?c:null))}),o}get firstChild(){return this.children[0]||null}get lastChild(){const o=this.children;return o[o.length-1]||null}closest(o,c={}){let p=null,g=this.parent;for(;g&&!p;){if(g.node.type.name===o)if(Object.keys(c).length>0){const y=g.node.attrs,v=Object.keys(c);for(let S=0;S<v.length;S+=1){const O=v[S];if(y[O]!==c[O])break}}else p=g;g=g.parent}return p}querySelector(o,c={}){return this.querySelectorAll(o,c,!0)[0]||null}querySelectorAll(o,c={},p=!1){let g=[];return this.isBlock||!this.children||0===this.children.length||this.children.forEach(y=>{if(y.node.type.name===o){if(Object.keys(c).length>0){const v=y.node.attrs,S=Object.keys(c);for(let O=0;O<S.length;O+=1){const D=S[O];if(v[D]!==c[D])return}}if(g.push(y),p)return}g=g.concat(y.querySelectorAll(o))}),g}setAttribute(o){const c=this.editor.state.selection;this.editor.chain().setTextSelection(this.from).updateAttributes(this.node.type.name,o).setTextSelection(c.from).run()}}function No(l,o,c){const p=document.querySelector(`style[data-tiptap-style${c?`-${c}`:""}]`);if(null!==p)return p;const g=document.createElement("style");return o&&g.setAttribute("nonce",o),g.setAttribute("data-tiptap-style"+(c?`-${c}`:""),""),g.innerHTML=l,document.getElementsByTagName("head")[0].appendChild(g),g}class Lo extends w{constructor(o={}){super(),this.isFocused=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(o),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}))},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=No('.ProseMirror {\n  position: relative;\n}\n\n.ProseMirror {\n  word-wrap: break-word;\n  white-space: pre-wrap;\n  white-space: break-spaces;\n  -webkit-font-variant-ligatures: none;\n  font-variant-ligatures: none;\n  font-feature-settings: "liga" 0; /* the above doesn\'t seem to work in Edge */\n}\n\n.ProseMirror [contenteditable="false"] {\n  white-space: normal;\n}\n\n.ProseMirror [contenteditable="false"] [contenteditable="true"] {\n  white-space: pre-wrap;\n}\n\n.ProseMirror pre {\n  white-space: pre-wrap;\n}\n\nimg.ProseMirror-separator {\n  display: inline !important;\n  border: none !important;\n  margin: 0 !important;\n  width: 1px !important;\n  height: 1px !important;\n}\n\n.ProseMirror-gapcursor {\n  display: none;\n  pointer-events: none;\n  position: absolute;\n  margin: 0;\n}\n\n.ProseMirror-gapcursor:after {\n  content: "";\n  display: block;\n  position: absolute;\n  top: -2px;\n  width: 20px;\n  border-top: 1px solid black;\n  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;\n}\n\n@keyframes ProseMirror-cursor-blink {\n  to {\n    visibility: hidden;\n  }\n}\n\n.ProseMirror-hideselection *::selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection *::-moz-selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection * {\n  caret-color: transparent;\n}\n\n.ProseMirror-focused .ProseMirror-gapcursor {\n  display: block;\n}\n\n.tippy-box[data-animation=fade][data-state=hidden] {\n  opacity: 0\n}',this.options.injectNonce))}setOptions(o={}){this.options={...this.options,...o},this.view&&this.state&&!this.isDestroyed&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(o,c=!0){this.setOptions({editable:o}),c&&this.emit("update",{editor:this,transaction:this.state.tr})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(o,c){const p=R(c)?c(o,[...this.state.plugins]):[...this.state.plugins,o],g=this.state.reconfigure({plugins:p});this.view.updateState(g)}unregisterPlugin(o){if(this.isDestroyed)return;const c="string"==typeof o?`${o}$`:o.key,p=this.state.reconfigure({plugins:this.state.plugins.filter(g=>!g.key.startsWith(c))});this.view.updateState(p)}createExtensionManager(){const c=[...this.options.enableCoreExtensions?Object.values(pi):[],...this.options.extensions].filter(p=>["extension","node","mark"].includes(null==p?void 0:p.type));this.extensionManager=new vn(c,this)}createCommandManager(){this.commandManager=new K({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){const o=jn(this.options.content,this.schema,this.options.parseOptions),c=wi(o,this.options.autofocus);this.view=new Te.tk(this.options.element,{...this.options.editorProps,dispatchTransaction:this.dispatchTransaction.bind(this),state:z.yy.create({doc:o,selection:c||void 0})});const p=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(p),this.createNodeViews(),this.prependClass(),this.view.dom.editor=this}createNodeViews(){this.view.setProps({nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`tiptap ${this.view.dom.className}`}captureTransaction(o){this.isCapturingTransaction=!0,o(),this.isCapturingTransaction=!1;const c=this.capturedTransaction;return this.capturedTransaction=null,c}dispatchTransaction(o){if(this.view.isDestroyed)return;if(this.isCapturingTransaction)return this.capturedTransaction?void o.steps.forEach(v=>{var S;return null===(S=this.capturedTransaction)||void 0===S?void 0:S.step(v)}):void(this.capturedTransaction=o);const c=this.state.apply(o),p=!this.state.selection.eq(c.selection);this.view.updateState(c),this.emit("transaction",{editor:this,transaction:o}),p&&this.emit("selectionUpdate",{editor:this,transaction:o});const g=o.getMeta("focus"),y=o.getMeta("blur");g&&this.emit("focus",{editor:this,event:g.event,transaction:o}),y&&this.emit("blur",{editor:this,event:y.event,transaction:o}),o.docChanged&&!o.getMeta("preventUpdate")&&this.emit("update",{editor:this,transaction:o})}getAttributes(o){return Jn(this.state,o)}isActive(o,c){return In(this.state,"string"==typeof o?o:null,"string"==typeof o?c:o)}getJSON(){return this.state.doc.toJSON()}getHTML(){return li(this.state.doc.content,this.schema)}getText(o){const{blockSeparator:c="\n\n",textSerializers:p={}}=o||{};return ci(this.state.doc,{blockSeparator:c,textSerializers:{...ct(this.schema),...p}})}get isEmpty(){return vt(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){this.emit("destroy"),this.view&&this.view.destroy(),this.removeAllListeners()}get isDestroyed(){var o;return!(null!==(o=this.view)&&void 0!==o&&o.docView)}$node(o,c){var p;return(null===(p=this.$doc)||void 0===p?void 0:p.querySelector(o,c))||null}$nodes(o,c){var p;return(null===(p=this.$doc)||void 0===p?void 0:p.querySelectorAll(o,c))||null}$pos(o){const c=this.state.doc.resolve(o);return new dn(c,this)}get $doc(){return this.$pos(0)}}function Ho(l){return new Ge({find:l.find,handler:({state:o,range:c,match:p})=>{const g=d(l.getAttributes,void 0,p);if(!1===g||null===g)return null;const{tr:y}=o,v=p[p.length-1],S=p[0];if(v){const O=S.search(/\S/),D=c.from+S.indexOf(v),H=D+v.length;if(_n(c.from,c.to,o.doc).filter(X=>X.mark.type.excluded.find(ue=>ue===l.type&&ue!==X.mark.type)).filter(X=>X.to>D).length)return null;H<c.to&&y.delete(H,c.to),D>c.from&&y.delete(c.from+O,D),y.addMark(c.from+O,c.from+O+v.length,l.type.create(g||{})),y.removeStoredMark(l.type)}}})}function Fo(l){return new Ge({find:l.find,handler:({state:o,range:c,match:p})=>{const g=d(l.getAttributes,void 0,p)||{},{tr:y}=o,v=c.from;let S=c.to;const O=l.type.create(g);if(p[1]){let H=v+p[0].lastIndexOf(p[1]);H>S?H=S:S=H+p[1].length,y.insertText(p[0][p[0].length-1],v+p[0].length-1),y.replaceWith(H,S,O)}else p[0]&&y.insert(v-1,l.type.create(g)).delete(y.mapping.map(v),y.mapping.map(S));y.scrollIntoView()}})}function co(l){return new Ge({find:l.find,handler:({state:o,range:c,match:p})=>{const g=o.doc.resolve(c.from),y=d(l.getAttributes,void 0,p)||{};if(!g.node(-1).canReplaceWith(g.index(-1),g.indexAfter(-1),l.type))return null;o.tr.delete(c.from,c.to).setBlockType(c.from,c.from,l.type,y)}})}function Bo(l){return new Ge({find:l.find,handler:({state:o,range:c,match:p})=>{let g=l.replace,y=c.from;const v=c.to;if(p[1]){const S=p[0].lastIndexOf(p[1]);g+=p[0].slice(S+p[1].length),y+=S;const O=y-v;O>0&&(g=p[0].slice(S-O,S)+g,y=v)}o.tr.insertText(g,y,v)}})}function uo(l){return new Ge({find:l.find,handler:({state:o,range:c,match:p,chain:g})=>{const y=d(l.getAttributes,void 0,p)||{},v=o.tr.delete(c.from,c.to),O=v.doc.resolve(c.from).blockRange(),D=O&&(0,ne.nd)(O,l.type,y);if(!D)return null;if(v.wrap(O,D),l.keepMarks&&l.editor){const{selection:$,storedMarks:J}=o,{splittableMarks:X}=l.editor.extensionManager,re=J||$.$to.parentOffset&&$.$from.marks();if(re){const ue=re.filter(ce=>X.includes(ce.type.name));v.ensureMarks(ue)}}if(l.keepAttributes){const $="bulletList"===l.type.name||"orderedList"===l.type.name?"listItem":"taskList";g().updateAttributes($,y).run()}const H=v.doc.resolve(c.from-1).nodeBefore;H&&H.type===l.type&&(0,ne.Mn)(v.doc,c.from-1)&&(!l.joinPredicate||l.joinPredicate(p,H))&&v.join(c.from-1)}})}class Gn{constructor(o={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...o},this.name=this.config.name,o.defaultOptions&&Object.keys(o.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=d(k(this,"addOptions",{name:this.name}))),this.storage=d(k(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(o={}){return new Gn(o)}configure(o={}){const c=this.extend();return c.options=on(this.options,o),c.storage=d(k(c,"addStorage",{name:c.name,options:c.options})),c}extend(o={}){const c=new Gn({...this.config,...o});return c.parent=this,this.child=c,c.name=o.name?o.name:c.parent.name,o.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${c.name}".`),c.options=d(k(c,"addOptions",{name:c.name})),c.storage=d(k(c,"addStorage",{name:c.name,options:c.options})),c}static handleExit({editor:o,mark:c}){const{tr:p}=o.state,g=o.state.selection.$from;if(g.pos===g.end()){const v=g.marks();if(!v.find(D=>(null==D?void 0:D.type.name)===c.name))return!1;const O=v.find(D=>(null==D?void 0:D.type.name)===c.name);return O&&p.removeStoredMark(O),p.insertText(" ",g.pos),o.view.dispatch(p),!0}return!1}}class Ft{constructor(o={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...o},this.name=this.config.name,o.defaultOptions&&Object.keys(o.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=d(k(this,"addOptions",{name:this.name}))),this.storage=d(k(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(o={}){return new Ft(o)}configure(o={}){const c=this.extend();return c.options=on(this.options,o),c.storage=d(k(c,"addStorage",{name:c.name,options:c.options})),c}extend(o={}){const c=new Ft({...this.config,...o});return c.parent=this,this.child=c,c.name=o.name?o.name:c.parent.name,o.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${c.name}".`),c.options=d(k(c,"addOptions",{name:c.name})),c.storage=d(k(c,"addStorage",{name:c.name,options:c.options})),c}}class fi{constructor(o,c,p){this.isDragging=!1,this.component=o,this.editor=c.editor,this.options={stopEvent:null,ignoreMutation:null,...p},this.extension=c.extension,this.node=c.node,this.decorations=c.decorations,this.getPos=c.getPos,this.mount()}mount(){}get dom(){return this.editor.view.dom}get contentDOM(){return null}onDragStart(o){var c,p,g,y,v,S,O;const{view:D}=this.editor,H=o.target,$=3===H.nodeType?null===(c=H.parentElement)||void 0===c?void 0:c.closest("[data-drag-handle]"):H.closest("[data-drag-handle]");if(!this.dom||null!==(p=this.contentDOM)&&void 0!==p&&p.contains(H)||!$)return;let J=0,X=0;if(this.dom!==$){const ce=this.dom.getBoundingClientRect(),fe=$.getBoundingClientRect(),Be=null!==(g=o.offsetX)&&void 0!==g?g:null===(y=o.nativeEvent)||void 0===y?void 0:y.offsetX,_e=null!==(v=o.offsetY)&&void 0!==v?v:null===(S=o.nativeEvent)||void 0===S?void 0:S.offsetY;J=fe.x-ce.x+Be,X=fe.y-ce.y+_e}null===(O=o.dataTransfer)||void 0===O||O.setDragImage(this.dom,J,X);const re=z.qv.create(D.state.doc,this.getPos()),ue=D.state.tr.setSelection(re);D.dispatch(ue)}stopEvent(o){var c;if(!this.dom)return!1;if("function"==typeof this.options.stopEvent)return this.options.stopEvent({event:o});const p=o.target;if(!this.dom.contains(p)||null!==(c=this.contentDOM)&&void 0!==c&&c.contains(p))return!1;const y=o.type.startsWith("drag"),v="drop"===o.type;if((["INPUT","BUTTON","SELECT","TEXTAREA"].includes(p.tagName)||p.isContentEditable)&&!v&&!y)return!0;const{isEditable:O}=this.editor,{isDragging:D}=this,H=!!this.node.type.spec.draggable,$=z.qv.isSelectable(this.node),J="copy"===o.type,X="paste"===o.type,re="cut"===o.type,ue="mousedown"===o.type;if(!H&&$&&y&&o.preventDefault(),H&&y&&!D)return o.preventDefault(),!1;if(H&&O&&!D&&ue){const ce=p.closest("[data-drag-handle]");ce&&(this.dom===ce||this.dom.contains(ce))&&(this.isDragging=!0,document.addEventListener("dragend",()=>{this.isDragging=!1},{once:!0}),document.addEventListener("drop",()=>{this.isDragging=!1},{once:!0}),document.addEventListener("mouseup",()=>{this.isDragging=!1},{once:!0}))}return!(D||v||J||X||re||ue&&$)}ignoreMutation(o){return!this.dom||!this.contentDOM||("function"==typeof this.options.ignoreMutation?this.options.ignoreMutation({mutation:o}):!(!this.node.isLeaf&&!this.node.isAtom&&("selection"===o.type||this.dom.contains(o.target)&&"childList"===o.type&&(kn()||function Hi(){return"Android"===navigator.platform||/android/i.test(navigator.userAgent)}())&&this.editor.isFocused&&[...Array.from(o.addedNodes),...Array.from(o.removedNodes)].every(p=>p.isContentEditable)||(this.contentDOM!==o.target||"attributes"!==o.type)&&this.contentDOM.contains(o.target))))}updateAttributes(o){this.editor.commands.command(({tr:c})=>{const p=this.getPos();return c.setNodeMarkup(p,void 0,{...this.node.attrs,...o}),!0})}deleteNode(){const o=this.getPos();this.editor.commands.deleteRange({from:o,to:o+this.node.nodeSize})}}function a(l){return new Bn({find:l.find,handler:({state:o,range:c,match:p,pasteEvent:g})=>{const y=d(l.getAttributes,void 0,p,g);if(!1===y||null===y)return null;const{tr:v}=o,S=p[p.length-1],O=p[0];let D=c.to;if(S){const H=O.search(/\S/),$=c.from+O.indexOf(S),J=$+S.length;if(_n(c.from,c.to,o.doc).filter(re=>re.mark.type.excluded.find(ce=>ce===l.type&&ce!==re.mark.type)).filter(re=>re.to>$).length)return null;J<c.to&&v.delete(J,c.to),$>c.from&&v.delete(c.from+H,$),D=c.from+H+S.length,v.addMark(c.from+H,D,l.type.create(y||{})),v.removeStoredMark(l.type)}}})}function s(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function u(l){return"string"==typeof l}function f(l){return new Bn({find:l.find,handler({match:o,chain:c,range:p,pasteEvent:g}){const y=d(l.getAttributes,void 0,o,g);if(!1===y||null===y)return null;o.input&&c().deleteRange(p).insertContentAt(p.from,{type:l.type.name,attrs:y})}})}function T(l){return new Bn({find:l.find,handler:({state:o,range:c,match:p})=>{let g=l.replace,y=c.from;const v=c.to;if(p[1]){const S=p[0].lastIndexOf(p[1]);g+=p[0].slice(S+p[1].length),y+=S;const O=y-v;O>0&&(g=p[0].slice(S-O,S)+g,y=v)}o.tr.insertText(g,y,v)}})}class b{constructor(o){this.transaction=o,this.currentStep=this.transaction.steps.length}map(o){let c=!1;return{position:this.transaction.steps.slice(this.currentStep).reduce((g,y)=>{const v=y.getMap().mapResult(g);return v.deleted&&(c=!0),v.pos},o),deleted:c}}}},5664:(Fn,tt,Q)=>{"use strict";Q.r(tt),Q.d(tt,{Image:()=>Ne,default:()=>Ne,inputRegex:()=>Te});var z=Q(9911);const Te=/(?:^|\s)(!\[(.+|:?)]\((\S+)(?:(?:\s+)["'](\S+)["'])?\))$/,Ne=z.Node.create({name:"image",addOptions:()=>({inline:!1,allowBase64:!1,HTMLAttributes:{}}),inline(){return this.options.inline},group(){return this.options.inline?"inline":"block"},draggable:!0,addAttributes:()=>({src:{default:null},alt:{default:null},title:{default:null}}),parseHTML(){return[{tag:this.options.allowBase64?"img[src]":'img[src]:not([src^="data:"])'}]},renderHTML({HTMLAttributes:le}){return["img",(0,z.mergeAttributes)(this.options.HTMLAttributes,le)]},addCommands(){return{setImage:le=>({commands:ne})=>ne.insertContent({type:this.name,attrs:le})}},addInputRules(){return[(0,z.nodeInputRule)({find:Te,type:this.type,getAttributes:le=>{const[,,ne,Ye,Le]=le;return{src:Ye,alt:ne,title:Le}}})]}})},3740:(Fn,tt,Q)=>{"use strict";Q.r(tt),Q.d(tt,{TextStyle:()=>Te,default:()=>Te});var z=Q(9911);const Te=z.Mark.create({name:"textStyle",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"span",getAttrs:Ne=>!!Ne.hasAttribute("style")&&{}}],renderHTML({HTMLAttributes:Ne}){return["span",(0,z.mergeAttributes)(this.options.HTMLAttributes,Ne),0]},addCommands(){return{removeEmptyTextStyle:()=>({state:Ne,commands:le})=>{const ne=(0,z.getMarkAttributes)(Ne,this.type);return!!Object.entries(ne).some(([,Le])=>!!Le)||le.unsetMark(this.name)}}}})},3861:(Fn,tt,Q)=>{"use strict";Q.d(tt,{$:()=>ze,h:()=>rt});for(var z={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Te={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},Ne=typeof navigator<"u"&&/Mac/.test(navigator.platform),le=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),ne=0;ne<10;ne++)z[48+ne]=z[96+ne]=String(ne);for(ne=1;ne<=24;ne++)z[ne+111]="F"+ne;for(ne=65;ne<=90;ne++)z[ne]=String.fromCharCode(ne+32),Te[ne]=String.fromCharCode(ne);for(var Ye in z)Te.hasOwnProperty(Ye)||(Te[Ye]=z[Ye]);var Ae=Q(7825);const C=typeof navigator<"u"&&/Mac|iP(hone|[oa]d)/.test(navigator.platform);function Ie(me){let ke,Oe,De,je,xe=me.split(/-(?!$)/),Ce=xe[xe.length-1];"Space"==Ce&&(Ce=" ");for(let Ee=0;Ee<xe.length-1;Ee++){let $e=xe[Ee];if(/^(cmd|meta|m)$/i.test($e))je=!0;else if(/^a(lt)?$/i.test($e))ke=!0;else if(/^(c|ctrl|control)$/i.test($e))Oe=!0;else if(/^s(hift)?$/i.test($e))De=!0;else{if(!/^mod$/i.test($e))throw new Error("Unrecognized modifier name: "+$e);C?je=!0:Oe=!0}}return ke&&(Ce="Alt-"+Ce),Oe&&(Ce="Ctrl-"+Ce),je&&(Ce="Meta-"+Ce),De&&(Ce="Shift-"+Ce),Ce}function Me(me,xe,Ce=!0){return xe.altKey&&(me="Alt-"+me),xe.ctrlKey&&(me="Ctrl-"+me),xe.metaKey&&(me="Meta-"+me),Ce&&xe.shiftKey&&(me="Shift-"+me),me}function rt(me){return new Ae.Sy({props:{handleKeyDown:ze(me)}})}function ze(me){let xe=function Se(me){let xe=Object.create(null);for(let Ce in me)xe[Ie(Ce)]=me[Ce];return xe}(me);return function(Ce,ke){let De,Oe=function Le(me){var Ce=!(Ne&&me.metaKey&&me.shiftKey&&!me.ctrlKey&&!me.altKey||le&&me.shiftKey&&me.key&&1==me.key.length||"Unidentified"==me.key)&&me.key||(me.shiftKey?Te:z)[me.keyCode]||me.key||"Unidentified";return"Esc"==Ce&&(Ce="Escape"),"Del"==Ce&&(Ce="Delete"),"Left"==Ce&&(Ce="ArrowLeft"),"Up"==Ce&&(Ce="ArrowUp"),"Right"==Ce&&(Ce="ArrowRight"),"Down"==Ce&&(Ce="ArrowDown"),Ce}(ke),je=xe[Me(Oe,ke)];if(je&&je(Ce.state,Ce.dispatch,Ce))return!0;if(1==Oe.length&&" "!=Oe){if(ke.shiftKey){let Ee=xe[Me(Oe,ke,!1)];if(Ee&&Ee(Ce.state,Ce.dispatch,Ce))return!0}if((ke.shiftKey||ke.altKey||ke.metaKey||Oe.charCodeAt(0)>127)&&(De=z[ke.keyCode])&&De!=Oe){let Ee=xe[Me(De,ke)];if(Ee&&Ee(Ce.state,Ce.dispatch,Ce))return!0}}return!1}}},7834:(Fn,tt,Q)=>{"use strict";function z(R){this.content=R}Q.d(tt,{aw:()=>Gt,PW:()=>V,HY:()=>ne,vc:()=>C,ZU:()=>Yt,NB:()=>de,Ts:()=>We,e4:()=>Ie,V_:()=>bn,p2:()=>Se}),z.prototype={constructor:z,find:function(R){for(var d=0;d<this.content.length;d+=2)if(this.content[d]===R)return d;return-1},get:function(R){var d=this.find(R);return-1==d?void 0:this.content[d+1]},update:function(R,d,m){var x=m&&m!=R?this.remove(m):this,M=x.find(R),A=x.content.slice();return-1==M?A.push(m||R,d):(A[M+1]=d,m&&(A[M]=m)),new z(A)},remove:function(R){var d=this.find(R);if(-1==d)return this;var m=this.content.slice();return m.splice(d,2),new z(m)},addToStart:function(R,d){return new z([R,d].concat(this.remove(R).content))},addToEnd:function(R,d){var m=this.remove(R).content.slice();return m.push(R,d),new z(m)},addBefore:function(R,d,m){var x=this.remove(d),M=x.content.slice(),A=x.find(R);return M.splice(-1==A?M.length:A,0,d,m),new z(M)},forEach:function(R){for(var d=0;d<this.content.length;d+=2)R(this.content[d],this.content[d+1])},prepend:function(R){return(R=z.from(R)).size?new z(R.content.concat(this.subtract(R).content)):this},append:function(R){return(R=z.from(R)).size?new z(this.subtract(R).content.concat(R.content)):this},subtract:function(R){var d=this;R=z.from(R);for(var m=0;m<R.content.length;m+=2)d=d.remove(R.content[m]);return d},toObject:function(){var R={};return this.forEach(function(d,m){R[d]=m}),R},get size(){return this.content.length>>1}},z.from=function(R){if(R instanceof z)return R;var d=[];if(R)for(var m in R)d.push(m,R[m]);return new z(d)};const Te=z;function Ne(R,d,m){for(let x=0;;x++){if(x==R.childCount||x==d.childCount)return R.childCount==d.childCount?null:m;let M=R.child(x),A=d.child(x);if(M!=A){if(!M.sameMarkup(A))return m;if(M.isText&&M.text!=A.text){for(let L=0;M.text[L]==A.text[L];L++)m++;return m}if(M.content.size||A.content.size){let L=Ne(M.content,A.content,m+1);if(null!=L)return L}m+=M.nodeSize}else m+=M.nodeSize}}function le(R,d,m,x){for(let M=R.childCount,A=d.childCount;;){if(0==M||0==A)return M==A?null:{a:m,b:x};let L=R.child(--M),W=d.child(--A),q=L.nodeSize;if(L!=W){if(!L.sameMarkup(W))return{a:m,b:x};if(L.isText&&L.text!=W.text){let pe=0,ge=Math.min(L.text.length,W.text.length);for(;pe<ge&&L.text[L.text.length-pe-1]==W.text[W.text.length-pe-1];)pe++,m--,x--;return{a:m,b:x}}if(L.content.size||W.content.size){let pe=le(L.content,W.content,m-1,x-1);if(pe)return pe}m-=q,x-=q}else m-=q,x-=q}}class ne{constructor(d,m){if(this.content=d,this.size=m||0,null==m)for(let x=0;x<d.length;x++)this.size+=d[x].nodeSize}nodesBetween(d,m,x,M=0,A){for(let L=0,W=0;W<m;L++){let q=this.content[L],pe=W+q.nodeSize;if(pe>d&&!1!==x(q,M+W,A||null,L)&&q.content.size){let ge=W+1;q.nodesBetween(Math.max(0,d-ge),Math.min(q.content.size,m-ge),x,M+ge)}W=pe}}descendants(d){this.nodesBetween(0,this.size,d)}textBetween(d,m,x,M){let A="",L=!0;return this.nodesBetween(d,m,(W,q)=>{let pe=W.isText?W.text.slice(Math.max(d,q)-q,m-q):W.isLeaf?M?"function"==typeof M?M(W):M:W.type.spec.leafText?W.type.spec.leafText(W):"":"";W.isBlock&&(W.isLeaf&&pe||W.isTextblock)&&x&&(L?L=!1:A+=x),A+=pe},0),A}append(d){if(!d.size)return this;if(!this.size)return d;let m=this.lastChild,x=d.firstChild,M=this.content.slice(),A=0;for(m.isText&&m.sameMarkup(x)&&(M[M.length-1]=m.withText(m.text+x.text),A=1);A<d.content.length;A++)M.push(d.content[A]);return new ne(M,this.size+d.size)}cut(d,m=this.size){if(0==d&&m==this.size)return this;let x=[],M=0;if(m>d)for(let A=0,L=0;L<m;A++){let W=this.content[A],q=L+W.nodeSize;q>d&&((L<d||q>m)&&(W=W.isText?W.cut(Math.max(0,d-L),Math.min(W.text.length,m-L)):W.cut(Math.max(0,d-L-1),Math.min(W.content.size,m-L-1))),x.push(W),M+=W.nodeSize),L=q}return new ne(x,M)}cutByIndex(d,m){return d==m?ne.empty:0==d&&m==this.content.length?this:new ne(this.content.slice(d,m))}replaceChild(d,m){let x=this.content[d];if(x==m)return this;let M=this.content.slice(),A=this.size+m.nodeSize-x.nodeSize;return M[d]=m,new ne(M,A)}addToStart(d){return new ne([d].concat(this.content),this.size+d.nodeSize)}addToEnd(d){return new ne(this.content.concat(d),this.size+d.nodeSize)}eq(d){if(this.content.length!=d.content.length)return!1;for(let m=0;m<this.content.length;m++)if(!this.content[m].eq(d.content[m]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(d){let m=this.content[d];if(!m)throw new RangeError("Index "+d+" out of range for "+this);return m}maybeChild(d){return this.content[d]||null}forEach(d){for(let m=0,x=0;m<this.content.length;m++){let M=this.content[m];d(M,x,m),x+=M.nodeSize}}findDiffStart(d,m=0){return Ne(this,d,m)}findDiffEnd(d,m=this.size,x=d.size){return le(this,d,m,x)}findIndex(d,m=-1){if(0==d)return Le(0,d);if(d==this.size)return Le(this.content.length,d);if(d>this.size||d<0)throw new RangeError(`Position ${d} outside of fragment (${this})`);for(let x=0,M=0;;x++){let L=M+this.child(x).nodeSize;if(L>=d)return L==d||m>0?Le(x+1,L):Le(x,M);M=L}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(d=>d.toJSON()):null}static fromJSON(d,m){if(!m)return ne.empty;if(!Array.isArray(m))throw new RangeError("Invalid input for Fragment.fromJSON");return new ne(m.map(d.nodeFromJSON))}static fromArray(d){if(!d.length)return ne.empty;let m,x=0;for(let M=0;M<d.length;M++){let A=d[M];x+=A.nodeSize,M&&A.isText&&d[M-1].sameMarkup(A)?(m||(m=d.slice(0,M)),m[m.length-1]=A.withText(m[m.length-1].text+A.text)):m&&m.push(A)}return new ne(m||d,x)}static from(d){if(!d)return ne.empty;if(d instanceof ne)return d;if(Array.isArray(d))return this.fromArray(d);if(d.attrs)return new ne([d],d.nodeSize);throw new RangeError("Can not convert "+d+" to a Fragment"+(d.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}ne.empty=new ne([],0);const Ye={index:0,offset:0};function Le(R,d){return Ye.index=R,Ye.offset=d,Ye}function Ae(R,d){if(R===d)return!0;if(!R||"object"!=typeof R||!d||"object"!=typeof d)return!1;let m=Array.isArray(R);if(Array.isArray(d)!=m)return!1;if(m){if(R.length!=d.length)return!1;for(let x=0;x<R.length;x++)if(!Ae(R[x],d[x]))return!1}else{for(let x in R)if(!(x in d)||!Ae(R[x],d[x]))return!1;for(let x in d)if(!(x in R))return!1}return!0}let C=(()=>{class R{constructor(m,x){this.type=m,this.attrs=x}addToSet(m){let x,M=!1;for(let A=0;A<m.length;A++){let L=m[A];if(this.eq(L))return m;if(this.type.excludes(L.type))x||(x=m.slice(0,A));else{if(L.type.excludes(this.type))return m;!M&&L.type.rank>this.type.rank&&(x||(x=m.slice(0,A)),x.push(this),M=!0),x&&x.push(L)}}return x||(x=m.slice()),M||x.push(this),x}removeFromSet(m){for(let x=0;x<m.length;x++)if(this.eq(m[x]))return m.slice(0,x).concat(m.slice(x+1));return m}isInSet(m){for(let x=0;x<m.length;x++)if(this.eq(m[x]))return!0;return!1}eq(m){return this==m||this.type==m.type&&Ae(this.attrs,m.attrs)}toJSON(){let m={type:this.type.name};for(let x in this.attrs){m.attrs=this.attrs;break}return m}static fromJSON(m,x){if(!x)throw new RangeError("Invalid input for Mark.fromJSON");let M=m.marks[x.type];if(!M)throw new RangeError(`There is no mark type ${x.type} in this schema`);return M.create(x.attrs)}static sameSet(m,x){if(m==x)return!0;if(m.length!=x.length)return!1;for(let M=0;M<m.length;M++)if(!m[M].eq(x[M]))return!1;return!0}static setFrom(m){if(!m||Array.isArray(m)&&0==m.length)return R.none;if(m instanceof R)return[m];let x=m.slice();return x.sort((M,A)=>M.type.rank-A.type.rank),x}}return R.none=[],R})();class Ie extends Error{}class Se{constructor(d,m,x){this.content=d,this.openStart=m,this.openEnd=x}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(d,m){let x=rt(this.content,d+this.openStart,m);return x&&new Se(x,this.openStart,this.openEnd)}removeBetween(d,m){return new Se(Me(this.content,d+this.openStart,m+this.openStart),this.openStart,this.openEnd)}eq(d){return this.content.eq(d.content)&&this.openStart==d.openStart&&this.openEnd==d.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let d={content:this.content.toJSON()};return this.openStart>0&&(d.openStart=this.openStart),this.openEnd>0&&(d.openEnd=this.openEnd),d}static fromJSON(d,m){if(!m)return Se.empty;let x=m.openStart||0,M=m.openEnd||0;if("number"!=typeof x||"number"!=typeof M)throw new RangeError("Invalid input for Slice.fromJSON");return new Se(ne.fromJSON(d,m.content),x,M)}static maxOpen(d,m=!0){let x=0,M=0;for(let A=d.firstChild;A&&!A.isLeaf&&(m||!A.type.spec.isolating);A=A.firstChild)x++;for(let A=d.lastChild;A&&!A.isLeaf&&(m||!A.type.spec.isolating);A=A.lastChild)M++;return new Se(d,x,M)}}function Me(R,d,m){let{index:x,offset:M}=R.findIndex(d),A=R.maybeChild(x),{index:L,offset:W}=R.findIndex(m);if(M==d||A.isText){if(W!=m&&!R.child(L).isText)throw new RangeError("Removing non-flat range");return R.cut(0,d).append(R.cut(m))}if(x!=L)throw new RangeError("Removing non-flat range");return R.replaceChild(x,A.copy(Me(A.content,d-M-1,m-M-1)))}function rt(R,d,m,x){let{index:M,offset:A}=R.findIndex(d),L=R.maybeChild(M);if(A==d||L.isText)return x&&!x.canReplace(M,M,m)?null:R.cut(0,d).append(m).append(R.cut(d));let W=rt(L.content,d-A-1,m);return W&&R.replaceChild(M,L.copy(W))}function ze(R,d,m){if(m.openStart>R.depth)throw new Ie("Inserted content deeper than insertion position");if(R.depth-m.openStart!=d.depth-m.openEnd)throw new Ie("Inconsistent open depths");return me(R,d,m,0)}function me(R,d,m,x){let M=R.index(x),A=R.node(x);if(M==d.index(x)&&x<R.depth-m.openStart){let L=me(R,d,m,x+1);return A.copy(A.content.replaceChild(M,L))}if(m.content.size){if(m.openStart||m.openEnd||R.depth!=x||d.depth!=x){let{start:L,end:W}=function $e(R,d){let m=d.depth-R.openStart,M=d.node(m).copy(R.content);for(let A=m-1;A>=0;A--)M=d.node(A).copy(ne.from(M));return{start:M.resolveNoCache(R.openStart+m),end:M.resolveNoCache(M.content.size-R.openEnd-m)}}(m,R);return De(A,je(R,L,W,d,x))}{let L=R.parent,W=L.content;return De(L,W.cut(0,R.parentOffset).append(m.content).append(W.cut(d.parentOffset)))}}return De(A,Ee(R,d,x))}function xe(R,d){if(!d.type.compatibleContent(R.type))throw new Ie("Cannot join "+d.type.name+" onto "+R.type.name)}function Ce(R,d,m){let x=R.node(m);return xe(x,d.node(m)),x}function ke(R,d){let m=d.length-1;m>=0&&R.isText&&R.sameMarkup(d[m])?d[m]=R.withText(d[m].text+R.text):d.push(R)}function Oe(R,d,m,x){let M=(d||R).node(m),A=0,L=d?d.index(m):M.childCount;R&&(A=R.index(m),R.depth>m?A++:R.textOffset&&(ke(R.nodeAfter,x),A++));for(let W=A;W<L;W++)ke(M.child(W),x);d&&d.depth==m&&d.textOffset&&ke(d.nodeBefore,x)}function De(R,d){return R.type.checkContent(d),R.copy(d)}function je(R,d,m,x,M){let A=R.depth>M&&Ce(R,d,M+1),L=x.depth>M&&Ce(m,x,M+1),W=[];return Oe(null,R,M,W),A&&L&&d.index(M)==m.index(M)?(xe(A,L),ke(De(A,je(R,d,m,x,M+1)),W)):(A&&ke(De(A,Ee(R,d,M+1)),W),Oe(d,m,M,W),L&&ke(De(L,Ee(m,x,M+1)),W)),Oe(x,null,M,W),new ne(W)}function Ee(R,d,m){let x=[];return Oe(null,R,m,x),R.depth>m&&ke(De(Ce(R,d,m+1),Ee(R,d,m+1)),x),Oe(d,null,m,x),new ne(x)}Se.empty=new Se(ne.empty,0,0);class Fe{constructor(d,m,x){this.pos=d,this.path=m,this.parentOffset=x,this.depth=m.length/3-1}resolveDepth(d){return null==d?this.depth:d<0?this.depth+d:d}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(d){return this.path[3*this.resolveDepth(d)]}index(d){return this.path[3*this.resolveDepth(d)+1]}indexAfter(d){return d=this.resolveDepth(d),this.index(d)+(d!=this.depth||this.textOffset?1:0)}start(d){return 0==(d=this.resolveDepth(d))?0:this.path[3*d-1]+1}end(d){return d=this.resolveDepth(d),this.start(d)+this.node(d).content.size}before(d){if(!(d=this.resolveDepth(d)))throw new RangeError("There is no position before the top-level node");return d==this.depth+1?this.pos:this.path[3*d-1]}after(d){if(!(d=this.resolveDepth(d)))throw new RangeError("There is no position after the top-level node");return d==this.depth+1?this.pos:this.path[3*d-1]+this.path[3*d].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let d=this.parent,m=this.index(this.depth);if(m==d.childCount)return null;let x=this.pos-this.path[this.path.length-1],M=d.child(m);return x?d.child(m).cut(x):M}get nodeBefore(){let d=this.index(this.depth),m=this.pos-this.path[this.path.length-1];return m?this.parent.child(d).cut(0,m):0==d?null:this.parent.child(d-1)}posAtIndex(d,m){m=this.resolveDepth(m);let x=this.path[3*m],M=0==m?0:this.path[3*m-1]+1;for(let A=0;A<d;A++)M+=x.child(A).nodeSize;return M}marks(){let d=this.parent,m=this.index();if(0==d.content.size)return C.none;if(this.textOffset)return d.child(m).marks;let x=d.maybeChild(m-1),M=d.maybeChild(m);if(!x){let W=x;x=M,M=W}let A=x.marks;for(var L=0;L<A.length;L++)!1===A[L].type.spec.inclusive&&(!M||!A[L].isInSet(M.marks))&&(A=A[L--].removeFromSet(A));return A}marksAcross(d){let m=this.parent.maybeChild(this.index());if(!m||!m.isInline)return null;let x=m.marks,M=d.parent.maybeChild(d.index());for(var A=0;A<x.length;A++)!1===x[A].type.spec.inclusive&&(!M||!x[A].isInSet(M.marks))&&(x=x[A--].removeFromSet(x));return x}sharedDepth(d){for(let m=this.depth;m>0;m--)if(this.start(m)<=d&&this.end(m)>=d)return m;return 0}blockRange(d=this,m){if(d.pos<this.pos)return d.blockRange(this);for(let x=this.depth-(this.parent.inlineContent||this.pos==d.pos?1:0);x>=0;x--)if(d.pos<=this.end(x)&&(!m||m(this.node(x))))return new We(this,d,x);return null}sameParent(d){return this.pos-this.parentOffset==d.pos-d.parentOffset}max(d){return d.pos>this.pos?d:this}min(d){return d.pos<this.pos?d:this}toString(){let d="";for(let m=1;m<=this.depth;m++)d+=(d?"/":"")+this.node(m).type.name+"_"+this.index(m-1);return d+":"+this.parentOffset}static resolve(d,m){if(!(m>=0&&m<=d.content.size))throw new RangeError("Position "+m+" out of range");let x=[],M=0,A=m;for(let L=d;;){let{index:W,offset:q}=L.content.findIndex(A),pe=A-q;if(x.push(L,W,M+q),!pe||(L=L.child(W),L.isText))break;A=pe-1,M+=q+1}return new Fe(m,x,A)}static resolveCached(d,m){for(let M=0;M<st.length;M++){let A=st[M];if(A.pos==m&&A.doc==d)return A}let x=st[qe]=Fe.resolve(d,m);return qe=(qe+1)%at,x}}let st=[],qe=0,at=12;class We{constructor(d,m,x){this.$from=d,this.$to=m,this.depth=x}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const Cn=Object.create(null);class de{constructor(d,m,x,M=C.none){this.type=d,this.attrs=m,this.marks=M,this.content=x||ne.empty}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(d){return this.content.child(d)}maybeChild(d){return this.content.maybeChild(d)}forEach(d){this.content.forEach(d)}nodesBetween(d,m,x,M=0){this.content.nodesBetween(d,m,x,M,this)}descendants(d){this.nodesBetween(0,this.content.size,d)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(d,m,x,M){return this.content.textBetween(d,m,x,M)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(d){return this==d||this.sameMarkup(d)&&this.content.eq(d.content)}sameMarkup(d){return this.hasMarkup(d.type,d.attrs,d.marks)}hasMarkup(d,m,x){return this.type==d&&Ae(this.attrs,m||d.defaultAttrs||Cn)&&C.sameSet(this.marks,x||C.none)}copy(d=null){return d==this.content?this:new de(this.type,this.attrs,d,this.marks)}mark(d){return d==this.marks?this:new de(this.type,this.attrs,this.content,d)}cut(d,m=this.content.size){return 0==d&&m==this.content.size?this:this.copy(this.content.cut(d,m))}slice(d,m=this.content.size,x=!1){if(d==m)return Se.empty;let M=this.resolve(d),A=this.resolve(m),L=x?0:M.sharedDepth(m),W=M.start(L),pe=M.node(L).content.cut(M.pos-W,A.pos-W);return new Se(pe,M.depth-L,A.depth-L)}replace(d,m,x){return ze(this.resolve(d),this.resolve(m),x)}nodeAt(d){for(let m=this;;){let{index:x,offset:M}=m.content.findIndex(d);if(m=m.maybeChild(x),!m)return null;if(M==d||m.isText)return m;d-=M+1}}childAfter(d){let{index:m,offset:x}=this.content.findIndex(d);return{node:this.content.maybeChild(m),index:m,offset:x}}childBefore(d){if(0==d)return{node:null,index:0,offset:0};let{index:m,offset:x}=this.content.findIndex(d);if(x<d)return{node:this.content.child(m),index:m,offset:x};let M=this.content.child(m-1);return{node:M,index:m-1,offset:x-M.nodeSize}}resolve(d){return Fe.resolveCached(this,d)}resolveNoCache(d){return Fe.resolve(this,d)}rangeHasMark(d,m,x){let M=!1;return m>d&&this.nodesBetween(d,m,A=>(x.isInSet(A.marks)&&(M=!0),!M)),M}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let d=this.type.name;return this.content.size&&(d+="("+this.content.toStringInner()+")"),G(this.marks,d)}contentMatchAt(d){let m=this.type.contentMatch.matchFragment(this.content,0,d);if(!m)throw new Error("Called contentMatchAt on a node with invalid content");return m}canReplace(d,m,x=ne.empty,M=0,A=x.childCount){let L=this.contentMatchAt(d).matchFragment(x,M,A),W=L&&L.matchFragment(this.content,m);if(!W||!W.validEnd)return!1;for(let q=M;q<A;q++)if(!this.type.allowsMarks(x.child(q).marks))return!1;return!0}canReplaceWith(d,m,x,M){if(M&&!this.type.allowsMarks(M))return!1;let A=this.contentMatchAt(d).matchType(x),L=A&&A.matchFragment(this.content,m);return!!L&&L.validEnd}canAppend(d){return d.content.size?this.canReplace(this.childCount,this.childCount,d.content):this.type.compatibleContent(d.type)}check(){this.type.checkContent(this.content);let d=C.none;for(let m=0;m<this.marks.length;m++)d=this.marks[m].addToSet(d);if(!C.sameSet(d,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(m=>m.type.name)}`);this.content.forEach(m=>m.check())}toJSON(){let d={type:this.type.name};for(let m in this.attrs){d.attrs=this.attrs;break}return this.content.size&&(d.content=this.content.toJSON()),this.marks.length&&(d.marks=this.marks.map(m=>m.toJSON())),d}static fromJSON(d,m){if(!m)throw new RangeError("Invalid input for Node.fromJSON");let x=null;if(m.marks){if(!Array.isArray(m.marks))throw new RangeError("Invalid mark data for Node.fromJSON");x=m.marks.map(d.markFromJSON)}if("text"==m.type){if("string"!=typeof m.text)throw new RangeError("Invalid text node in JSON");return d.text(m.text,x)}let M=ne.fromJSON(d,m.content);return d.nodeType(m.type).create(m.attrs,M,x)}}de.prototype.text=void 0;class B extends de{constructor(d,m,x,M){if(super(d,m,null,M),!x)throw new RangeError("Empty text nodes are not allowed");this.text=x}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):G(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(d,m){return this.text.slice(d,m)}get nodeSize(){return this.text.length}mark(d){return d==this.marks?this:new B(this.type,this.attrs,this.text,d)}withText(d){return d==this.text?this:new B(this.type,this.attrs,d,this.marks)}cut(d=0,m=this.text.length){return 0==d&&m==this.text.length?this:this.withText(this.text.slice(d,m))}eq(d){return this.sameMarkup(d)&&this.text==d.text}toJSON(){let d=super.toJSON();return d.text=this.text,d}}function G(R,d){for(let m=R.length-1;m>=0;m--)d=R[m].type.name+"("+d+")";return d}class ee{constructor(d){this.validEnd=d,this.next=[],this.wrapCache=[]}static parse(d,m){let x=new se(d,m);if(null==x.next)return ee.empty;let M=he(x);x.next&&x.err("Unexpected trailing text");let A=function At(R){let d=Object.create(null);return function m(x){let M=[];x.forEach(L=>{R[L].forEach(({term:W,to:q})=>{if(!W)return;let pe;for(let ge=0;ge<M.length;ge++)M[ge][0]==W&&(pe=M[ge][1]);zt(R,q).forEach(ge=>{pe||M.push([W,pe=[]]),-1==pe.indexOf(ge)&&pe.push(ge)})})});let A=d[x.join(",")]=new ee(x.indexOf(R.length-1)>-1);for(let L=0;L<M.length;L++){let W=M[L][1].sort(Wt);A.next.push({type:M[L][0],next:d[W.join(",")]||m(W)})}return A}(zt(R,0))}(function qt(R){let d=[[]];return M(function A(L,W){if("choice"==L.type)return L.exprs.reduce((q,pe)=>q.concat(A(pe,W)),[]);if("seq"!=L.type){if("star"==L.type){let q=m();return x(W,q),M(A(L.expr,q),q),[x(q)]}if("plus"==L.type){let q=m();return M(A(L.expr,W),q),M(A(L.expr,q),q),[x(q)]}if("opt"==L.type)return[x(W)].concat(A(L.expr,W));if("range"==L.type){let q=W;for(let pe=0;pe<L.min;pe++){let ge=m();M(A(L.expr,q),ge),q=ge}if(-1==L.max)M(A(L.expr,q),q);else for(let pe=L.min;pe<L.max;pe++){let ge=m();x(q,ge),M(A(L.expr,q),ge),q=ge}return[x(q)]}if("name"==L.type)return[x(W,void 0,L.value)];throw new Error("Unknown expr type")}for(let q=0;;q++){let pe=A(L.exprs[q],W);if(q==L.exprs.length-1)return pe;M(pe,W=m())}}(R,0),m()),d;function m(){return d.push([])-1}function x(L,W,q){let pe={term:q,to:W};return d[L].push(pe),pe}function M(L,W){L.forEach(q=>q.to=W)}}(M));return function Ct(R,d){for(let m=0,x=[R];m<x.length;m++){let M=x[m],A=!M.validEnd,L=[];for(let W=0;W<M.next.length;W++){let{type:q,next:pe}=M.next[W];L.push(q.name),A&&!(q.isText||q.hasRequiredAttrs())&&(A=!1),-1==x.indexOf(pe)&&x.push(pe)}A&&d.err("Only non-generatable nodes ("+L.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}(A,x),A}matchType(d){for(let m=0;m<this.next.length;m++)if(this.next[m].type==d)return this.next[m].next;return null}matchFragment(d,m=0,x=d.childCount){let M=this;for(let A=m;M&&A<x;A++)M=M.matchType(d.child(A).type);return M}get inlineContent(){return 0!=this.next.length&&this.next[0].type.isInline}get defaultType(){for(let d=0;d<this.next.length;d++){let{type:m}=this.next[d];if(!m.isText&&!m.hasRequiredAttrs())return m}return null}compatible(d){for(let m=0;m<this.next.length;m++)for(let x=0;x<d.next.length;x++)if(this.next[m].type==d.next[x].type)return!0;return!1}fillBefore(d,m=!1,x=0){let M=[this];return function A(L,W){let q=L.matchFragment(d,x);if(q&&(!m||q.validEnd))return ne.from(W.map(pe=>pe.createAndFill()));for(let pe=0;pe<L.next.length;pe++){let{type:ge,next:Ge}=L.next[pe];if(!ge.isText&&!ge.hasRequiredAttrs()&&-1==M.indexOf(Ge)){M.push(Ge);let mn=A(Ge,W.concat(ge));if(mn)return mn}}return null}(this,[])}findWrapping(d){for(let x=0;x<this.wrapCache.length;x+=2)if(this.wrapCache[x]==d)return this.wrapCache[x+1];let m=this.computeWrapping(d);return this.wrapCache.push(d,m),m}computeWrapping(d){let m=Object.create(null),x=[{match:this,type:null,via:null}];for(;x.length;){let M=x.shift(),A=M.match;if(A.matchType(d)){let L=[];for(let W=M;W.type;W=W.via)L.push(W.type);return L.reverse()}for(let L=0;L<A.next.length;L++){let{type:W,next:q}=A.next[L];!W.isLeaf&&!W.hasRequiredAttrs()&&!(W.name in m)&&(!M.type||q.validEnd)&&(x.push({match:W.contentMatch,type:W,via:M}),m[W.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(d){if(d>=this.next.length)throw new RangeError(`There's no ${d}th edge in this content match`);return this.next[d]}toString(){let d=[];return function m(x){d.push(x);for(let M=0;M<x.next.length;M++)-1==d.indexOf(x.next[M].next)&&m(x.next[M].next)}(this),d.map((x,M)=>{let A=M+(x.validEnd?"*":" ")+" ";for(let L=0;L<x.next.length;L++)A+=(L?", ":"")+x.next[L].type.name+"->"+d.indexOf(x.next[L].next);return A}).join("\n")}}ee.empty=new ee(!0);class se{constructor(d,m){this.string=d,this.nodeTypes=m,this.inline=null,this.pos=0,this.tokens=d.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(d){return this.next==d&&(this.pos++||!0)}err(d){throw new SyntaxError(d+" (in content expression '"+this.string+"')")}}function he(R){let d=[];do{d.push(ve(R))}while(R.eat("|"));return 1==d.length?d[0]:{type:"choice",exprs:d}}function ve(R){let d=[];do{d.push(He(R))}while(R.next&&")"!=R.next&&"|"!=R.next);return 1==d.length?d[0]:{type:"seq",exprs:d}}function He(R){let d=function kt(R){if(R.eat("(")){let d=he(R);return R.eat(")")||R.err("Missing closing paren"),d}if(!/\W/.test(R.next)){let d=function Xe(R,d){let m=R.nodeTypes,x=m[d];if(x)return[x];let M=[];for(let A in m){let L=m[A];L.groups.indexOf(d)>-1&&M.push(L)}return 0==M.length&&R.err("No node type or group '"+d+"' found"),M}(R,R.next).map(m=>(null==R.inline?R.inline=m.isInline:R.inline!=m.isInline&&R.err("Mixing inline and block content"),{type:"name",value:m}));return R.pos++,1==d.length?d[0]:{type:"choice",exprs:d}}R.err("Unexpected token '"+R.next+"'")}(R);for(;;)if(R.eat("+"))d={type:"plus",expr:d};else if(R.eat("*"))d={type:"star",expr:d};else if(R.eat("?"))d={type:"opt",expr:d};else{if(!R.eat("{"))break;d=ot(R,d)}return d}function Pe(R){/\D/.test(R.next)&&R.err("Expected number, got '"+R.next+"'");let d=Number(R.next);return R.pos++,d}function ot(R,d){let m=Pe(R),x=m;return R.eat(",")&&(x="}"!=R.next?Pe(R):-1),R.eat("}")||R.err("Unclosed braced range"),{type:"range",min:m,max:x,expr:d}}function Wt(R,d){return d-R}function zt(R,d){let m=[];return function x(M){let A=R[M];if(1==A.length&&!A[0].term)return x(A[0].to);m.push(M);for(let L=0;L<A.length;L++){let{term:W,to:q}=A[L];!W&&-1==m.indexOf(q)&&x(q)}}(d),m.sort(Wt)}function Jt(R){let d=Object.create(null);for(let m in R){let x=R[m];if(!x.hasDefault)return null;d[m]=x.default}return d}function Xt(R,d){let m=Object.create(null);for(let x in R){let M=d&&d[x];if(void 0===M){let A=R[x];if(!A.hasDefault)throw new RangeError("No value supplied for attribute "+x);M=A.default}m[x]=M}return m}function hn(R){let d=Object.create(null);if(R)for(let m in R)d[m]=new Kt(R[m]);return d}class It{constructor(d,m,x){this.name=d,this.schema=m,this.spec=x,this.markSet=null,this.groups=x.group?x.group.split(" "):[],this.attrs=hn(x.attrs),this.defaultAttrs=Jt(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(x.inline||"text"==d),this.isText="text"==d}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==ee.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let d in this.attrs)if(this.attrs[d].isRequired)return!0;return!1}compatibleContent(d){return this==d||this.contentMatch.compatible(d.contentMatch)}computeAttrs(d){return!d&&this.defaultAttrs?this.defaultAttrs:Xt(this.attrs,d)}create(d=null,m,x){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new de(this,this.computeAttrs(d),ne.from(m),C.setFrom(x))}createChecked(d=null,m,x){return m=ne.from(m),this.checkContent(m),new de(this,this.computeAttrs(d),m,C.setFrom(x))}createAndFill(d=null,m,x){if(d=this.computeAttrs(d),(m=ne.from(m)).size){let L=this.contentMatch.fillBefore(m);if(!L)return null;m=L.append(m)}let M=this.contentMatch.matchFragment(m),A=M&&M.fillBefore(ne.empty,!0);return A?new de(this,d,m.append(A),C.setFrom(x)):null}validContent(d){let m=this.contentMatch.matchFragment(d);if(!m||!m.validEnd)return!1;for(let x=0;x<d.childCount;x++)if(!this.allowsMarks(d.child(x).marks))return!1;return!0}checkContent(d){if(!this.validContent(d))throw new RangeError(`Invalid content for node ${this.name}: ${d.toString().slice(0,50)}`)}allowsMarkType(d){return null==this.markSet||this.markSet.indexOf(d)>-1}allowsMarks(d){if(null==this.markSet)return!0;for(let m=0;m<d.length;m++)if(!this.allowsMarkType(d[m].type))return!1;return!0}allowedMarks(d){if(null==this.markSet)return d;let m;for(let x=0;x<d.length;x++)this.allowsMarkType(d[x].type)?m&&m.push(d[x]):m||(m=d.slice(0,x));return m?m.length?m:C.none:d}static compile(d,m){let x=Object.create(null);d.forEach((A,L)=>x[A]=new It(A,m,L));let M=m.spec.topNode||"doc";if(!x[M])throw new RangeError("Schema is missing its top node type ('"+M+"')");if(!x.text)throw new RangeError("Every schema needs a 'text' type");for(let A in x.text.attrs)throw new RangeError("The text node type should not have attributes");return x}}class Kt{constructor(d){this.hasDefault=Object.prototype.hasOwnProperty.call(d,"default"),this.default=d.default}get isRequired(){return!this.hasDefault}}class Yt{constructor(d,m,x,M){this.name=d,this.rank=m,this.schema=x,this.spec=M,this.attrs=hn(M.attrs),this.excluded=null;let A=Jt(this.attrs);this.instance=A?new C(this,A):null}create(d=null){return!d&&this.instance?this.instance:new C(this,Xt(this.attrs,d))}static compile(d,m){let x=Object.create(null),M=0;return d.forEach((A,L)=>x[A]=new Yt(A,M++,m,L)),x}removeFromSet(d){for(var m=0;m<d.length;m++)d[m].type==this&&(d=d.slice(0,m).concat(d.slice(m+1)),m--);return d}isInSet(d){for(let m=0;m<d.length;m++)if(d[m].type==this)return d[m]}excludes(d){return this.excluded.indexOf(d)>-1}}class bn{constructor(d){this.cached=Object.create(null);let m=this.spec={};for(let M in d)m[M]=d[M];m.nodes=Te.from(d.nodes),m.marks=Te.from(d.marks||{}),this.nodes=It.compile(this.spec.nodes,this),this.marks=Yt.compile(this.spec.marks,this);let x=Object.create(null);for(let M in this.nodes){if(M in this.marks)throw new RangeError(M+" can not be both a node and a mark");let A=this.nodes[M],L=A.spec.content||"",W=A.spec.marks;A.contentMatch=x[L]||(x[L]=ee.parse(L,this.nodes)),A.inlineContent=A.contentMatch.inlineContent,A.markSet="_"==W?null:W?en(this,W.split(" ")):""!=W&&A.inlineContent?null:[]}for(let M in this.marks){let A=this.marks[M],L=A.spec.excludes;A.excluded=null==L?[A]:""==L?[]:en(this,L.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(d,m=null,x,M){if("string"==typeof d)d=this.nodeType(d);else{if(!(d instanceof It))throw new RangeError("Invalid node type: "+d);if(d.schema!=this)throw new RangeError("Node type from different schema used ("+d.name+")")}return d.createChecked(m,x,M)}text(d,m){let x=this.nodes.text;return new B(x,x.defaultAttrs,d,C.setFrom(m))}mark(d,m){return"string"==typeof d&&(d=this.marks[d]),d.create(m)}nodeFromJSON(d){return de.fromJSON(this,d)}markFromJSON(d){return C.fromJSON(this,d)}nodeType(d){let m=this.nodes[d];if(!m)throw new RangeError("Unknown node type: "+d);return m}}function en(R,d){let m=[];for(let x=0;x<d.length;x++){let M=d[x],A=R.marks[M],L=A;if(A)m.push(A);else for(let W in R.marks){let q=R.marks[W];("_"==M||q.spec.group&&q.spec.group.split(" ").indexOf(M)>-1)&&m.push(L=q)}if(!L)throw new SyntaxError("Unknown mark type: '"+d[x]+"'")}return m}class Gt{constructor(d,m){this.schema=d,this.rules=m,this.tags=[],this.styles=[],m.forEach(x=>{x.tag?this.tags.push(x):x.style&&this.styles.push(x)}),this.normalizeLists=!this.tags.some(x=>{if(!/^(ul|ol)\b/.test(x.tag)||!x.node)return!1;let M=d.nodes[x.node];return M.contentMatch.matchType(M)})}parse(d,m={}){let x=new Rt(this,m,!1);return x.addAll(d,m.from,m.to),x.finish()}parseSlice(d,m={}){let x=new Rt(this,m,!0);return x.addAll(d,m.from,m.to),Se.maxOpen(x.finish())}matchTag(d,m,x){for(let M=x?this.tags.indexOf(x)+1:0;M<this.tags.length;M++){let A=this.tags[M];if(K(d,A.tag)&&(void 0===A.namespace||d.namespaceURI==A.namespace)&&(!A.context||m.matchesContext(A.context))){if(A.getAttrs){let L=A.getAttrs(d);if(!1===L)continue;A.attrs=L||void 0}return A}}}matchStyle(d,m,x,M){for(let A=M?this.styles.indexOf(M)+1:0;A<this.styles.length;A++){let L=this.styles[A],W=L.style;if(!(0!=W.indexOf(d)||L.context&&!x.matchesContext(L.context)||W.length>d.length&&(61!=W.charCodeAt(d.length)||W.slice(d.length+1)!=m))){if(L.getAttrs){let q=L.getAttrs(m);if(!1===q)continue;L.attrs=q||void 0}return L}}}static schemaRules(d){let m=[];function x(M){let A=null==M.priority?50:M.priority,L=0;for(;L<m.length;L++){let W=m[L];if((null==W.priority?50:W.priority)<A)break}m.splice(L,0,M)}for(let M in d.marks){let A=d.marks[M].spec.parseDOM;A&&A.forEach(L=>{x(L=k(L)),L.mark||L.ignore||L.clearMark||(L.mark=M)})}for(let M in d.nodes){let A=d.nodes[M].spec.parseDOM;A&&A.forEach(L=>{x(L=k(L)),L.node||L.ignore||L.mark||(L.node=M)})}return m}static fromSchema(d){return d.cached.domParser||(d.cached.domParser=new Gt(d,Gt.schemaRules(d)))}}const mt={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},qn={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},tn={ol:!0,ul:!0};function Pt(R,d,m){return null!=d?(d?1:0)|("full"===d?2:0):R&&"pre"==R.whitespace?3:-5&m}class St{constructor(d,m,x,M,A,L,W){this.type=d,this.attrs=m,this.marks=x,this.pendingMarks=M,this.solid=A,this.options=W,this.content=[],this.activeMarks=C.none,this.stashMarks=[],this.match=L||(4&W?null:d.contentMatch)}findWrapping(d){if(!this.match){if(!this.type)return[];let m=this.type.contentMatch.fillBefore(ne.from(d));if(!m){let M,x=this.type.contentMatch;return(M=x.findWrapping(d.type))?(this.match=x,M):null}this.match=this.type.contentMatch.matchFragment(m)}return this.match.findWrapping(d.type)}finish(d){if(!(1&this.options)){let M,x=this.content[this.content.length-1];if(x&&x.isText&&(M=/[ \t\r\n\u000c]+$/.exec(x.text))){let A=x;x.text.length==M[0].length?this.content.pop():this.content[this.content.length-1]=A.withText(A.text.slice(0,A.text.length-M[0].length))}}let m=ne.from(this.content);return!d&&this.match&&(m=m.append(this.match.fillBefore(ne.empty,!0))),this.type?this.type.create(this.attrs,m,this.marks):m}popFromStashMark(d){for(let m=this.stashMarks.length-1;m>=0;m--)if(d.eq(this.stashMarks[m]))return this.stashMarks.splice(m,1)[0]}applyPending(d){for(let m=0,x=this.pendingMarks;m<x.length;m++){let M=x[m];(this.type?this.type.allowsMarkType(M.type):P(M.type,d))&&!M.isInSet(this.activeMarks)&&(this.activeMarks=M.addToSet(this.activeMarks),this.pendingMarks=M.removeFromSet(this.pendingMarks))}}inlineContext(d){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:d.parentNode&&!mt.hasOwnProperty(d.parentNode.nodeName.toLowerCase())}}class Rt{constructor(d,m,x){this.parser=d,this.options=m,this.isOpen=x,this.open=0;let A,M=m.topNode,L=Pt(null,m.preserveWhitespace,0)|(x?4:0);A=M?new St(M.type,M.attrs,C.none,C.none,!0,m.topMatch||M.type.contentMatch,L):new St(x?null:d.schema.topNodeType,null,C.none,C.none,!0,null,L),this.nodes=[A],this.find=m.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(d){3==d.nodeType?this.addTextNode(d):1==d.nodeType&&this.addElement(d)}withStyleRules(d,m){let x=d.getAttribute("style");if(!x)return m();let M=this.readStyles(function w(R){let m,d=/\s*([\w-]+)\s*:\s*([^;]+)/g,x=[];for(;m=d.exec(R);)x.push(m[1],m[2].trim());return x}(x));if(!M)return;let[A,L]=M,W=this.top;for(let q=0;q<L.length;q++)this.removePendingMark(L[q],W);for(let q=0;q<A.length;q++)this.addPendingMark(A[q]);m();for(let q=0;q<A.length;q++)this.removePendingMark(A[q],W);for(let q=0;q<L.length;q++)this.addPendingMark(L[q])}addTextNode(d){let m=d.nodeValue,x=this.top;if(2&x.options||x.inlineContext(d)||/[^ \t\r\n\u000c]/.test(m)){if(1&x.options)m=2&x.options?m.replace(/\r\n?/g,"\n"):m.replace(/\r?\n|\r/g," ");else if(m=m.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(m)&&this.open==this.nodes.length-1){let M=x.content[x.content.length-1],A=d.previousSibling;(!M||A&&"BR"==A.nodeName||M.isText&&/[ \t\r\n\u000c]$/.test(M.text))&&(m=m.slice(1))}m&&this.insertNode(this.parser.schema.text(m)),this.findInText(d)}else this.findInside(d)}addElement(d,m){let M,x=d.nodeName.toLowerCase();tn.hasOwnProperty(x)&&this.parser.normalizeLists&&function $t(R){for(let d=R.firstChild,m=null;d;d=d.nextSibling){let x=1==d.nodeType?d.nodeName.toLowerCase():null;x&&tn.hasOwnProperty(x)&&m?(m.appendChild(d),d=m):"li"==x?m=d:x&&(m=null)}}(d);let A=this.options.ruleFromNode&&this.options.ruleFromNode(d)||(M=this.parser.matchTag(d,this,m));if(A?A.ignore:qn.hasOwnProperty(x))this.findInside(d),this.ignoreFallback(d);else if(!A||A.skip||A.closeParent){A&&A.closeParent?this.open=Math.max(0,this.open-1):A&&A.skip.nodeType&&(d=A.skip);let L,W=this.top,q=this.needsBlock;if(mt.hasOwnProperty(x))W.content.length&&W.content[0].isInline&&this.open&&(this.open--,W=this.top),L=!0,W.type||(this.needsBlock=!0);else if(!d.firstChild)return void this.leafFallback(d);A&&A.skip?this.addAll(d):this.withStyleRules(d,()=>this.addAll(d)),L&&this.sync(W),this.needsBlock=q}else this.withStyleRules(d,()=>{this.addElementByRule(d,A,!1===A.consuming?M:void 0)})}leafFallback(d){"BR"==d.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(d.ownerDocument.createTextNode("\n"))}ignoreFallback(d){"BR"==d.nodeName&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"))}readStyles(d){let m=C.none,x=C.none;for(let M=0;M<d.length;M+=2)for(let A;;){let L=this.parser.matchStyle(d[M],d[M+1],this,A);if(!L)break;if(L.ignore)return null;if(L.clearMark?this.top.pendingMarks.concat(this.top.activeMarks).forEach(W=>{L.clearMark(W)&&(x=W.addToSet(x))}):m=this.parser.schema.marks[L.mark].create(L.attrs).addToSet(m),!1!==L.consuming)break;A=L}return[m,x]}addElementByRule(d,m,x){let M,A,L;m.node?(A=this.parser.schema.nodes[m.node],A.isLeaf?this.insertNode(A.create(m.attrs))||this.leafFallback(d):M=this.enter(A,m.attrs||null,m.preserveWhitespace)):(L=this.parser.schema.marks[m.mark].create(m.attrs),this.addPendingMark(L));let W=this.top;if(A&&A.isLeaf)this.findInside(d);else if(x)this.addElement(d,x);else if(m.getContent)this.findInside(d),m.getContent(d,this.parser.schema).forEach(q=>this.insertNode(q));else{let q=d;"string"==typeof m.contentElement?q=d.querySelector(m.contentElement):"function"==typeof m.contentElement?q=m.contentElement(d):m.contentElement&&(q=m.contentElement),this.findAround(d,q,!0),this.addAll(q)}M&&this.sync(W)&&this.open--,L&&this.removePendingMark(L,W)}addAll(d,m,x){let M=m||0;for(let A=m?d.childNodes[m]:d.firstChild,L=null==x?null:d.childNodes[x];A!=L;A=A.nextSibling,++M)this.findAtPoint(d,M),this.addDOM(A);this.findAtPoint(d,M)}findPlace(d){let m,x;for(let M=this.open;M>=0;M--){let A=this.nodes[M],L=A.findWrapping(d);if(L&&(!m||m.length>L.length)&&(m=L,x=A,!L.length)||A.solid)break}if(!m)return!1;this.sync(x);for(let M=0;M<m.length;M++)this.enterInner(m[M],null,!1);return!0}insertNode(d){if(d.isInline&&this.needsBlock&&!this.top.type){let m=this.textblockFromContext();m&&this.enterInner(m)}if(this.findPlace(d)){this.closeExtra();let m=this.top;m.applyPending(d.type),m.match&&(m.match=m.match.matchType(d.type));let x=m.activeMarks;for(let M=0;M<d.marks.length;M++)(!m.type||m.type.allowsMarkType(d.marks[M].type))&&(x=d.marks[M].addToSet(x));return m.content.push(d.mark(x)),!0}return!1}enter(d,m,x){let M=this.findPlace(d.create(m));return M&&this.enterInner(d,m,!0,x),M}enterInner(d,m=null,x=!1,M){this.closeExtra();let A=this.top;A.applyPending(d),A.match=A.match&&A.match.matchType(d);let L=Pt(d,M,A.options);4&A.options&&0==A.content.length&&(L|=4),this.nodes.push(new St(d,m,A.activeMarks,A.pendingMarks,x,null,L)),this.open++}closeExtra(d=!1){let m=this.nodes.length-1;if(m>this.open){for(;m>this.open;m--)this.nodes[m-1].content.push(this.nodes[m].finish(d));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)}sync(d){for(let m=this.open;m>=0;m--)if(this.nodes[m]==d)return this.open=m,!0;return!1}get currentPos(){this.closeExtra();let d=0;for(let m=this.open;m>=0;m--){let x=this.nodes[m].content;for(let M=x.length-1;M>=0;M--)d+=x[M].nodeSize;m&&d++}return d}findAtPoint(d,m){if(this.find)for(let x=0;x<this.find.length;x++)this.find[x].node==d&&this.find[x].offset==m&&(this.find[x].pos=this.currentPos)}findInside(d){if(this.find)for(let m=0;m<this.find.length;m++)null==this.find[m].pos&&1==d.nodeType&&d.contains(this.find[m].node)&&(this.find[m].pos=this.currentPos)}findAround(d,m,x){if(d!=m&&this.find)for(let M=0;M<this.find.length;M++)null==this.find[M].pos&&1==d.nodeType&&d.contains(this.find[M].node)&&m.compareDocumentPosition(this.find[M].node)&(x?2:4)&&(this.find[M].pos=this.currentPos)}findInText(d){if(this.find)for(let m=0;m<this.find.length;m++)this.find[m].node==d&&(this.find[m].pos=this.currentPos-(d.nodeValue.length-this.find[m].offset))}matchesContext(d){if(d.indexOf("|")>-1)return d.split(/\s*\|\s*/).some(this.matchesContext,this);let m=d.split("/"),x=this.options.context,M=!(this.isOpen||x&&x.parent.type!=this.nodes[0].type),A=(M?0:1)-(x?x.depth+1:0),L=(W,q)=>{for(;W>=0;W--){let pe=m[W];if(""==pe){if(W==m.length-1||0==W)continue;for(;q>=A;q--)if(L(W-1,q))return!0;return!1}{let ge=q>0||0==q&&M?this.nodes[q].type:x&&q>=A?x.node(q-A).type:null;if(!ge||ge.name!=pe&&-1==ge.groups.indexOf(pe))return!1;q--}}return!0};return L(m.length-1,this.open)}textblockFromContext(){let d=this.options.context;if(d)for(let m=d.depth;m>=0;m--){let x=d.node(m).contentMatchAt(d.indexAfter(m)).defaultType;if(x&&x.isTextblock&&x.defaultAttrs)return x}for(let m in this.parser.schema.nodes){let x=this.parser.schema.nodes[m];if(x.isTextblock&&x.defaultAttrs)return x}}addPendingMark(d){let m=function F(R,d){for(let m=0;m<d.length;m++)if(R.eq(d[m]))return d[m]}(d,this.top.pendingMarks);m&&this.top.stashMarks.push(m),this.top.pendingMarks=d.addToSet(this.top.pendingMarks)}removePendingMark(d,m){for(let x=this.open;x>=0;x--){let M=this.nodes[x];if(M.pendingMarks.lastIndexOf(d)>-1)M.pendingMarks=d.removeFromSet(M.pendingMarks);else{M.activeMarks=d.removeFromSet(M.activeMarks);let L=M.popFromStashMark(d);L&&M.type&&M.type.allowsMarkType(L.type)&&(M.activeMarks=L.addToSet(M.activeMarks))}if(M==m)break}}}function K(R,d){return(R.matches||R.msMatchesSelector||R.webkitMatchesSelector||R.mozMatchesSelector).call(R,d)}function k(R){let d={};for(let m in R)d[m]=R[m];return d}function P(R,d){let m=d.schema.nodes;for(let x in m){let M=m[x];if(!M.allowsMarkType(R))continue;let A=[],L=W=>{A.push(W);for(let q=0;q<W.edgeCount;q++){let{type:pe,next:ge}=W.edge(q);if(pe==d||A.indexOf(ge)<0&&L(ge))return!0}};if(L(M.contentMatch))return!0}}class V{constructor(d,m){this.nodes=d,this.marks=m}serializeFragment(d,m={},x){x||(x=te(m).createDocumentFragment());let M=x,A=[];return d.forEach(L=>{if(A.length||L.marks.length){let W=0,q=0;for(;W<A.length&&q<L.marks.length;){let pe=L.marks[q];if(this.marks[pe.type.name]){if(!pe.eq(A[W][0])||!1===pe.type.spec.spanning)break;W++,q++}else q++}for(;W<A.length;)M=A.pop()[1];for(;q<L.marks.length;){let pe=L.marks[q++],ge=this.serializeMark(pe,L.isInline,m);ge&&(A.push([pe,M]),M.appendChild(ge.dom),M=ge.contentDOM||ge.dom)}}M.appendChild(this.serializeNodeInner(L,m))}),x}serializeNodeInner(d,m){let{dom:x,contentDOM:M}=V.renderSpec(te(m),this.nodes[d.type.name](d));if(M){if(d.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(d.content,m,M)}return x}serializeNode(d,m={}){let x=this.serializeNodeInner(d,m);for(let M=d.marks.length-1;M>=0;M--){let A=this.serializeMark(d.marks[M],d.isInline,m);A&&((A.contentDOM||A.dom).appendChild(x),x=A.dom)}return x}serializeMark(d,m,x={}){let M=this.marks[d.type.name];return M&&V.renderSpec(te(x),M(d,m))}static renderSpec(d,m,x=null){if("string"==typeof m)return{dom:d.createTextNode(m)};if(null!=m.nodeType)return{dom:m};if(m.dom&&null!=m.dom.nodeType)return m;let M=m[0],A=M.indexOf(" ");A>0&&(x=M.slice(0,A),M=M.slice(A+1));let L,W=x?d.createElementNS(x,M):d.createElement(M),q=m[1],pe=1;if(q&&"object"==typeof q&&null==q.nodeType&&!Array.isArray(q)){pe=2;for(let ge in q)if(null!=q[ge]){let Ge=ge.indexOf(" ");Ge>0?W.setAttributeNS(ge.slice(0,Ge),ge.slice(Ge+1),q[ge]):W.setAttribute(ge,q[ge])}}for(let ge=pe;ge<m.length;ge++){let Ge=m[ge];if(0===Ge){if(ge<m.length-1||ge>pe)throw new RangeError("Content hole must be the only child of its parent node");return{dom:W,contentDOM:W}}{let{dom:mn,contentDOM:yn}=V.renderSpec(d,Ge,x);if(W.appendChild(mn),yn){if(L)throw new RangeError("Multiple content holes");L=yn}}}return{dom:W,contentDOM:L}}static fromSchema(d){return d.cached.domSerializer||(d.cached.domSerializer=new V(this.nodesFromSchema(d),this.marksFromSchema(d)))}static nodesFromSchema(d){let m=Z(d.nodes);return m.text||(m.text=x=>x.text),m}static marksFromSchema(d){return Z(d.marks)}}function Z(R){let d={};for(let m in R){let x=R[m].spec.toDOM;x&&(d[m]=x)}return d}function te(R){return R.document||window.document}},7825:(Fn,tt,Q)=>{"use strict";Q.d(tt,{Bs:()=>Ae,C1:()=>Me,H$:()=>Cn,Sy:()=>qe,Y1:()=>le,qv:()=>Ie,xm:()=>ne,yy:()=>Fe});var z=Q(7834),Te=Q(2938);const Ne=Object.create(null);class le{constructor(B,G,ee){this.$anchor=B,this.$head=G,this.ranges=ee||[new ne(B.min(G),B.max(G))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let B=this.ranges;for(let G=0;G<B.length;G++)if(B[G].$from.pos!=B[G].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(B,G=z.p2.empty){let ee=G.content.lastChild,se=null;for(let He=0;He<G.openEnd;He++)se=ee,ee=ee.lastChild;let he=B.steps.length,ve=this.ranges;for(let He=0;He<ve.length;He++){let{$from:Pe,$to:ot}=ve[He],Xe=B.mapping.slice(he);B.replaceRange(Xe.map(Pe.pos),Xe.map(ot.pos),He?z.p2.empty:G),0==He&&me(B,he,(ee?ee.isInline:se&&se.isTextblock)?-1:1)}}replaceWith(B,G){let ee=B.steps.length,se=this.ranges;for(let he=0;he<se.length;he++){let{$from:ve,$to:He}=se[he],Pe=B.mapping.slice(ee),ot=Pe.map(ve.pos),Xe=Pe.map(He.pos);he?B.deleteRange(ot,Xe):(B.replaceRangeWith(ot,Xe,G),me(B,ee,G.isInline?-1:1))}}static findFrom(B,G,ee=!1){let se=B.parent.inlineContent?new Ae(B):ze(B.node(0),B.parent,B.pos,B.index(),G,ee);if(se)return se;for(let he=B.depth-1;he>=0;he--){let ve=G<0?ze(B.node(0),B.node(he),B.before(he+1),B.index(he),G,ee):ze(B.node(0),B.node(he),B.after(he+1),B.index(he)+1,G,ee);if(ve)return ve}return null}static near(B,G=1){return this.findFrom(B,G)||this.findFrom(B,-G)||new Me(B.node(0))}static atStart(B){return ze(B,B,0,0,1)||new Me(B)}static atEnd(B){return ze(B,B,B.content.size,B.childCount,-1)||new Me(B)}static fromJSON(B,G){if(!G||!G.type)throw new RangeError("Invalid input for Selection.fromJSON");let ee=Ne[G.type];if(!ee)throw new RangeError(`No selection type ${G.type} defined`);return ee.fromJSON(B,G)}static jsonID(B,G){if(B in Ne)throw new RangeError("Duplicate use of selection JSON ID "+B);return Ne[B]=G,G.prototype.jsonID=B,G}getBookmark(){return Ae.between(this.$anchor,this.$head).getBookmark()}}le.prototype.visible=!0;class ne{constructor(B,G){this.$from=B,this.$to=G}}let Ye=!1;function Le(de){!Ye&&!de.parent.inlineContent&&(Ye=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+de.parent.type.name+")"))}class Ae extends le{constructor(B,G=B){Le(B),Le(G),super(B,G)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(B,G){let ee=B.resolve(G.map(this.head));if(!ee.parent.inlineContent)return le.near(ee);let se=B.resolve(G.map(this.anchor));return new Ae(se.parent.inlineContent?se:ee,ee)}replace(B,G=z.p2.empty){if(super.replace(B,G),G==z.p2.empty){let ee=this.$from.marksAcross(this.$to);ee&&B.ensureMarks(ee)}}eq(B){return B instanceof Ae&&B.anchor==this.anchor&&B.head==this.head}getBookmark(){return new C(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(B,G){if("number"!=typeof G.anchor||"number"!=typeof G.head)throw new RangeError("Invalid input for TextSelection.fromJSON");return new Ae(B.resolve(G.anchor),B.resolve(G.head))}static create(B,G,ee=G){let se=B.resolve(G);return new this(se,ee==G?se:B.resolve(ee))}static between(B,G,ee){let se=B.pos-G.pos;if((!ee||se)&&(ee=se>=0?1:-1),!G.parent.inlineContent){let he=le.findFrom(G,ee,!0)||le.findFrom(G,-ee,!0);if(!he)return le.near(G,ee);G=he.$head}return B.parent.inlineContent||(0==se||(B=(le.findFrom(B,-ee,!0)||le.findFrom(B,ee,!0)).$anchor).pos<G.pos!=se<0)&&(B=G),new Ae(B,G)}}le.jsonID("text",Ae);class C{constructor(B,G){this.anchor=B,this.head=G}map(B){return new C(B.map(this.anchor),B.map(this.head))}resolve(B){return Ae.between(B.resolve(this.anchor),B.resolve(this.head))}}class Ie extends le{constructor(B){let G=B.nodeAfter,ee=B.node(0).resolve(B.pos+G.nodeSize);super(B,ee),this.node=G}map(B,G){let{deleted:ee,pos:se}=G.mapResult(this.anchor),he=B.resolve(se);return ee?le.near(he):new Ie(he)}content(){return new z.p2(z.HY.from(this.node),0,0)}eq(B){return B instanceof Ie&&B.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new Se(this.anchor)}static fromJSON(B,G){if("number"!=typeof G.anchor)throw new RangeError("Invalid input for NodeSelection.fromJSON");return new Ie(B.resolve(G.anchor))}static create(B,G){return new Ie(B.resolve(G))}static isSelectable(B){return!B.isText&&!1!==B.type.spec.selectable}}Ie.prototype.visible=!1,le.jsonID("node",Ie);class Se{constructor(B){this.anchor=B}map(B){let{deleted:G,pos:ee}=B.mapResult(this.anchor);return G?new C(ee,ee):new Se(ee)}resolve(B){let G=B.resolve(this.anchor),ee=G.nodeAfter;return ee&&Ie.isSelectable(ee)?new Ie(G):le.near(G)}}class Me extends le{constructor(B){super(B.resolve(0),B.resolve(B.content.size))}replace(B,G=z.p2.empty){if(G==z.p2.empty){B.delete(0,B.doc.content.size);let ee=le.atStart(B.doc);ee.eq(B.selection)||B.setSelection(ee)}else super.replace(B,G)}toJSON(){return{type:"all"}}static fromJSON(B){return new Me(B)}map(B){return new Me(B)}eq(B){return B instanceof Me}getBookmark(){return rt}}le.jsonID("all",Me);const rt={map(){return this},resolve:de=>new Me(de)};function ze(de,B,G,ee,se,he=!1){if(B.inlineContent)return Ae.create(de,G);for(let ve=ee-(se>0?0:1);se>0?ve<B.childCount:ve>=0;ve+=se){let He=B.child(ve);if(He.isAtom){if(!he&&Ie.isSelectable(He))return Ie.create(de,G-(se<0?He.nodeSize:0))}else{let Pe=ze(de,He,G+se,se<0?He.childCount:0,se,he);if(Pe)return Pe}G+=He.nodeSize*se}return null}function me(de,B,G){let ee=de.steps.length-1;if(ee<B)return;let ve,se=de.steps[ee];(se instanceof Te.Pu||se instanceof Te.FC)&&(de.mapping.maps[ee].forEach((He,Pe,ot,Xe)=>{null==ve&&(ve=Xe)}),de.setSelection(le.near(de.doc.resolve(ve),G)))}class Oe extends Te.wx{constructor(B){super(B.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=B.selection,this.storedMarks=B.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(B){if(B.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=B,this.curSelectionFor=this.steps.length,this.updated=-3&(1|this.updated),this.storedMarks=null,this}get selectionSet(){return(1&this.updated)>0}setStoredMarks(B){return this.storedMarks=B,this.updated|=2,this}ensureMarks(B){return z.vc.sameSet(this.storedMarks||this.selection.$from.marks(),B)||this.setStoredMarks(B),this}addStoredMark(B){return this.ensureMarks(B.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(B){return this.ensureMarks(B.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(2&this.updated)>0}addStep(B,G){super.addStep(B,G),this.updated=-3&this.updated,this.storedMarks=null}setTime(B){return this.time=B,this}replaceSelection(B){return this.selection.replace(this,B),this}replaceSelectionWith(B,G=!0){let ee=this.selection;return G&&(B=B.mark(this.storedMarks||(ee.empty?ee.$from.marks():ee.$from.marksAcross(ee.$to)||z.vc.none))),ee.replaceWith(this,B),this}deleteSelection(){return this.selection.replace(this),this}insertText(B,G,ee){let se=this.doc.type.schema;if(null==G)return B?this.replaceSelectionWith(se.text(B),!0):this.deleteSelection();{if(null==ee&&(ee=G),ee=ee??G,!B)return this.deleteRange(G,ee);let he=this.storedMarks;if(!he){let ve=this.doc.resolve(G);he=ee==G?ve.marks():ve.marksAcross(this.doc.resolve(ee))}return this.replaceRangeWith(G,ee,se.text(B,he)),this.selection.empty||this.setSelection(le.near(this.selection.$to)),this}}setMeta(B,G){return this.meta["string"==typeof B?B:B.key]=G,this}getMeta(B){return this.meta["string"==typeof B?B:B.key]}get isGeneric(){for(let B in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=4,this}get scrolledIntoView(){return(4&this.updated)>0}}function De(de,B){return B&&de?de.bind(B):de}class je{constructor(B,G,ee){this.name=B,this.init=De(G.init,ee),this.apply=De(G.apply,ee)}}const Ee=[new je("doc",{init:de=>de.doc||de.schema.topNodeType.createAndFill(),apply:de=>de.doc}),new je("selection",{init:(de,B)=>de.selection||le.atStart(B.doc),apply:de=>de.selection}),new je("storedMarks",{init:de=>de.storedMarks||null,apply:(de,B,G,ee)=>ee.selection.$cursor?de.storedMarks:null}),new je("scrollToSelection",{init:()=>0,apply:(de,B)=>de.scrolledIntoView?B+1:B})];class $e{constructor(B,G){this.schema=B,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=Ee.slice(),G&&G.forEach(ee=>{if(this.pluginsByKey[ee.key])throw new RangeError("Adding different instances of a keyed plugin ("+ee.key+")");this.plugins.push(ee),this.pluginsByKey[ee.key]=ee,ee.spec.state&&this.fields.push(new je(ee.key,ee.spec.state,ee))})}}class Fe{constructor(B){this.config=B}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(B){return this.applyTransaction(B).state}filterTransaction(B,G=-1){for(let ee=0;ee<this.config.plugins.length;ee++)if(ee!=G){let se=this.config.plugins[ee];if(se.spec.filterTransaction&&!se.spec.filterTransaction.call(se,B,this))return!1}return!0}applyTransaction(B){if(!this.filterTransaction(B))return{state:this,transactions:[]};let G=[B],ee=this.applyInner(B),se=null;for(;;){let he=!1;for(let ve=0;ve<this.config.plugins.length;ve++){let He=this.config.plugins[ve];if(He.spec.appendTransaction){let Pe=se?se[ve].n:0,ot=se?se[ve].state:this,Xe=Pe<G.length&&He.spec.appendTransaction.call(He,Pe?G.slice(Pe):G,ot,ee);if(Xe&&ee.filterTransaction(Xe,ve)){if(Xe.setMeta("appendedTransaction",B),!se){se=[];for(let kt=0;kt<this.config.plugins.length;kt++)se.push(kt<ve?{state:ee,n:G.length}:{state:this,n:0})}G.push(Xe),ee=ee.applyInner(Xe),he=!0}se&&(se[ve]={state:ee,n:G.length})}}if(!he)return{state:ee,transactions:G}}}applyInner(B){if(!B.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let G=new Fe(this.config),ee=this.config.fields;for(let se=0;se<ee.length;se++){let he=ee[se];G[he.name]=he.apply(B,this[he.name],this,G)}return G}get tr(){return new Oe(this)}static create(B){let G=new $e(B.doc?B.doc.type.schema:B.schema,B.plugins),ee=new Fe(G);for(let se=0;se<G.fields.length;se++)ee[G.fields[se].name]=G.fields[se].init(B,ee);return ee}reconfigure(B){let G=new $e(this.schema,B.plugins),ee=G.fields,se=new Fe(G);for(let he=0;he<ee.length;he++){let ve=ee[he].name;se[ve]=this.hasOwnProperty(ve)?this[ve]:ee[he].init(B,se)}return se}toJSON(B){let G={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(G.storedMarks=this.storedMarks.map(ee=>ee.toJSON())),B&&"object"==typeof B)for(let ee in B){if("doc"==ee||"selection"==ee)throw new RangeError("The JSON fields `doc` and `selection` are reserved");let se=B[ee],he=se.spec.state;he&&he.toJSON&&(G[ee]=he.toJSON.call(se,this[se.key]))}return G}static fromJSON(B,G,ee){if(!G)throw new RangeError("Invalid input for EditorState.fromJSON");if(!B.schema)throw new RangeError("Required config field 'schema' missing");let se=new $e(B.schema,B.plugins),he=new Fe(se);return se.fields.forEach(ve=>{if("doc"==ve.name)he.doc=z.NB.fromJSON(B.schema,G.doc);else if("selection"==ve.name)he.selection=le.fromJSON(he.doc,G.selection);else if("storedMarks"==ve.name)G.storedMarks&&(he.storedMarks=G.storedMarks.map(B.schema.markFromJSON));else{if(ee)for(let He in ee){let Pe=ee[He],ot=Pe.spec.state;if(Pe.key==ve.name&&ot&&ot.fromJSON&&Object.prototype.hasOwnProperty.call(G,He))return void(he[ve.name]=ot.fromJSON.call(Pe,B,G[He],he))}he[ve.name]=ve.init(B,he)}}),he}}function st(de,B,G){for(let ee in de){let se=de[ee];se instanceof Function?se=se.bind(B):"handleDOMEvents"==ee&&(se=st(se,B,{})),G[ee]=se}return G}class qe{constructor(B){this.spec=B,this.props={},B.props&&st(B.props,this,this.props),this.key=B.key?B.key.key:We("plugin")}getState(B){return B[this.key]}}const at=Object.create(null);function We(de){return de in at?de+"$"+ ++at[de]:(at[de]=0,de+"$")}class Cn{constructor(B="key"){this.key=We(B)}get(B){return B.config.pluginsByKey[this.key]}getState(B){return B[this.key]}}},2938:(Fn,tt,Q)=>{"use strict";Q.d(tt,{Ax:()=>ot,FC:()=>$e,GJ:()=>Wt,Mn:()=>kt,Pu:()=>Ee,dR:()=>Jt,k9:()=>Cn,nd:()=>B,nj:()=>Ct,vs:()=>rt,wx:()=>$t});var z=Q(7834);const Ne=Math.pow(2,16);function le(K,w){return K+w*Ne}function ne(K){return 65535&K}class Se{constructor(w,k,P){this.pos=w,this.delInfo=k,this.recover=P}get deleted(){return(8&this.delInfo)>0}get deletedBefore(){return(5&this.delInfo)>0}get deletedAfter(){return(6&this.delInfo)>0}get deletedAcross(){return(4&this.delInfo)>0}}class Me{constructor(w,k=!1){if(this.ranges=w,this.inverted=k,!w.length&&Me.empty)return Me.empty}recover(w){let k=0,P=ne(w);if(!this.inverted)for(let F=0;F<P;F++)k+=this.ranges[3*F+2]-this.ranges[3*F+1];return this.ranges[3*P]+k+function Ye(K){return(K-(65535&K))/Ne}(w)}mapResult(w,k=1){return this._map(w,k,!1)}map(w,k=1){return this._map(w,k,!0)}_map(w,k,P){let F=0,V=this.inverted?2:1,Z=this.inverted?1:2;for(let te=0;te<this.ranges.length;te+=3){let R=this.ranges[te]-(this.inverted?F:0);if(R>w)break;let d=this.ranges[te+V],m=this.ranges[te+Z],x=R+d;if(w<=x){let A=R+F+((d?w==R?-1:w==x?1:k:k)<0?0:m);if(P)return A;let L=w==(k<0?R:x)?null:le(te/3,w-R),W=w==R?2:w==x?1:4;return(k<0?w!=R:w!=x)&&(W|=8),new Se(A,W,L)}F+=m-d}return P?w+F:new Se(w+F,0,null)}touches(w,k){let P=0,F=ne(k),V=this.inverted?2:1,Z=this.inverted?1:2;for(let te=0;te<this.ranges.length;te+=3){let R=this.ranges[te]-(this.inverted?P:0);if(R>w)break;let d=this.ranges[te+V];if(w<=R+d&&te==3*F)return!0;P+=this.ranges[te+Z]-d}return!1}forEach(w){let k=this.inverted?2:1,P=this.inverted?1:2;for(let F=0,V=0;F<this.ranges.length;F+=3){let Z=this.ranges[F],te=Z-(this.inverted?V:0),R=Z+(this.inverted?0:V),d=this.ranges[F+k],m=this.ranges[F+P];w(te,te+d,R,R+m),V+=m-d}}invert(){return new Me(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(w){return 0==w?Me.empty:new Me(w<0?[0,-w,0]:[0,0,w])}}Me.empty=new Me([]);class rt{constructor(w=[],k,P=0,F=w.length){this.maps=w,this.mirror=k,this.from=P,this.to=F}slice(w=0,k=this.maps.length){return new rt(this.maps,this.mirror,w,k)}copy(){return new rt(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)}appendMap(w,k){this.to=this.maps.push(w),null!=k&&this.setMirror(this.maps.length-1,k)}appendMapping(w){for(let k=0,P=this.maps.length;k<w.maps.length;k++){let F=w.getMirror(k);this.appendMap(w.maps[k],null!=F&&F<k?P+F:void 0)}}getMirror(w){if(this.mirror)for(let k=0;k<this.mirror.length;k++)if(this.mirror[k]==w)return this.mirror[k+(k%2?-1:1)]}setMirror(w,k){this.mirror||(this.mirror=[]),this.mirror.push(w,k)}appendMappingInverted(w){for(let k=w.maps.length-1,P=this.maps.length+w.maps.length;k>=0;k--){let F=w.getMirror(k);this.appendMap(w.maps[k].invert(),null!=F&&F>k?P-F-1:void 0)}}invert(){let w=new rt;return w.appendMappingInverted(this),w}map(w,k=1){if(this.mirror)return this._map(w,k,!0);for(let P=this.from;P<this.to;P++)w=this.maps[P].map(w,k);return w}mapResult(w,k=1){return this._map(w,k,!1)}_map(w,k,P){let F=0;for(let V=this.from;V<this.to;V++){let te=this.maps[V].mapResult(w,k);if(null!=te.recover){let R=this.getMirror(V);if(null!=R&&R>V&&R<this.to){V=R,w=this.maps[R].recover(te.recover);continue}}F|=te.delInfo,w=te.pos}return P?w:new Se(w,F,null)}}const ze=Object.create(null);class me{getMap(){return Me.empty}merge(w){return null}static fromJSON(w,k){if(!k||!k.stepType)throw new RangeError("Invalid input for Step.fromJSON");let P=ze[k.stepType];if(!P)throw new RangeError(`No step type ${k.stepType} defined`);return P.fromJSON(w,k)}static jsonID(w,k){if(w in ze)throw new RangeError("Duplicate use of step JSON ID "+w);return ze[w]=k,k.prototype.jsonID=w,k}}class xe{constructor(w,k){this.doc=w,this.failed=k}static ok(w){return new xe(w,null)}static fail(w){return new xe(null,w)}static fromReplace(w,k,P,F){try{return xe.ok(w.replace(k,P,F))}catch(V){if(V instanceof z.e4)return xe.fail(V.message);throw V}}}function Ce(K,w,k){let P=[];for(let F=0;F<K.childCount;F++){let V=K.child(F);V.content.size&&(V=V.copy(Ce(V.content,w,V))),V.isInline&&(V=w(V,k,F)),P.push(V)}return z.HY.fromArray(P)}class ke extends me{constructor(w,k,P){super(),this.from=w,this.to=k,this.mark=P}apply(w){let k=w.slice(this.from,this.to),P=w.resolve(this.from),F=P.node(P.sharedDepth(this.to)),V=new z.p2(Ce(k.content,(Z,te)=>Z.isAtom&&te.type.allowsMarkType(this.mark.type)?Z.mark(this.mark.addToSet(Z.marks)):Z,F),k.openStart,k.openEnd);return xe.fromReplace(w,this.from,this.to,V)}invert(){return new Oe(this.from,this.to,this.mark)}map(w){let k=w.mapResult(this.from,1),P=w.mapResult(this.to,-1);return k.deleted&&P.deleted||k.pos>=P.pos?null:new ke(k.pos,P.pos,this.mark)}merge(w){return w instanceof ke&&w.mark.eq(this.mark)&&this.from<=w.to&&this.to>=w.from?new ke(Math.min(this.from,w.from),Math.max(this.to,w.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(w,k){if("number"!=typeof k.from||"number"!=typeof k.to)throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new ke(k.from,k.to,w.markFromJSON(k.mark))}}me.jsonID("addMark",ke);class Oe extends me{constructor(w,k,P){super(),this.from=w,this.to=k,this.mark=P}apply(w){let k=w.slice(this.from,this.to),P=new z.p2(Ce(k.content,F=>F.mark(this.mark.removeFromSet(F.marks)),w),k.openStart,k.openEnd);return xe.fromReplace(w,this.from,this.to,P)}invert(){return new ke(this.from,this.to,this.mark)}map(w){let k=w.mapResult(this.from,1),P=w.mapResult(this.to,-1);return k.deleted&&P.deleted||k.pos>=P.pos?null:new Oe(k.pos,P.pos,this.mark)}merge(w){return w instanceof Oe&&w.mark.eq(this.mark)&&this.from<=w.to&&this.to>=w.from?new Oe(Math.min(this.from,w.from),Math.max(this.to,w.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(w,k){if("number"!=typeof k.from||"number"!=typeof k.to)throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new Oe(k.from,k.to,w.markFromJSON(k.mark))}}me.jsonID("removeMark",Oe);class De extends me{constructor(w,k){super(),this.pos=w,this.mark=k}apply(w){let k=w.nodeAt(this.pos);if(!k)return xe.fail("No node at mark step's position");let P=k.type.create(k.attrs,null,this.mark.addToSet(k.marks));return xe.fromReplace(w,this.pos,this.pos+1,new z.p2(z.HY.from(P),0,k.isLeaf?0:1))}invert(w){let k=w.nodeAt(this.pos);if(k){let P=this.mark.addToSet(k.marks);if(P.length==k.marks.length){for(let F=0;F<k.marks.length;F++)if(!k.marks[F].isInSet(P))return new De(this.pos,k.marks[F]);return new De(this.pos,this.mark)}}return new je(this.pos,this.mark)}map(w){let k=w.mapResult(this.pos,1);return k.deletedAfter?null:new De(k.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(w,k){if("number"!=typeof k.pos)throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new De(k.pos,w.markFromJSON(k.mark))}}me.jsonID("addNodeMark",De);class je extends me{constructor(w,k){super(),this.pos=w,this.mark=k}apply(w){let k=w.nodeAt(this.pos);if(!k)return xe.fail("No node at mark step's position");let P=k.type.create(k.attrs,null,this.mark.removeFromSet(k.marks));return xe.fromReplace(w,this.pos,this.pos+1,new z.p2(z.HY.from(P),0,k.isLeaf?0:1))}invert(w){let k=w.nodeAt(this.pos);return k&&this.mark.isInSet(k.marks)?new De(this.pos,this.mark):this}map(w){let k=w.mapResult(this.pos,1);return k.deletedAfter?null:new je(k.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(w,k){if("number"!=typeof k.pos)throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new je(k.pos,w.markFromJSON(k.mark))}}me.jsonID("removeNodeMark",je);class Ee extends me{constructor(w,k,P,F=!1){super(),this.from=w,this.to=k,this.slice=P,this.structure=F}apply(w){return this.structure&&Fe(w,this.from,this.to)?xe.fail("Structure replace would overwrite content"):xe.fromReplace(w,this.from,this.to,this.slice)}getMap(){return new Me([this.from,this.to-this.from,this.slice.size])}invert(w){return new Ee(this.from,this.from+this.slice.size,w.slice(this.from,this.to))}map(w){let k=w.mapResult(this.from,1),P=w.mapResult(this.to,-1);return k.deletedAcross&&P.deletedAcross?null:new Ee(k.pos,Math.max(k.pos,P.pos),this.slice)}merge(w){if(!(w instanceof Ee)||w.structure||this.structure)return null;if(this.from+this.slice.size!=w.from||this.slice.openEnd||w.slice.openStart){if(w.to!=this.from||this.slice.openStart||w.slice.openEnd)return null;{let k=this.slice.size+w.slice.size==0?z.p2.empty:new z.p2(w.slice.content.append(this.slice.content),w.slice.openStart,this.slice.openEnd);return new Ee(w.from,this.to,k,this.structure)}}{let k=this.slice.size+w.slice.size==0?z.p2.empty:new z.p2(this.slice.content.append(w.slice.content),this.slice.openStart,w.slice.openEnd);return new Ee(this.from,this.to+(w.to-w.from),k,this.structure)}}toJSON(){let w={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(w.slice=this.slice.toJSON()),this.structure&&(w.structure=!0),w}static fromJSON(w,k){if("number"!=typeof k.from||"number"!=typeof k.to)throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new Ee(k.from,k.to,z.p2.fromJSON(w,k.slice),!!k.structure)}}me.jsonID("replace",Ee);class $e extends me{constructor(w,k,P,F,V,Z,te=!1){super(),this.from=w,this.to=k,this.gapFrom=P,this.gapTo=F,this.slice=V,this.insert=Z,this.structure=te}apply(w){if(this.structure&&(Fe(w,this.from,this.gapFrom)||Fe(w,this.gapTo,this.to)))return xe.fail("Structure gap-replace would overwrite content");let k=w.slice(this.gapFrom,this.gapTo);if(k.openStart||k.openEnd)return xe.fail("Gap is not a flat range");let P=this.slice.insertAt(this.insert,k.content);return P?xe.fromReplace(w,this.from,this.to,P):xe.fail("Content does not fit in gap")}getMap(){return new Me([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(w){let k=this.gapTo-this.gapFrom;return new $e(this.from,this.from+this.slice.size+k,this.from+this.insert,this.from+this.insert+k,w.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(w){let k=w.mapResult(this.from,1),P=w.mapResult(this.to,-1),F=w.map(this.gapFrom,-1),V=w.map(this.gapTo,1);return k.deletedAcross&&P.deletedAcross||F<k.pos||V>P.pos?null:new $e(k.pos,P.pos,F,V,this.slice,this.insert,this.structure)}toJSON(){let w={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(w.slice=this.slice.toJSON()),this.structure&&(w.structure=!0),w}static fromJSON(w,k){if("number"!=typeof k.from||"number"!=typeof k.to||"number"!=typeof k.gapFrom||"number"!=typeof k.gapTo||"number"!=typeof k.insert)throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new $e(k.from,k.to,k.gapFrom,k.gapTo,z.p2.fromJSON(w,k.slice),k.insert,!!k.structure)}}function Fe(K,w,k){let P=K.resolve(w),F=k-w,V=P.depth;for(;F>0&&V>0&&P.indexAfter(V)==P.node(V).childCount;)V--,F--;if(F>0){let Z=P.node(V).maybeChild(P.indexAfter(V));for(;F>0;){if(!Z||Z.isLeaf)return!0;Z=Z.firstChild,F--}}return!1}function We(K,w,k){return(0==w||K.canReplace(w,K.childCount))&&(k==K.childCount||K.canReplace(0,k))}function Cn(K){let k=K.parent.content.cutByIndex(K.startIndex,K.endIndex);for(let P=K.depth;;--P){let F=K.$from.node(P),V=K.$from.index(P),Z=K.$to.indexAfter(P);if(P<K.depth&&F.canReplace(V,Z,k))return P;if(0==P||F.type.spec.isolating||!We(F,V,Z))break}return null}function B(K,w,k=null,P=K){let F=function ee(K,w){let{parent:k,startIndex:P,endIndex:F}=K,V=k.contentMatchAt(P).findWrapping(w);return V&&k.canReplaceWith(P,F,V.length?V[0]:w)?V:null}(K,w),V=F&&function se(K,w){let{parent:k,startIndex:P,endIndex:F}=K,V=k.child(P),Z=w.contentMatch.findWrapping(V.type);if(!Z)return null;let R=(Z.length?Z[Z.length-1]:w).contentMatch;for(let d=P;R&&d<F;d++)R=R.matchType(k.child(d).type);return R&&R.validEnd?Z:null}(P,w);return V?F.map(G).concat({type:w,attrs:k}).concat(V.map(G)):null}function G(K){return{type:K,attrs:null}}function ot(K,w,k=1,P){let F=K.resolve(w),V=F.depth-k,Z=P&&P[P.length-1]||F.parent;if(V<0||F.parent.type.spec.isolating||!F.parent.canReplace(F.index(),F.parent.childCount)||!Z.type.validContent(F.parent.content.cutByIndex(F.index(),F.parent.childCount)))return!1;for(let d=F.depth-1,m=k-2;d>V;d--,m--){let x=F.node(d),M=F.index(d);if(x.type.spec.isolating)return!1;let A=x.content.cutByIndex(M,x.childCount),L=P&&P[m+1];L&&(A=A.replaceChild(0,L.type.create(L.attrs)));let W=P&&P[m]||x;if(!x.canReplace(M+1,x.childCount)||!W.type.validContent(A))return!1}let te=F.indexAfter(V),R=P&&P[0];return F.node(V).canReplaceWith(te,te,R?R.type:F.node(V+1).type)}function kt(K,w){let k=K.resolve(w),P=k.index();return qt(k.nodeBefore,k.nodeAfter)&&k.parent.canReplace(P,P+1)}function qt(K,w){return!(!K||!w||K.isLeaf||!K.canAppend(w))}function Wt(K,w,k=-1){let P=K.resolve(w);for(let F=P.depth;;F--){let V,Z,te=P.index(F);if(F==P.depth?(V=P.nodeBefore,Z=P.nodeAfter):k>0?(V=P.node(F+1),te++,Z=P.node(F).maybeChild(te)):(V=P.node(F).maybeChild(te-1),Z=P.node(F+1)),V&&!V.isTextblock&&qt(V,Z)&&P.node(F).canReplace(te,te+1))return w;if(0==F)break;w=k<0?P.before(F):P.after(F)}}function Ct(K,w,k){let P=K.resolve(w);if(!k.content.size)return w;let F=k.content;for(let V=0;V<k.openStart;V++)F=F.firstChild.content;for(let V=1;V<=(0==k.openStart&&k.size?2:1);V++)for(let Z=P.depth;Z>=0;Z--){let te=Z==P.depth?0:P.pos<=(P.start(Z+1)+P.end(Z+1))/2?-1:1,R=P.index(Z)+(te>0?1:0),d=P.node(Z),m=!1;if(1==V)m=d.canReplace(R,R,F);else{let x=d.contentMatchAt(R).findWrapping(F.firstChild.type);m=x&&d.canReplaceWith(R,R,x[0])}if(m)return 0==te?P.pos:te<0?P.before(Z+1):P.after(Z+1)}return null}function Jt(K,w,k=w,P=z.p2.empty){if(w==k&&!P.size)return null;let F=K.resolve(w),V=K.resolve(k);return Xt(F,V,P)?new Ee(w,k,P):new hn(F,V,P).fit()}function Xt(K,w,k){return!k.openStart&&!k.openEnd&&K.start()==w.start()&&K.parent.canReplace(K.index(),w.index(),k.content)}me.jsonID("replaceAround",$e);class hn{constructor(w,k,P){this.$from=w,this.$to=k,this.unplaced=P,this.frontier=[],this.placed=z.HY.empty;for(let F=0;F<=w.depth;F++){let V=w.node(F);this.frontier.push({type:V.type,match:V.contentMatchAt(w.indexAfter(F))})}for(let F=w.depth;F>0;F--)this.placed=z.HY.from(w.node(F).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let d=this.findFittable();d?this.placeNodes(d):this.openMore()||this.dropNode()}let w=this.mustMoveInline(),k=this.placed.size-this.depth-this.$from.depth,P=this.$from,F=this.close(w<0?this.$to:P.doc.resolve(w));if(!F)return null;let V=this.placed,Z=P.depth,te=F.depth;for(;Z&&te&&1==V.childCount;)V=V.firstChild.content,Z--,te--;let R=new z.p2(V,Z,te);return w>-1?new $e(P.pos,w,this.$to.pos,this.$to.end(),R,k):R.size||P.pos!=this.$to.pos?new Ee(P.pos,F.pos,R):null}findFittable(){let w=this.unplaced.openStart;for(let k=this.unplaced.content,P=0,F=this.unplaced.openEnd;P<w;P++){let V=k.firstChild;if(k.childCount>1&&(F=0),V.type.spec.isolating&&F<=P){w=P;break}k=V.content}for(let k=1;k<=2;k++)for(let P=1==k?w:this.unplaced.openStart;P>=0;P--){let F,V=null;P?(V=Yt(this.unplaced.content,P-1).firstChild,F=V.content):F=this.unplaced.content;let Z=F.firstChild;for(let te=this.depth;te>=0;te--){let m,{type:R,match:d}=this.frontier[te],x=null;if(1==k&&(Z?d.matchType(Z.type)||(x=d.fillBefore(z.HY.from(Z),!1)):V&&R.compatibleContent(V.type)))return{sliceDepth:P,frontierDepth:te,parent:V,inject:x};if(2==k&&Z&&(m=d.findWrapping(Z.type)))return{sliceDepth:P,frontierDepth:te,parent:V,wrap:m};if(V&&d.matchType(V.type))break}}}openMore(){let{content:w,openStart:k,openEnd:P}=this.unplaced,F=Yt(w,k);return!(!F.childCount||F.firstChild.isLeaf||(this.unplaced=new z.p2(w,k+1,Math.max(P,F.size+k>=w.size-P?k+1:0)),0))}dropNode(){let{content:w,openStart:k,openEnd:P}=this.unplaced,F=Yt(w,k);if(F.childCount<=1&&k>0){let V=w.size-k<=k+F.size;this.unplaced=new z.p2(It(w,k-1,1),k-1,V?k-1:P)}else this.unplaced=new z.p2(It(w,k,1),k,P)}placeNodes({sliceDepth:w,frontierDepth:k,parent:P,inject:F,wrap:V}){for(;this.depth>k;)this.closeFrontierNode();if(V)for(let W=0;W<V.length;W++)this.openFrontierNode(V[W]);let Z=this.unplaced,te=P?P.content:Z.content,R=Z.openStart-w,d=0,m=[],{match:x,type:M}=this.frontier[k];if(F){for(let W=0;W<F.childCount;W++)m.push(F.child(W));x=x.matchFragment(F)}let A=te.size+w-(Z.content.size-Z.openEnd);for(;d<te.childCount;){let W=te.child(d),q=x.matchType(W.type);if(!q)break;d++,(d>1||0==R||W.content.size)&&(x=q,m.push(bn(W.mark(M.allowedMarks(W.marks)),1==d?R:0,d==te.childCount?A:-1)))}let L=d==te.childCount;L||(A=-1),this.placed=Kt(this.placed,k,z.HY.from(m)),this.frontier[k].match=x,L&&A<0&&P&&P.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let W=0,q=te;W<A;W++){let pe=q.lastChild;this.frontier.push({type:pe.type,match:pe.contentMatchAt(pe.childCount)}),q=pe.content}this.unplaced=L?0==w?z.p2.empty:new z.p2(It(Z.content,w-1,1),w-1,A<0?Z.openEnd:w-1):new z.p2(It(Z.content,w,d),Z.openStart,Z.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let k,w=this.frontier[this.depth];if(!w.type.isTextblock||!en(this.$to,this.$to.depth,w.type,w.match,!1)||this.$to.depth==this.depth&&(k=this.findCloseLevel(this.$to))&&k.depth==this.depth)return-1;let{depth:P}=this.$to,F=this.$to.after(P);for(;P>1&&F==this.$to.end(--P);)++F;return F}findCloseLevel(w){e:for(let k=Math.min(this.depth,w.depth);k>=0;k--){let{match:P,type:F}=this.frontier[k],V=k<w.depth&&w.end(k+1)==w.pos+(w.depth-(k+1)),Z=en(w,k,F,P,V);if(Z){for(let te=k-1;te>=0;te--){let{match:R,type:d}=this.frontier[te],m=en(w,te,d,R,!0);if(!m||m.childCount)continue e}return{depth:k,fit:Z,move:V?w.doc.resolve(w.after(k+1)):w}}}}close(w){let k=this.findCloseLevel(w);if(!k)return null;for(;this.depth>k.depth;)this.closeFrontierNode();k.fit.childCount&&(this.placed=Kt(this.placed,k.depth,k.fit)),w=k.move;for(let P=k.depth+1;P<=w.depth;P++){let F=w.node(P),V=F.type.contentMatch.fillBefore(F.content,!0,w.index(P));this.openFrontierNode(F.type,F.attrs,V)}return w}openFrontierNode(w,k=null,P){let F=this.frontier[this.depth];F.match=F.match.matchType(w),this.placed=Kt(this.placed,this.depth,z.HY.from(w.create(k,P))),this.frontier.push({type:w,match:w.contentMatch})}closeFrontierNode(){let k=this.frontier.pop().match.fillBefore(z.HY.empty,!0);k.childCount&&(this.placed=Kt(this.placed,this.frontier.length,k))}}function It(K,w,k){return 0==w?K.cutByIndex(k,K.childCount):K.replaceChild(0,K.firstChild.copy(It(K.firstChild.content,w-1,k)))}function Kt(K,w,k){return 0==w?K.append(k):K.replaceChild(K.childCount-1,K.lastChild.copy(Kt(K.lastChild.content,w-1,k)))}function Yt(K,w){for(let k=0;k<w;k++)K=K.firstChild.content;return K}function bn(K,w,k){if(w<=0)return K;let P=K.content;return w>1&&(P=P.replaceChild(0,bn(P.firstChild,w-1,1==P.childCount?k-1:0))),w>0&&(P=K.type.contentMatch.fillBefore(P).append(P),k<=0&&(P=P.append(K.type.contentMatch.matchFragment(P).fillBefore(z.HY.empty,!0)))),K.copy(P)}function en(K,w,k,P,F){let V=K.node(w),Z=F?K.indexAfter(w):K.index(w);if(Z==V.childCount&&!k.compatibleContent(V.type))return null;let te=P.fillBefore(V.content,!0,Z);return te&&!function Gt(K,w,k){for(let P=k;P<w.childCount;P++)if(!K.allowsMarks(w.child(P).marks))return!0;return!1}(k,V.content,Z)?te:null}function mt(K){return K.spec.defining||K.spec.definingForContent}function tn(K,w,k,P,F){if(w<k){let V=K.firstChild;K=K.replaceChild(0,V.copy(tn(V.content,w+1,k,P,V)))}if(w>P){let V=F.contentMatchAt(0),Z=V.fillBefore(K).append(K);K=Z.append(V.matchFragment(Z).fillBefore(z.HY.empty,!0))}return K}function Dt(K,w){let k=[];for(let F=Math.min(K.depth,w.depth);F>=0;F--){let V=K.start(F);if(V<K.pos-(K.depth-F)||w.end(F)>w.pos+(w.depth-F)||K.node(F).type.spec.isolating||w.node(F).type.spec.isolating)break;(V==w.start(F)||F==K.depth&&F==w.depth&&K.parent.inlineContent&&w.parent.inlineContent&&F&&w.start(F-1)==V-1)&&k.push(F)}return k}class Pt extends me{constructor(w,k,P){super(),this.pos=w,this.attr=k,this.value=P}apply(w){let k=w.nodeAt(this.pos);if(!k)return xe.fail("No node at attribute step's position");let P=Object.create(null);for(let V in k.attrs)P[V]=k.attrs[V];P[this.attr]=this.value;let F=k.type.create(P,null,k.marks);return xe.fromReplace(w,this.pos,this.pos+1,new z.p2(z.HY.from(F),0,k.isLeaf?0:1))}getMap(){return Me.empty}invert(w){return new Pt(this.pos,this.attr,w.nodeAt(this.pos).attrs[this.attr])}map(w){let k=w.mapResult(this.pos,1);return k.deletedAfter?null:new Pt(k.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(w,k){if("number"!=typeof k.pos||"string"!=typeof k.attr)throw new RangeError("Invalid input for AttrStep.fromJSON");return new Pt(k.pos,k.attr,k.value)}}me.jsonID("attr",Pt);class St extends me{constructor(w,k){super(),this.attr=w,this.value=k}apply(w){let k=Object.create(null);for(let F in w.attrs)k[F]=w.attrs[F];k[this.attr]=this.value;let P=w.type.create(k,w.content,w.marks);return xe.ok(P)}getMap(){return Me.empty}invert(w){return new St(this.attr,w.attrs[this.attr])}map(w){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(w,k){if("string"!=typeof k.attr)throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new St(k.attr,k.value)}}me.jsonID("docAttr",St);let Rt=class extends Error{};Rt=function K(w){let k=Error.call(this,w);return k.__proto__=K.prototype,k},(Rt.prototype=Object.create(Error.prototype)).constructor=Rt,Rt.prototype.name="TransformError";class $t{constructor(w){this.doc=w,this.steps=[],this.docs=[],this.mapping=new rt}get before(){return this.docs.length?this.docs[0]:this.doc}step(w){let k=this.maybeStep(w);if(k.failed)throw new Rt(k.failed);return this}maybeStep(w){let k=w.apply(this.doc);return k.failed||this.addStep(w,k.doc),k}get docChanged(){return this.steps.length>0}addStep(w,k){this.docs.push(this.doc),this.steps.push(w),this.mapping.appendMap(w.getMap()),this.doc=k}replace(w,k=w,P=z.p2.empty){let F=Jt(this.doc,w,k,P);return F&&this.step(F),this}replaceWith(w,k,P){return this.replace(w,k,new z.p2(z.HY.from(P),0,0))}delete(w,k){return this.replace(w,k,z.p2.empty)}insert(w,k){return this.replaceWith(w,w,k)}replaceRange(w,k,P){return function qn(K,w,k,P){if(!P.size)return K.deleteRange(w,k);let F=K.doc.resolve(w),V=K.doc.resolve(k);if(Xt(F,V,P))return K.step(new Ee(w,k,P));let Z=Dt(F,K.doc.resolve(k));0==Z[Z.length-1]&&Z.pop();let te=-(F.depth+1);Z.unshift(te);for(let M=F.depth,A=F.pos-1;M>0;M--,A--){let L=F.node(M).type.spec;if(L.defining||L.definingAsContext||L.isolating)break;Z.indexOf(M)>-1?te=M:F.before(M)==A&&Z.splice(1,0,-M)}let R=Z.indexOf(te),d=[],m=P.openStart;for(let M=P.content,A=0;;A++){let L=M.firstChild;if(d.push(L),A==P.openStart)break;M=L.content}for(let M=m-1;M>=0;M--){let A=d[M],L=mt(A.type);if(L&&!A.sameMarkup(F.node(Math.abs(te)-1)))m=M;else if(L||!A.type.isTextblock)break}for(let M=P.openStart;M>=0;M--){let A=(M+m+1)%(P.openStart+1),L=d[A];if(L)for(let W=0;W<Z.length;W++){let q=Z[(W+R)%Z.length],pe=!0;q<0&&(pe=!1,q=-q);let ge=F.node(q-1),Ge=F.index(q-1);if(ge.canReplaceWith(Ge,Ge,L.type,L.marks))return K.replace(F.before(q),pe?V.after(q):k,new z.p2(tn(P.content,0,P.openStart,A),A,P.openEnd))}}let x=K.steps.length;for(let M=Z.length-1;M>=0&&(K.replace(w,k,P),!(K.steps.length>x));M--){let A=Z[M];A<0||(w=F.before(A),k=V.after(A))}}(this,w,k,P),this}replaceRangeWith(w,k,P){return function wt(K,w,k,P){if(!P.isInline&&w==k&&K.doc.resolve(w).parent.content.size){let F=function At(K,w,k){let P=K.resolve(w);if(P.parent.canReplaceWith(P.index(),P.index(),k))return w;if(0==P.parentOffset)for(let F=P.depth-1;F>=0;F--){let V=P.index(F);if(P.node(F).canReplaceWith(V,V,k))return P.before(F+1);if(V>0)return null}if(P.parentOffset==P.parent.content.size)for(let F=P.depth-1;F>=0;F--){let V=P.indexAfter(F);if(P.node(F).canReplaceWith(V,V,k))return P.after(F+1);if(V<P.node(F).childCount)return null}return null}(K.doc,w,P.type);null!=F&&(w=k=F)}K.replaceRange(w,k,new z.p2(z.HY.from(P),0,0))}(this,w,k,P),this}deleteRange(w,k){return function nn(K,w,k){let P=K.doc.resolve(w),F=K.doc.resolve(k),V=Dt(P,F);for(let Z=0;Z<V.length;Z++){let te=V[Z],R=Z==V.length-1;if(R&&0==te||P.node(te).type.contentMatch.validEnd)return K.delete(P.start(te),F.end(te));if(te>0&&(R||P.node(te-1).canReplace(P.index(te-1),F.indexAfter(te-1))))return K.delete(P.before(te),F.after(te))}for(let Z=1;Z<=P.depth&&Z<=F.depth;Z++)if(w-P.start(Z)==P.depth-Z&&k>P.end(Z)&&F.end(Z)-k!=F.depth-Z)return K.delete(P.before(Z),k);K.delete(w,k)}(this,w,k),this}lift(w,k){return function de(K,w,k){let{$from:P,$to:F,depth:V}=w,Z=P.before(V+1),te=F.after(V+1),R=Z,d=te,m=z.HY.empty,x=0;for(let L=V,W=!1;L>k;L--)W||P.index(L)>0?(W=!0,m=z.HY.from(P.node(L).copy(m)),x++):R--;let M=z.HY.empty,A=0;for(let L=V,W=!1;L>k;L--)W||F.after(L+1)<F.end(L)?(W=!0,M=z.HY.from(F.node(L).copy(M)),A++):d++;K.step(new $e(R,d,Z,te,new z.p2(m.append(M),x,A),m.size-x,!0))}(this,w,k),this}join(w,k=1){return function zt(K,w,k){let P=new Ee(w-k,w+k,z.p2.empty,!0);K.step(P)}(this,w,k),this}wrap(w,k){return function he(K,w,k){let P=z.HY.empty;for(let Z=k.length-1;Z>=0;Z--){if(P.size){let te=k[Z].type.contentMatch.matchFragment(P);if(!te||!te.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}P=z.HY.from(k[Z].type.create(k[Z].attrs,P))}let F=w.start,V=w.end;K.step(new $e(F,V,F,V,new z.p2(P,0,0),k.length,!0))}(this,w,k),this}setBlockType(w,k=w,P,F=null){return function ve(K,w,k,P,F){if(!P.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let V=K.steps.length;K.doc.nodesBetween(w,k,(Z,te)=>{if(Z.isTextblock&&!Z.hasMarkup(P,F)&&function He(K,w,k){let P=K.resolve(w),F=P.index();return P.parent.canReplaceWith(F,F+1,k)}(K.doc,K.mapping.slice(V).map(te),P)){K.clearIncompatible(K.mapping.slice(V).map(te,1),P);let R=K.mapping.slice(V),d=R.map(te,1),m=R.map(te+Z.nodeSize,1);return K.step(new $e(d,m,d+1,m-1,new z.p2(z.HY.from(P.create(F,null,Z.marks)),0,0),1,!0)),!1}})}(this,w,k,P,F),this}setNodeMarkup(w,k,P=null,F){return function Pe(K,w,k,P,F){let V=K.doc.nodeAt(w);if(!V)throw new RangeError("No node at given position");k||(k=V.type);let Z=k.create(P,null,F||V.marks);if(V.isLeaf)return K.replaceWith(w,w+V.nodeSize,Z);if(!k.validContent(V.content))throw new RangeError("Invalid content for node type "+k.name);K.step(new $e(w,w+V.nodeSize,w+1,w+V.nodeSize-1,new z.p2(z.HY.from(Z),0,0),1,!0))}(this,w,k,P,F),this}setNodeAttribute(w,k,P){return this.step(new Pt(w,k,P)),this}setDocAttribute(w,k){return this.step(new St(w,k)),this}addNodeMark(w,k){return this.step(new De(w,k)),this}removeNodeMark(w,k){if(!(k instanceof z.vc)){let P=this.doc.nodeAt(w);if(!P)throw new RangeError("No node at position "+w);if(!(k=k.isInSet(P.marks)))return this}return this.step(new je(w,k)),this}split(w,k=1,P){return function Xe(K,w,k=1,P){let F=K.doc.resolve(w),V=z.HY.empty,Z=z.HY.empty;for(let te=F.depth,R=F.depth-k,d=k-1;te>R;te--,d--){V=z.HY.from(F.node(te).copy(V));let m=P&&P[d];Z=z.HY.from(m?m.type.create(m.attrs,Z):F.node(te).copy(Z))}K.step(new Ee(w,w,new z.p2(V.append(Z),k,k),!0))}(this,w,k,P),this}addMark(w,k,P){return function st(K,w,k,P){let Z,te,F=[],V=[];K.doc.nodesBetween(w,k,(R,d,m)=>{if(!R.isInline)return;let x=R.marks;if(!P.isInSet(x)&&m.type.allowsMarkType(P.type)){let M=Math.max(d,w),A=Math.min(d+R.nodeSize,k),L=P.addToSet(x);for(let W=0;W<x.length;W++)x[W].isInSet(L)||(Z&&Z.to==M&&Z.mark.eq(x[W])?Z.to=A:F.push(Z=new Oe(M,A,x[W])));te&&te.to==M?te.to=A:V.push(te=new ke(M,A,P))}}),F.forEach(R=>K.step(R)),V.forEach(R=>K.step(R))}(this,w,k,P),this}removeMark(w,k,P){return function qe(K,w,k,P){let F=[],V=0;K.doc.nodesBetween(w,k,(Z,te)=>{if(!Z.isInline)return;V++;let R=null;if(P instanceof z.ZU){let m,d=Z.marks;for(;m=P.isInSet(d);)(R||(R=[])).push(m),d=m.removeFromSet(d)}else P?P.isInSet(Z.marks)&&(R=[P]):R=Z.marks;if(R&&R.length){let d=Math.min(te+Z.nodeSize,k);for(let m=0;m<R.length;m++){let M,x=R[m];for(let A=0;A<F.length;A++){let L=F[A];L.step==V-1&&x.eq(F[A].style)&&(M=L)}M?(M.to=d,M.step=V):F.push({style:x,from:Math.max(te,w),to:d,step:V})}}}),F.forEach(Z=>K.step(new Oe(Z.from,Z.to,Z.style)))}(this,w,k,P),this}clearIncompatible(w,k,P){return function at(K,w,k,P=k.contentMatch){let F=K.doc.nodeAt(w),V=[],Z=w+1;for(let te=0;te<F.childCount;te++){let R=F.child(te),d=Z+R.nodeSize,m=P.matchType(R.type);if(m){P=m;for(let x=0;x<R.marks.length;x++)k.allowsMarkType(R.marks[x].type)||K.step(new Oe(Z,d,R.marks[x]));if(R.isText&&!k.spec.code){let x,A,M=/\r?\n|\r/g;for(;x=M.exec(R.text);)A||(A=new z.p2(z.HY.from(k.schema.text(" ",k.allowedMarks(R.marks))),0,0)),V.push(new Ee(Z+x.index,Z+x.index+x[0].length,A))}}else V.push(new Ee(Z,d,z.p2.empty));Z=d}if(!P.validEnd){let te=P.fillBefore(z.HY.empty,!0);K.replace(Z,Z,new z.p2(te,0,0))}for(let te=V.length-1;te>=0;te--)K.step(V[te])}(this,w,k,P),this}}},7387:(Fn,tt,Q)=>{"use strict";Q.d(tt,{EH:()=>et,p:()=>vt,tk:()=>Fo});var z=Q(7825),Te=Q(7834),Ne=Q(2938);const le=function(a){for(var s=0;;s++)if(!(a=a.previousSibling))return s},ne=function(a){let s=a.assignedSlot||a.parentNode;return s&&11==s.nodeType?s.host:s};let Ye=null;const Le=function(a,s,u){let f=Ye||(Ye=document.createRange());return f.setEnd(a,u??a.nodeValue.length),f.setStart(a,s||0),f},Ae=function(a,s,u,f){return u&&(Ie(a,s,u,f,-1)||Ie(a,s,u,f,1))},C=/^(img|br|input|textarea|hr)$/i;function Ie(a,s,u,f,T){for(;;){if(a==u&&s==f)return!0;if(s==(T<0?0:Se(a))){let b=a.parentNode;if(!b||1!=b.nodeType||rt(a)||C.test(a.nodeName)||"false"==a.contentEditable)return!1;s=le(a)+(T<0?0:1),a=b}else{if(1!=a.nodeType)return!1;if("false"==(a=a.childNodes[s+(T<0?-1:0)]).contentEditable)return!1;s=T<0?Se(a):0}}}function Se(a){return 3==a.nodeType?a.nodeValue.length:a.childNodes.length}function rt(a){let s;for(let u=a;u&&!(s=u.pmViewDesc);u=u.parentNode);return s&&s.node&&s.node.isBlock&&(s.dom==a||s.contentDOM==a)}const ze=function(a){return a.focusNode&&Ae(a.focusNode,a.focusOffset,a.anchorNode,a.anchorOffset)};function me(a,s){let u=document.createEvent("Event");return u.initEvent("keydown",!0,!0),u.keyCode=a,u.key=u.code=s,u}const ke=typeof navigator<"u"?navigator:null,Oe=typeof document<"u"?document:null,De=ke&&ke.userAgent||"",je=/Edge\/(\d+)/.exec(De),Ee=/MSIE \d/.exec(De),$e=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(De),Fe=!!(Ee||$e||je),st=Ee?document.documentMode:$e?+$e[1]:je?+je[1]:0,qe=!Fe&&/gecko\/(\d+)/i.test(De);qe&&/Firefox\/(\d+)/.exec(De);const at=!Fe&&/Chrome\/(\d+)/.exec(De),We=!!at,Cn=at?+at[1]:0,de=!Fe&&!!ke&&/Apple Computer/.test(ke.vendor),B=de&&(/Mobile\/\w+/.test(De)||!!ke&&ke.maxTouchPoints>2),G=B||!!ke&&/Mac/.test(ke.platform),ee=!!ke&&/Win/.test(ke.platform),se=/Android \d/.test(De),he=!!Oe&&"webkitFontSmoothing"in Oe.documentElement.style,ve=he?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function He(a){return{left:0,right:a.documentElement.clientWidth,top:0,bottom:a.documentElement.clientHeight}}function Pe(a,s){return"number"==typeof a?a:a[s]}function ot(a){let s=a.getBoundingClientRect();return{left:s.left,right:s.left+a.clientWidth*(s.width/a.offsetWidth||1),top:s.top,bottom:s.top+a.clientHeight*(s.height/a.offsetHeight||1)}}function Xe(a,s,u){let f=a.someProp("scrollThreshold")||0,T=a.someProp("scrollMargin")||5,b=a.dom.ownerDocument;for(let l=u||a.dom;l;l=ne(l)){if(1!=l.nodeType)continue;let o=l,c=o==b.body,p=c?He(b):ot(o),g=0,y=0;if(s.top<p.top+Pe(f,"top")?y=-(p.top-s.top+Pe(T,"top")):s.bottom>p.bottom-Pe(f,"bottom")&&(y=s.bottom-s.top>p.bottom-p.top?s.top+Pe(T,"top")-p.top:s.bottom-p.bottom+Pe(T,"bottom")),s.left<p.left+Pe(f,"left")?g=-(p.left-s.left+Pe(T,"left")):s.right>p.right-Pe(f,"right")&&(g=s.right-p.right+Pe(T,"right")),g||y)if(c)b.defaultView.scrollBy(g,y);else{let v=o.scrollLeft,S=o.scrollTop;y&&(o.scrollTop+=y),g&&(o.scrollLeft+=g);let O=o.scrollLeft-v,D=o.scrollTop-S;s={left:s.left-O,top:s.top-D,right:s.right-O,bottom:s.bottom-D}}if(c||/^(fixed|sticky)$/.test(getComputedStyle(l).position))break}}function qt(a){let s=[],u=a.ownerDocument;for(let f=a;f&&(s.push({dom:f,top:f.scrollTop,left:f.scrollLeft}),a!=u);f=ne(f));return s}function zt(a,s){for(let u=0;u<a.length;u++){let{dom:f,top:T,left:b}=a[u];f.scrollTop!=T+s&&(f.scrollTop=T+s),f.scrollLeft!=b&&(f.scrollLeft=b)}}let At=null;function Jt(a,s){let u,T,c,p,f=2e8,b=0,l=s.top,o=s.top;for(let g=a.firstChild,y=0;g;g=g.nextSibling,y++){let v;if(1==g.nodeType)v=g.getClientRects();else{if(3!=g.nodeType)continue;v=Le(g).getClientRects()}for(let S=0;S<v.length;S++){let O=v[S];if(O.top<=l&&O.bottom>=o){l=Math.max(O.bottom,l),o=Math.min(O.top,o);let D=O.left>s.left?O.left-s.left:O.right<s.left?s.left-O.right:0;if(D<f){u=g,f=D,T=D&&3==u.nodeType?{left:O.right<s.left?O.right:O.left,top:s.top}:s,1==g.nodeType&&D&&(b=y+(s.left>=(O.left+O.right)/2?1:0));continue}}else O.top>s.top&&!c&&O.left<=s.left&&O.right>=s.left&&(c=g,p={left:Math.max(O.left,Math.min(O.right,s.left)),top:O.top});!u&&(s.left>=O.right&&s.top>=O.top||s.left>=O.left&&s.top>=O.bottom)&&(b=y+1)}}return!u&&c&&(u=c,T=p,f=0),u&&3==u.nodeType?function Xt(a,s){let u=a.nodeValue.length,f=document.createRange();for(let T=0;T<u;T++){f.setEnd(a,T+1),f.setStart(a,T);let b=mt(f,1);if(b.top!=b.bottom&&hn(s,b))return{node:a,offset:T+(s.left>=(b.left+b.right)/2?1:0)}}return{node:a,offset:0}}(u,T):!u||f&&1==u.nodeType?{node:a,offset:b}:Jt(u,T)}function hn(a,s){return a.left>=s.left-1&&a.left<=s.right+1&&a.top>=s.top-1&&a.top<=s.bottom+1}function bn(a,s,u){let f=a.childNodes.length;if(f&&u.top<u.bottom)for(let T=Math.max(0,Math.min(f-1,Math.floor(f*(s.top-u.top)/(u.bottom-u.top))-2)),b=T;;){let l=a.childNodes[b];if(1==l.nodeType){let o=l.getClientRects();for(let c=0;c<o.length;c++){let p=o[c];if(hn(s,p))return bn(l,s,p)}}if((b=(b+1)%f)==T)break}return a}function en(a,s){let f,u=a.dom.ownerDocument,T=0,b=function Ce(a,s,u){if(a.caretPositionFromPoint)try{let f=a.caretPositionFromPoint(s,u);if(f)return{node:f.offsetNode,offset:f.offset}}catch{}if(a.caretRangeFromPoint){let f=a.caretRangeFromPoint(s,u);if(f)return{node:f.startContainer,offset:f.startOffset}}}(u,s.left,s.top);b&&({node:f,offset:T}=b);let o,l=(a.root.elementFromPoint?a.root:u).elementFromPoint(s.left,s.top);if(!l||!a.dom.contains(1!=l.nodeType?l.parentNode:l)){let p=a.dom.getBoundingClientRect();if(!hn(s,p)||(l=bn(a.dom,s,p),!l))return null}if(de)for(let p=l;f&&p;p=ne(p))p.draggable&&(f=void 0);if(l=function It(a,s){let u=a.parentNode;return u&&/^li$/i.test(u.nodeName)&&s.left<a.getBoundingClientRect().left?u:a}(l,s),f){if(qe&&1==f.nodeType&&(T=Math.min(T,f.childNodes.length),T<f.childNodes.length)){let y,g=f.childNodes[T];"IMG"==g.nodeName&&(y=g.getBoundingClientRect()).right<=s.left&&y.bottom>s.top&&T++}let p;he&&T&&1==f.nodeType&&1==(p=f.childNodes[T-1]).nodeType&&"false"==p.contentEditable&&p.getBoundingClientRect().top>=s.top&&T--,f==a.dom&&T==f.childNodes.length-1&&1==f.lastChild.nodeType&&s.top>f.lastChild.getBoundingClientRect().bottom?o=a.state.doc.content.size:(0==T||1!=f.nodeType||"BR"!=f.childNodes[T-1].nodeName)&&(o=function Yt(a,s,u,f){let T=-1;for(let b=s,l=!1;b!=a.dom;){let o=a.docView.nearestDesc(b,!0);if(!o)return null;if(1==o.dom.nodeType&&(o.node.isBlock&&o.parent&&!l||!o.contentDOM)){let c=o.dom.getBoundingClientRect();if(o.node.isBlock&&o.parent&&!l&&(l=!0,c.left>f.left||c.top>f.top?T=o.posBefore:(c.right<f.left||c.bottom<f.top)&&(T=o.posAfter)),!o.contentDOM&&T<0&&!o.node.isText)return(o.node.isBlock?f.top<(c.top+c.bottom)/2:f.left<(c.left+c.right)/2)?o.posBefore:o.posAfter}b=o.dom.parentNode}return T>-1?T:a.docView.posFromDOM(s,u,-1)}(a,f,T,s))}null==o&&(o=function Kt(a,s,u){let{node:f,offset:T}=Jt(s,u),b=-1;if(1==f.nodeType&&!f.firstChild){let l=f.getBoundingClientRect();b=l.left!=l.right&&u.left>(l.left+l.right)/2?1:-1}return a.docView.posFromDOM(f,T,b)}(a,l,s));let c=a.docView.nearestDesc(l,!0);return{pos:o,inside:c?c.posAtStart-c.border:-1}}function Gt(a){return a.top<a.bottom||a.left<a.right}function mt(a,s){let u=a.getClientRects();if(u.length){let f=u[s<0?0:u.length-1];if(Gt(f))return f}return Array.prototype.find.call(u,Gt)||a.getBoundingClientRect()}const qn=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function tn(a,s,u){let{node:f,offset:T,atom:b}=a.docView.domFromPos(s,u<0?-1:1),l=he||qe;if(3==f.nodeType){if(!l||!qn.test(f.nodeValue)&&(u<0?T:T!=f.nodeValue.length)){let c=T,p=T,g=u<0?1:-1;return u<0&&!T?(p++,g=-1):u>=0&&T==f.nodeValue.length?(c--,g=1):u<0?c--:p++,wt(mt(Le(f,c,p),g),g<0)}{let c=mt(Le(f,T,T),u);if(qe&&T&&/\s/.test(f.nodeValue[T-1])&&T<f.nodeValue.length){let p=mt(Le(f,T-1,T-1),-1);if(p.top==c.top){let g=mt(Le(f,T,T+1),-1);if(g.top!=c.top)return wt(g,g.left<p.left)}}return c}}if(!a.state.doc.resolve(s-(b||0)).parent.inlineContent){if(null==b&&T&&(u<0||T==Se(f))){let c=f.childNodes[T-1];if(1==c.nodeType)return nn(c.getBoundingClientRect(),!1)}if(null==b&&T<Se(f)){let c=f.childNodes[T];if(1==c.nodeType)return nn(c.getBoundingClientRect(),!0)}return nn(f.getBoundingClientRect(),u>=0)}if(null==b&&T&&(u<0||T==Se(f))){let c=f.childNodes[T-1],p=3==c.nodeType?Le(c,Se(c)-(l?0:1)):1!=c.nodeType||"BR"==c.nodeName&&c.nextSibling?null:c;if(p)return wt(mt(p,1),!1)}if(null==b&&T<Se(f)){let c=f.childNodes[T];for(;c.pmViewDesc&&c.pmViewDesc.ignoreForCoords;)c=c.nextSibling;let p=c?3==c.nodeType?Le(c,0,l?0:1):1==c.nodeType?c:null:null;if(p)return wt(mt(p,-1),!0)}return wt(mt(3==f.nodeType?Le(f):f,-u),u>=0)}function wt(a,s){if(0==a.width)return a;let u=s?a.left:a.right;return{top:a.top,bottom:a.bottom,left:u,right:u}}function nn(a,s){if(0==a.height)return a;let u=s?a.top:a.bottom;return{top:u,bottom:u,left:a.left,right:a.right}}function Dt(a,s,u){let f=a.state,T=a.root.activeElement;f!=s&&a.updateState(s),T!=a.dom&&a.focus();try{return u()}finally{f!=s&&a.updateState(f),T!=a.dom&&T&&T.focus()}}const St=/[\u0590-\u08ac]/;let $t=null,K=null,w=!1;class te{constructor(s,u,f,T){this.parent=s,this.children=u,this.dom=f,this.contentDOM=T,this.dirty=0,f.pmViewDesc=this}matchesWidget(s){return!1}matchesMark(s){return!1}matchesNode(s,u,f){return!1}matchesHack(s){return!1}parseRule(){return null}stopEvent(s){return!1}get size(){let s=0;for(let u=0;u<this.children.length;u++)s+=this.children[u].size;return s}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let s=0;s<this.children.length;s++)this.children[s].destroy()}posBeforeChild(s){for(let u=0,f=this.posAtStart;;u++){let T=this.children[u];if(T==s)return f;f+=T.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(s,u,f){if(this.contentDOM&&this.contentDOM.contains(1==s.nodeType?s:s.parentNode)){if(f<0){let b,l;if(s==this.contentDOM)b=s.childNodes[u-1];else{for(;s.parentNode!=this.contentDOM;)s=s.parentNode;b=s.previousSibling}for(;b&&(!(l=b.pmViewDesc)||l.parent!=this);)b=b.previousSibling;return b?this.posBeforeChild(l)+l.size:this.posAtStart}{let b,l;if(s==this.contentDOM)b=s.childNodes[u];else{for(;s.parentNode!=this.contentDOM;)s=s.parentNode;b=s.nextSibling}for(;b&&(!(l=b.pmViewDesc)||l.parent!=this);)b=b.nextSibling;return b?this.posBeforeChild(l):this.posAtEnd}}let T;if(s==this.dom&&this.contentDOM)T=u>le(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))T=2&s.compareDocumentPosition(this.contentDOM);else if(this.dom.firstChild){if(0==u)for(let b=s;;b=b.parentNode){if(b==this.dom){T=!1;break}if(b.previousSibling)break}if(null==T&&u==s.childNodes.length)for(let b=s;;b=b.parentNode){if(b==this.dom){T=!0;break}if(b.nextSibling)break}}return T??f>0?this.posAtEnd:this.posAtStart}nearestDesc(s,u=!1){for(let f=!0,T=s;T;T=T.parentNode){let l,b=this.getDesc(T);if(b&&(!u||b.node)){if(!f||!(l=b.nodeDOM)||(1==l.nodeType?l.contains(1==s.nodeType?s:s.parentNode):l==s))return b;f=!1}}}getDesc(s){let u=s.pmViewDesc;for(let f=u;f;f=f.parent)if(f==this)return u}posFromDOM(s,u,f){for(let T=s;T;T=T.parentNode){let b=this.getDesc(T);if(b)return b.localPosFromDOM(s,u,f)}return-1}descAt(s){for(let u=0,f=0;u<this.children.length;u++){let T=this.children[u],b=f+T.size;if(f==s&&b!=f){for(;!T.border&&T.children.length;)T=T.children[0];return T}if(s<b)return T.descAt(s-f-T.border);f=b}}domFromPos(s,u){if(!this.contentDOM)return{node:this.dom,offset:0,atom:s+1};let f=0,T=0;for(let b=0;f<this.children.length;f++){let l=this.children[f],o=b+l.size;if(o>s||l instanceof L){T=s-b;break}b=o}if(T)return this.children[f].domFromPos(T-this.children[f].border,u);for(let b;f&&!(b=this.children[f-1]).size&&b instanceof R&&b.side>=0;f--);if(u<=0){let b,l=!0;for(;b=f?this.children[f-1]:null,b&&b.dom.parentNode!=this.contentDOM;f--,l=!1);return b&&u&&l&&!b.border&&!b.domAtom?b.domFromPos(b.size,u):{node:this.contentDOM,offset:b?le(b.dom)+1:0}}{let b,l=!0;for(;b=f<this.children.length?this.children[f]:null,b&&b.dom.parentNode!=this.contentDOM;f++,l=!1);return b&&l&&!b.border&&!b.domAtom?b.domFromPos(0,u):{node:this.contentDOM,offset:b?le(b.dom):this.contentDOM.childNodes.length}}}parseRange(s,u,f=0){if(0==this.children.length)return{node:this.contentDOM,from:s,to:u,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let T=-1,b=-1;for(let l=f,o=0;;o++){let c=this.children[o],p=l+c.size;if(-1==T&&s<=p){let g=l+c.border;if(s>=g&&u<=p-c.border&&c.node&&c.contentDOM&&this.contentDOM.contains(c.contentDOM))return c.parseRange(s,u,g);s=l;for(let y=o;y>0;y--){let v=this.children[y-1];if(v.size&&v.dom.parentNode==this.contentDOM&&!v.emptyChildAt(1)){T=le(v.dom)+1;break}s-=v.size}-1==T&&(T=0)}if(T>-1&&(p>u||o==this.children.length-1)){u=p;for(let g=o+1;g<this.children.length;g++){let y=this.children[g];if(y.size&&y.dom.parentNode==this.contentDOM&&!y.emptyChildAt(-1)){b=le(y.dom);break}u+=y.size}-1==b&&(b=this.contentDOM.childNodes.length);break}l=p}return{node:this.contentDOM,from:s,to:u,fromOffset:T,toOffset:b}}emptyChildAt(s){if(this.border||!this.contentDOM||!this.children.length)return!1;let u=this.children[s<0?0:this.children.length-1];return 0==u.size||u.emptyChildAt(s)}domAfterPos(s){let{node:u,offset:f}=this.domFromPos(s,0);if(1!=u.nodeType||f==u.childNodes.length)throw new RangeError("No node after pos "+s);return u.childNodes[f]}setSelection(s,u,f,T=!1){let b=Math.min(s,u),l=Math.max(s,u);for(let v=0,S=0;v<this.children.length;v++){let O=this.children[v],D=S+O.size;if(b>S&&l<D)return O.setSelection(s-S-O.border,u-S-O.border,f,T);S=D}let o=this.domFromPos(s,s?-1:1),c=u==s?o:this.domFromPos(u,u?-1:1),p=f.getSelection(),g=!1;if((qe||de)&&s==u){let{node:v,offset:S}=o;if(3==v.nodeType){if(g=!(!S||"\n"!=v.nodeValue[S-1]),g&&S==v.nodeValue.length)for(let D,O=v;O;O=O.parentNode){if(D=O.nextSibling){"BR"==D.nodeName&&(o=c={node:D.parentNode,offset:le(D)+1});break}let H=O.pmViewDesc;if(H&&H.node&&H.node.isBlock)break}}else{let O=v.childNodes[S-1];g=O&&("BR"==O.nodeName||"false"==O.contentEditable)}}if(qe&&p.focusNode&&p.focusNode!=c.node&&1==p.focusNode.nodeType){let v=p.focusNode.childNodes[p.focusOffset];v&&"false"==v.contentEditable&&(T=!0)}if(!(T||g&&de)&&Ae(o.node,o.offset,p.anchorNode,p.anchorOffset)&&Ae(c.node,c.offset,p.focusNode,p.focusOffset))return;let y=!1;if((p.extend||s==u)&&!g){p.collapse(o.node,o.offset);try{s!=u&&p.extend(c.node,c.offset),y=!0}catch{}}if(!y){if(s>u){let S=o;o=c,c=S}let v=document.createRange();v.setEnd(c.node,c.offset),v.setStart(o.node,o.offset),p.removeAllRanges(),p.addRange(v)}}ignoreMutation(s){return!this.contentDOM&&"selection"!=s.type}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(s,u){for(let f=0,T=0;T<this.children.length;T++){let b=this.children[T],l=f+b.size;if(f==l?s<=l&&u>=f:s<l&&u>f){let o=f+b.border,c=l-b.border;if(s>=o&&u<=c)return this.dirty=s==f||u==l?2:1,void(s!=o||u!=c||!b.contentLost&&b.dom.parentNode==this.contentDOM?b.markDirty(s-o,u-o):b.dirty=3);b.dirty=b.dom!=b.contentDOM||b.dom.parentNode!=this.contentDOM||b.children.length?3:2}f=l}this.dirty=2}markParentsDirty(){let s=1;for(let u=this.parent;u;u=u.parent,s++){let f=1==s?2:1;u.dirty<f&&(u.dirty=f)}}get domAtom(){return!1}get ignoreForCoords(){return!1}}class R extends te{constructor(s,u,f,T){let b,l=u.type.toDOM;if("function"==typeof l&&(l=l(f,()=>b?b.parent?b.parent.posBeforeChild(b):void 0:T)),!u.type.spec.raw){if(1!=l.nodeType){let o=document.createElement("span");o.appendChild(l),l=o}l.contentEditable="false",l.classList.add("ProseMirror-widget")}super(s,[],l,null),this.widget=u,this.widget=u,b=this}matchesWidget(s){return 0==this.dirty&&s.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(s){let u=this.widget.spec.stopEvent;return!!u&&u(s)}ignoreMutation(s){return"selection"!=s.type||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get side(){return this.widget.type.side}}class d extends te{constructor(s,u,f,T){super(s,[],u,null),this.textDOM=f,this.text=T}get size(){return this.text.length}localPosFromDOM(s,u){return s!=this.textDOM?this.posAtStart+(u?this.size:0):this.posAtStart+u}domFromPos(s){return{node:this.textDOM,offset:s}}ignoreMutation(s){return"characterData"===s.type&&s.target.nodeValue==s.oldValue}}class m extends te{constructor(s,u,f,T){super(s,[],f,T),this.mark=u}static create(s,u,f,T){let b=T.nodeViews[u.type.name],l=b&&b(u,T,f);return(!l||!l.dom)&&(l=Te.PW.renderSpec(document,u.type.spec.toDOM(u,f))),new m(s,u,l.dom,l.contentDOM||l.dom)}parseRule(){return 3&this.dirty||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(s){return 3!=this.dirty&&this.mark.eq(s)}markDirty(s,u){if(super.markDirty(s,u),0!=this.dirty){let f=this.parent;for(;!f.node;)f=f.parent;f.dirty<this.dirty&&(f.dirty=this.dirty),this.dirty=0}}slice(s,u,f){let T=m.create(this.parent,this.mark,!0,f),b=this.children,l=this.size;u<l&&(b=on(b,u,l,f)),s>0&&(b=on(b,0,s,f));for(let o=0;o<b.length;o++)b[o].parent=T;return T.children=b,T}}class x extends te{constructor(s,u,f,T,b,l,o,c,p){super(s,[],b,l),this.node=u,this.outerDeco=f,this.innerDeco=T,this.nodeDOM=o}static create(s,u,f,T,b,l){let c,o=b.nodeViews[u.type.name],p=o&&o(u,b,()=>c?c.parent?c.parent.posBeforeChild(c):void 0:l,f,T),g=p&&p.dom,y=p&&p.contentDOM;if(u.isText)if(g){if(3!=g.nodeType)throw new RangeError("Text must be rendered as a DOM text node")}else g=document.createTextNode(u.text);else g||({dom:g,contentDOM:y}=Te.PW.renderSpec(document,u.type.spec.toDOM(u)));!y&&!u.isText&&"BR"!=g.nodeName&&(g.hasAttribute("contenteditable")||(g.contentEditable="false"),u.type.spec.draggable&&(g.draggable=!0));let v=g;return g=Ci(g,f,u),p?c=new W(s,u,f,T,g,y||null,v,p,b,l+1):u.isText?new A(s,u,f,T,g,v,b):new x(s,u,f,T,g,y||null,v,b,l+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let s={node:this.node.type.name,attrs:this.node.attrs};if("pre"==this.node.type.whitespace&&(s.preserveWhitespace="full"),this.contentDOM)if(this.contentLost){for(let u=this.children.length-1;u>=0;u--){let f=this.children[u];if(this.dom.contains(f.dom.parentNode)){s.contentElement=f.dom.parentNode;break}}s.contentElement||(s.getContent=()=>Te.HY.empty)}else s.contentElement=this.contentDOM;else s.getContent=()=>this.node.content;return s}matchesNode(s,u,f){return 0==this.dirty&&s.eq(this.node)&&Xn(u,this.outerDeco)&&f.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(s,u){let f=this.node.inlineContent,T=u,b=s.composing?this.localCompositionInfo(s,u):null,l=b&&b.pos>-1?b:null,o=b&&b.pos<0,c=new _o(this,l&&l.node,s);(function ei(a,s,u,f){let T=s.locals(a),b=0;if(0==T.length){for(let p=0;p<a.childCount;p++){let g=a.child(p);f(g,T,s.forChild(b,g),p),b+=g.nodeSize}return}let l=0,o=[],c=null;for(let p=0;;){let g,y,v,S;for(;l<T.length&&T[l].to==b;){let H=T[l++];H.widget&&(g?(y||(y=[g])).push(H):g=H)}if(g)if(y){y.sort(bi);for(let H=0;H<y.length;H++)u(y[H],p,!!c)}else u(g,p,!!c);if(c)S=-1,v=c,c=null;else{if(!(p<a.childCount))break;S=p,v=a.child(p++)}for(let H=0;H<o.length;H++)o[H].to<=b&&o.splice(H--,1);for(;l<T.length&&T[l].from<=b&&T[l].to>b;)o.push(T[l++]);let O=b+v.nodeSize;if(v.isText){let H=O;l<T.length&&T[l].from<H&&(H=T[l].from);for(let $=0;$<o.length;$++)o[$].to<H&&(H=o[$].to);H<O&&(c=v.cut(H-b),v=v.cut(0,H-b),O=H,S=-1)}else for(;l<T.length&&T[l].to<O;)l++;f(v,v.isInline&&!v.isLeaf?o.filter(H=>!H.inline):o.slice(),s.forChild(b,v),S),b=O}})(this.node,this.innerDeco,(p,g,y)=>{p.spec.marks?c.syncToMarks(p.spec.marks,f,s):p.type.side>=0&&!y&&c.syncToMarks(g==this.node.childCount?Te.vc.none:this.node.child(g).marks,f,s),c.placeWidget(p,s,T)},(p,g,y,v)=>{let S;c.syncToMarks(p.marks,f,s),c.findNodeMatch(p,g,y,v)||o&&s.state.selection.from>T&&s.state.selection.to<T+p.nodeSize&&(S=c.findIndexWithChild(b.node))>-1&&c.updateNodeAt(p,g,y,S,s)||c.updateNextNode(p,g,y,s,v,T)||c.addNode(p,g,y,s,T),T+=p.nodeSize}),c.syncToMarks([],f,s),this.node.isTextblock&&c.addTextblockHacks(),c.destroyRest(),(c.changed||2==this.dirty)&&(l&&this.protectLocalComposition(s,l),q(this.contentDOM,this.children,s),B&&function vn(a){if("UL"==a.nodeName||"OL"==a.nodeName){let s=a.style.cssText;a.style.cssText=s+"; list-style: square !important",window.getComputedStyle(a),a.style.cssText=s}}(this.dom))}localCompositionInfo(s,u){let{from:f,to:T}=s.state.selection;if(!(s.state.selection instanceof z.Bs)||f<u||T>u+this.node.content.size)return null;let b=s.domSelectionRange(),l=function zi(a,s){for(;;){if(3==a.nodeType)return a;if(1==a.nodeType&&s>0){if(a.childNodes.length>s&&3==a.childNodes[s].nodeType)return a.childNodes[s];s=Se(a=a.childNodes[s-1])}else{if(!(1==a.nodeType&&s<a.childNodes.length))return null;a=a.childNodes[s],s=0}}}(b.focusNode,b.focusOffset);if(!l||!this.dom.contains(l.parentNode))return null;if(this.node.inlineContent){let o=l.nodeValue,c=function ti(a,s,u,f){for(let T=0,b=0;T<a.childCount&&b<=f;){let l=a.child(T++),o=b;if(b+=l.nodeSize,!l.isText)continue;let c=l.text;for(;T<a.childCount;){let p=a.child(T++);if(b+=p.nodeSize,!p.isText)break;c+=p.text}if(b>=u){if(b>=f&&c.slice(f-s.length-o,f-o)==s)return f-s.length;let p=o<f?c.lastIndexOf(s,f-o-1):-1;if(p>=0&&p+s.length+o>=u)return o+p;if(u==f&&c.length>=f+s.length-o&&c.slice(f-o,f-o+s.length)==s)return f}}return-1}(this.node.content,o,f-u,T-u);return c<0?null:{node:l,pos:c,text:o}}return{node:l,pos:-1,text:""}}protectLocalComposition(s,{node:u,pos:f,text:T}){if(this.getDesc(u))return;let b=u;for(;b.parentNode!=this.contentDOM;b=b.parentNode){for(;b.previousSibling;)b.parentNode.removeChild(b.previousSibling);for(;b.nextSibling;)b.parentNode.removeChild(b.nextSibling);b.pmViewDesc&&(b.pmViewDesc=void 0)}let l=new d(this,b,u,T);s.input.compositionNodes.push(l),this.children=on(this.children,f,f+T.length,s,l)}update(s,u,f,T){return!(3==this.dirty||!s.sameMarkup(this.node)||(this.updateInner(s,u,f,T),0))}updateInner(s,u,f,T){this.updateOuterDeco(u),this.node=s,this.innerDeco=f,this.contentDOM&&this.updateChildren(T,this.posAtStart),this.dirty=0}updateOuterDeco(s){if(Xn(s,this.outerDeco))return;let u=1!=this.nodeDOM.nodeType,f=this.dom;this.dom=mn(this.dom,this.nodeDOM,Ge(this.outerDeco,this.node,u),Ge(s,this.node,u)),this.dom!=f&&(f.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=s}selectNode(){1==this.nodeDOM.nodeType&&this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.dom.draggable=!0)}deselectNode(){1==this.nodeDOM.nodeType&&this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.dom.removeAttribute("draggable")}get domAtom(){return this.node.isAtom}}function M(a,s,u,f,T){Ci(f,s,a);let b=new x(void 0,a,s,u,f,f,f,T,0);return b.contentDOM&&b.updateChildren(T,0),b}class A extends x{constructor(s,u,f,T,b,l,o){super(s,u,f,T,b,null,l,o,0)}parseRule(){let s=this.nodeDOM.parentNode;for(;s&&s!=this.dom&&!s.pmIsDeco;)s=s.parentNode;return{skip:s||!0}}update(s,u,f,T){return!(3==this.dirty||0!=this.dirty&&!this.inParent()||!s.sameMarkup(this.node)||(this.updateOuterDeco(u),(0!=this.dirty||s.text!=this.node.text)&&s.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=s.text,T.trackWrites==this.nodeDOM&&(T.trackWrites=null)),this.node=s,this.dirty=0,0))}inParent(){let s=this.parent.contentDOM;for(let u=this.nodeDOM;u;u=u.parentNode)if(u==s)return!0;return!1}domFromPos(s){return{node:this.nodeDOM,offset:s}}localPosFromDOM(s,u,f){return s==this.nodeDOM?this.posAtStart+Math.min(u,this.node.text.length):super.localPosFromDOM(s,u,f)}ignoreMutation(s){return"characterData"!=s.type&&"selection"!=s.type}slice(s,u,f){let T=this.node.cut(s,u),b=document.createTextNode(T.text);return new A(this.parent,T,this.outerDeco,this.innerDeco,b,b,f)}markDirty(s,u){super.markDirty(s,u),this.dom!=this.nodeDOM&&(0==s||u==this.nodeDOM.nodeValue.length)&&(this.dirty=3)}get domAtom(){return!1}}class L extends te{parseRule(){return{ignore:!0}}matchesHack(s){return 0==this.dirty&&this.dom.nodeName==s}get domAtom(){return!0}get ignoreForCoords(){return"IMG"==this.dom.nodeName}}class W extends x{constructor(s,u,f,T,b,l,o,c,p,g){super(s,u,f,T,b,l,o,p,g),this.spec=c}update(s,u,f,T){if(3==this.dirty)return!1;if(this.spec.update){let b=this.spec.update(s,u,f);return b&&this.updateInner(s,u,f,T),b}return!(!this.contentDOM&&!s.isLeaf)&&super.update(s,u,f,T)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(s,u,f,T){this.spec.setSelection?this.spec.setSelection(s,u,f):super.setSelection(s,u,f,T)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(s){return!!this.spec.stopEvent&&this.spec.stopEvent(s)}ignoreMutation(s){return this.spec.ignoreMutation?this.spec.ignoreMutation(s):super.ignoreMutation(s)}}function q(a,s,u){let f=a.firstChild,T=!1;for(let b=0;b<s.length;b++){let l=s[b],o=l.dom;if(o.parentNode==a){for(;o!=f;)f=Bn(f),T=!0;f=f.nextSibling}else T=!0,a.insertBefore(o,f);if(l instanceof m){let c=f?f.previousSibling:a.lastChild;q(l.contentDOM,l.children,u),f=c?c.nextSibling:a.firstChild}}for(;f;)f=Bn(f),T=!0;T&&u.trackWrites==a&&(u.trackWrites=null)}const pe=function(a){a&&(this.nodeName=a)};pe.prototype=Object.create(null);const ge=[new pe];function Ge(a,s,u){if(0==a.length)return ge;let f=u?ge[0]:new pe,T=[f];for(let b=0;b<a.length;b++){let l=a[b].type.attrs;if(l){l.nodeName&&T.push(f=new pe(l.nodeName));for(let o in l){let c=l[o];null!=c&&(u&&1==T.length&&T.push(f=new pe(s.isInline?"span":"div")),"class"==o?f.class=(f.class?f.class+" ":"")+c:"style"==o?f.style=(f.style?f.style+";":"")+c:"nodeName"!=o&&(f[o]=c))}}}return T}function mn(a,s,u,f){if(u==ge&&f==ge)return s;let T=s;for(let b=0;b<f.length;b++){let l=f[b],o=u[b];if(b){let c;o&&o.nodeName==l.nodeName&&T!=a&&(c=T.parentNode)&&c.nodeName.toLowerCase()==l.nodeName||(c=document.createElement(l.nodeName),c.pmIsDeco=!0,c.appendChild(T),o=ge[0]),T=c}yn(T,o||ge[0],l)}return T}function yn(a,s,u){for(let f in s)"class"!=f&&"style"!=f&&"nodeName"!=f&&!(f in u)&&a.removeAttribute(f);for(let f in u)"class"!=f&&"style"!=f&&"nodeName"!=f&&u[f]!=s[f]&&a.setAttribute(f,u[f]);if(s.class!=u.class){let f=s.class?s.class.split(" ").filter(Boolean):[],T=u.class?u.class.split(" ").filter(Boolean):[];for(let b=0;b<f.length;b++)-1==T.indexOf(f[b])&&a.classList.remove(f[b]);for(let b=0;b<T.length;b++)-1==f.indexOf(T[b])&&a.classList.add(T[b]);0==a.classList.length&&a.removeAttribute("class")}if(s.style!=u.style){if(s.style){let T,f=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g;for(;T=f.exec(s.style);)a.style.removeProperty(T[1])}u.style&&(a.style.cssText+=u.style)}}function Ci(a,s,u){return mn(a,a,ge,Ge(s,u,1!=a.nodeType))}function Xn(a,s){if(a.length!=s.length)return!1;for(let u=0;u<a.length;u++)if(!a[u].type.eq(s[u].type))return!1;return!0}function Bn(a){let s=a.nextSibling;return a.parentNode.removeChild(a),s}class _o{constructor(s,u,f){this.lock=u,this.view=f,this.index=0,this.stack=[],this.changed=!1,this.top=s,this.preMatch=function To(a,s){let u=s,f=u.children.length,T=a.childCount,b=new Map,l=[];e:for(;T>0;){let o;for(;;)if(f){let p=u.children[f-1];if(!(p instanceof m)){o=p,f--;break}u=p,f=p.children.length}else{if(u==s)break e;f=u.parent.children.indexOf(u),u=u.parent}let c=o.node;if(c){if(c!=a.child(T-1))break;--T,b.set(o,T),l.push(o)}}return{index:T,matched:b,matches:l.reverse()}}(s.node.content,s)}destroyBetween(s,u){if(s!=u){for(let f=s;f<u;f++)this.top.children[f].destroy();this.top.children.splice(s,u-s),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(s,u,f){let T=0,b=this.stack.length>>1,l=Math.min(b,s.length);for(;T<l&&(T==b-1?this.top:this.stack[T+1<<1]).matchesMark(s[T])&&!1!==s[T].type.spec.spanning;)T++;for(;T<b;)this.destroyRest(),this.top.dirty=0,this.index=this.stack.pop(),this.top=this.stack.pop(),b--;for(;b<s.length;){this.stack.push(this.top,this.index+1);let o=-1;for(let c=this.index;c<Math.min(this.index+3,this.top.children.length);c++){let p=this.top.children[c];if(p.matchesMark(s[b])&&!this.isLocked(p.dom)){o=c;break}}if(o>-1)o>this.index&&(this.changed=!0,this.destroyBetween(this.index,o)),this.top=this.top.children[this.index];else{let c=m.create(this.top,s[b],u,f);this.top.children.splice(this.index,0,c),this.top=c,this.changed=!0}this.index=0,b++}}findNodeMatch(s,u,f,T){let l,b=-1;if(T>=this.preMatch.index&&(l=this.preMatch.matches[T-this.preMatch.index]).parent==this.top&&l.matchesNode(s,u,f))b=this.top.children.indexOf(l,this.index);else for(let o=this.index,c=Math.min(this.top.children.length,o+5);o<c;o++){let p=this.top.children[o];if(p.matchesNode(s,u,f)&&!this.preMatch.matched.has(p)){b=o;break}}return!(b<0||(this.destroyBetween(this.index,b),this.index++,0))}updateNodeAt(s,u,f,T,b){let l=this.top.children[T];return 3==l.dirty&&l.dom==l.contentDOM&&(l.dirty=2),!!l.update(s,u,f,b)&&(this.destroyBetween(this.index,T),this.index++,!0)}findIndexWithChild(s){for(;;){let u=s.parentNode;if(!u)return-1;if(u==this.top.contentDOM){let f=s.pmViewDesc;if(f)for(let T=this.index;T<this.top.children.length;T++)if(this.top.children[T]==f)return T;return-1}s=u}}updateNextNode(s,u,f,T,b,l){for(let o=this.index;o<this.top.children.length;o++){let c=this.top.children[o];if(c instanceof x){let p=this.preMatch.matched.get(c);if(null!=p&&p!=b)return!1;let y,g=c.dom,v=this.isLocked(g)&&!(s.isText&&c.node&&c.node.isText&&c.nodeDOM.nodeValue==s.text&&3!=c.dirty&&Xn(u,c.outerDeco));if(!v&&c.update(s,u,f,T))return this.destroyBetween(this.index,o),c.dom!=g&&(this.changed=!0),this.index++,!0;if(!v&&(y=this.recreateWrapper(c,s,u,f,T,l)))return this.top.children[this.index]=y,y.contentDOM&&(y.dirty=2,y.updateChildren(T,l+1),y.dirty=0),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(s,u,f,T,b,l){if(s.dirty||u.isAtom||!s.children.length||!s.node.content.eq(u.content))return null;let o=x.create(this.top,u,f,T,b,l);if(o.contentDOM){o.children=s.children,s.children=[];for(let c of o.children)c.parent=o}return s.destroy(),o}addNode(s,u,f,T,b){let l=x.create(this.top,s,u,f,T,b);l.contentDOM&&l.updateChildren(T,b+1),this.top.children.splice(this.index++,0,l),this.changed=!0}placeWidget(s,u,f){let T=this.index<this.top.children.length?this.top.children[this.index]:null;if(!T||!T.matchesWidget(s)||s!=T.widget&&T.widget.type.toDOM.parentNode){let b=new R(this.top,s,u,f);this.top.children.splice(this.index++,0,b),this.changed=!0}else this.index++}addTextblockHacks(){let s=this.top.children[this.index-1],u=this.top;for(;s instanceof m;)u=s,s=u.children[u.children.length-1];(!s||!(s instanceof A)||/\n$/.test(s.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(s.node.text))&&((de||We)&&s&&"false"==s.dom.contentEditable&&this.addHackNode("IMG",u),this.addHackNode("BR",this.top))}addHackNode(s,u){if(u==this.top&&this.index<u.children.length&&u.children[this.index].matchesHack(s))this.index++;else{let f=document.createElement(s);"IMG"==s&&(f.className="ProseMirror-separator",f.alt=""),"BR"==s&&(f.className="ProseMirror-trailingBreak");let T=new L(this.top,[],f,null);u!=this.top?u.children.push(T):u.children.splice(this.index++,0,T),this.changed=!0}}isLocked(s){return this.lock&&(s==this.lock||1==s.nodeType&&s.contains(this.lock.parentNode))}}function bi(a,s){return a.type.side-s.type.side}function on(a,s,u,f,T){let b=[];for(let l=0,o=0;l<a.length;l++){let c=a[l],p=o,g=o+=c.size;p>=u||g<=s?b.push(c):(p<s&&b.push(c.slice(0,s-p,f)),T&&(b.push(T),T=void 0),g>u&&b.push(c.slice(u-p,c.size,f)))}return b}function Mt(a,s=null){let u=a.domSelectionRange(),f=a.state.doc;if(!u.focusNode)return null;let T=a.docView.nearestDesc(u.focusNode),b=T&&0==T.size,l=a.docView.posFromDOM(u.focusNode,u.focusOffset,1);if(l<0)return null;let c,p,o=f.resolve(l);if(ze(u)){for(c=o;T&&!T.node;)T=T.parent;let g=T.node;if(T&&g.isAtom&&z.qv.isSelectable(g)&&T.parent&&(!g.isInline||!function Me(a,s,u){for(let f=0==s,T=s==Se(a);f||T;){if(a==u)return!0;let b=le(a);if(!(a=a.parentNode))return!1;f=f&&0==b,T=T&&b==Se(a)}}(u.focusNode,u.focusOffset,T.dom))){let y=T.posBefore;p=new z.qv(l==y?o:f.resolve(y))}}else{let g=a.docView.posFromDOM(u.anchorNode,u.anchorOffset,1);if(g<0)return null;c=f.resolve(g)}return p||(p=$n(a,c,o,"pointer"==s||a.state.selection.head<o.pos&&!b?1:-1)),p}function zn(a){return a.editable?a.hasFocus():Wi(a)&&document.activeElement&&document.activeElement.contains(a.dom)}function ct(a,s=!1){let u=a.state.selection;if(Ui(a,u),zn(a)){if(!s&&a.input.mouseDown&&a.input.mouseDown.allowDefault&&We){let f=a.domSelectionRange(),T=a.domObserver.currentSelection;if(f.anchorNode&&T.anchorNode&&Ae(f.anchorNode,f.anchorOffset,T.anchorNode,T.anchorOffset))return a.input.mouseDown.delayedSelectionSync=!0,void a.domObserver.setCurSelection()}if(a.domObserver.disconnectSelection(),a.cursorWrapper)!function Co(a){let s=a.domSelection(),u=document.createRange(),f=a.cursorWrapper.dom,T="IMG"==f.nodeName;T?u.setEnd(f.parentNode,le(f)+1):u.setEnd(f,0),u.collapse(!1),s.removeAllRanges(),s.addRange(u),!T&&!a.state.selection.visible&&Fe&&st<=11&&(f.disabled=!0,f.disabled=!1)}(a);else{let b,l,{anchor:f,head:T}=u;ni&&!(u instanceof z.Bs)&&(u.$from.parent.inlineContent||(b=yi(a,u.from)),!u.empty&&!u.$from.parent.inlineContent&&(l=yi(a,u.to))),a.docView.setSelection(f,T,a.root,s),ni&&(b&&$i(b),l&&$i(l)),u.visible?a.dom.classList.remove("ProseMirror-hideselection"):(a.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&function Vi(a){let s=a.dom.ownerDocument;s.removeEventListener("selectionchange",a.input.hideSelectionGuard);let u=a.domSelectionRange(),f=u.anchorNode,T=u.anchorOffset;s.addEventListener("selectionchange",a.input.hideSelectionGuard=()=>{(u.anchorNode!=f||u.anchorOffset!=T)&&(s.removeEventListener("selectionchange",a.input.hideSelectionGuard),setTimeout(()=>{(!zn(a)||a.state.selection.visible)&&a.dom.classList.remove("ProseMirror-hideselection")},20))})}(a))}a.domObserver.setCurSelection(),a.domObserver.connectSelection()}}const ni=de||We&&Cn<63;function yi(a,s){let{node:u,offset:f}=a.docView.domFromPos(s,0),T=f<u.childNodes.length?u.childNodes[f]:null,b=f?u.childNodes[f-1]:null;if(de&&T&&"false"==T.contentEditable)return ii(T);if(!(T&&"false"!=T.contentEditable||b&&"false"!=b.contentEditable)){if(T)return ii(T);if(b)return ii(b)}}function ii(a){return a.contentEditable="true",de&&a.draggable&&(a.draggable=!1,a.wasDraggable=!0),a}function $i(a){a.contentEditable="false",a.wasDraggable&&(a.draggable=!0,a.wasDraggable=null)}function Ui(a,s){if(s instanceof z.qv){let u=a.docView.descAt(s.from);u!=a.lastSelectedViewDesc&&(ji(a),u&&u.selectNode(),a.lastSelectedViewDesc=u)}else ji(a)}function ji(a){a.lastSelectedViewDesc&&(a.lastSelectedViewDesc.parent&&a.lastSelectedViewDesc.deselectNode(),a.lastSelectedViewDesc=void 0)}function $n(a,s,u,f){return a.someProp("createSelectionBetween",T=>T(a,s,u))||z.Bs.between(s,u,f)}function vi(a){return!(a.editable&&!a.hasFocus())&&Wi(a)}function Wi(a){let s=a.domSelectionRange();if(!s.anchorNode)return!1;try{return a.dom.contains(3==s.anchorNode.nodeType?s.anchorNode.parentNode:s.anchorNode)&&(a.editable||a.dom.contains(3==s.focusNode.nodeType?s.focusNode.parentNode:s.focusNode))}catch{return!1}}function xi(a,s){let{$anchor:u,$head:f}=a.selection,T=s>0?u.max(f):u.min(f),b=T.parent.inlineContent?T.depth?a.doc.resolve(s>0?T.after():T.before()):null:T;return b&&z.Y1.findFrom(b,s)}function Et(a,s){return a.dispatch(a.state.tr.setSelection(s).scrollIntoView()),!0}function ki(a,s,u){let f=a.state.selection;if(!(f instanceof z.Bs)){if(f instanceof z.qv&&f.node.isInline)return Et(a,new z.Bs(s>0?f.$to:f.$from));{let T=xi(a.state,s);return!!T&&Et(a,T)}}if(u.indexOf("s")>-1){let{$head:T}=f,b=T.textOffset?null:s<0?T.nodeBefore:T.nodeAfter;if(!b||b.isText||!b.isLeaf)return!1;let l=a.state.doc.resolve(T.pos+b.nodeSize*(s<0?-1:1));return Et(a,new z.Bs(f.$anchor,l))}if(!f.empty)return!1;if(a.endOfTextblock(s>0?"forward":"backward")){let T=xi(a.state,s);return!!(T&&T instanceof z.qv)&&Et(a,T)}if(!(G&&u.indexOf("m")>-1)){let l,T=f.$head,b=T.textOffset?null:s<0?T.nodeBefore:T.nodeAfter;if(!b||b.isText)return!1;let o=s<0?T.pos-b.nodeSize:T.pos;return!!(b.isAtom||(l=a.docView.descAt(o))&&!l.contentDOM)&&(z.qv.isSelectable(b)?Et(a,new z.qv(s<0?a.state.doc.resolve(T.pos-b.nodeSize):T)):!!he&&Et(a,new z.Bs(a.state.doc.resolve(s<0?o:o+b.nodeSize))))}}function oi(a){return 3==a.nodeType?a.nodeValue.length:a.childNodes.length}function rn(a,s){let u=a.pmViewDesc;return u&&0==u.size&&(s<0||a.nextSibling||"BR"!=a.nodeName)}function pt(a,s){return s<0?function Ji(a){let s=a.domSelectionRange(),u=s.focusNode,f=s.focusOffset;if(!u)return;let T,b,l=!1;for(qe&&1==u.nodeType&&f<oi(u)&&rn(u.childNodes[f],-1)&&(l=!0);;)if(f>0){if(1!=u.nodeType)break;{let o=u.childNodes[f-1];if(rn(o,-1))T=u,b=--f;else{if(3!=o.nodeType)break;u=o,f=u.nodeValue.length}}}else{if(xn(u))break;{let o=u.previousSibling;for(;o&&rn(o,-1);)T=u.parentNode,b=le(o),o=o.previousSibling;if(o)u=o,f=oi(u);else{if(u=u.parentNode,u==a.dom)break;f=0}}}l?kn(a,u,f):T&&kn(a,T,b)}(a):function Vn(a){let s=a.domSelectionRange(),u=s.focusNode,f=s.focusOffset;if(!u)return;let b,l,T=oi(u);for(;;)if(f<T){if(1!=u.nodeType)break;if(!rn(u.childNodes[f],1))break;b=u,l=++f}else{if(xn(u))break;{let o=u.nextSibling;for(;o&&rn(o,1);)b=o.parentNode,l=le(o)+1,o=o.nextSibling;if(o)u=o,f=0,T=oi(u);else{if(u=u.parentNode,u==a.dom)break;f=T=0}}}b&&kn(a,b,l)}(a)}function xn(a){let s=a.pmViewDesc;return s&&s.node&&s.node.isBlock}function kn(a,s,u){if(3!=s.nodeType){let b,l;(l=function Vt(a,s){for(;a&&s==a.childNodes.length&&!rt(a);)s=le(a)+1,a=a.parentNode;for(;a&&s<a.childNodes.length;){let u=a.childNodes[s];if(3==u.nodeType)return u;if(1==u.nodeType&&"false"==u.contentEditable)break;a=u,s=0}}(s,u))?(s=l,u=0):(b=function wi(a,s){for(;a&&!s&&!rt(a);)s=le(a),a=a.parentNode;for(;a&&s;){let u=a.childNodes[s-1];if(3==u.nodeType)return u;if(1==u.nodeType&&"false"==u.contentEditable)break;s=(a=u).childNodes.length}}(s,u))&&(s=b,u=b.nodeValue.length)}let f=a.domSelection();if(ze(f)){let b=document.createRange();b.setEnd(s,u),b.setStart(s,u),f.removeAllRanges(),f.addRange(b)}else f.extend&&f.extend(s,u);a.domObserver.setCurSelection();let{state:T}=a;setTimeout(()=>{a.state==T&&ct(a)},50)}function Ki(a,s){let u=a.state.doc.resolve(s);if(!We&&!ee&&u.parent.inlineContent){let T=a.coordsAtPos(s);if(s>u.start()){let b=a.coordsAtPos(s-1),l=(b.top+b.bottom)/2;if(l>T.top&&l<T.bottom&&Math.abs(b.left-T.left)>1)return b.left<T.left?"ltr":"rtl"}if(s<u.end()){let b=a.coordsAtPos(s+1),l=(b.top+b.bottom)/2;if(l>T.top&&l<T.bottom&&Math.abs(b.left-T.left)>1)return b.left>T.left?"ltr":"rtl"}}return"rtl"==getComputedStyle(a.dom).direction?"rtl":"ltr"}function Yi(a,s,u){let f=a.state.selection;if(f instanceof z.Bs&&!f.empty||u.indexOf("s")>-1||G&&u.indexOf("m")>-1)return!1;let{$from:T,$to:b}=f;if(!T.parent.inlineContent||a.endOfTextblock(s<0?"up":"down")){let l=xi(a.state,s);if(l&&l instanceof z.qv)return Et(a,l)}if(!T.parent.inlineContent){let l=s<0?T:b,o=f instanceof z.C1?z.Y1.near(l,s):z.Y1.findFrom(l,s);return!!o&&Et(a,o)}return!1}function Gi(a,s){if(!(a.state.selection instanceof z.Bs))return!0;let{$head:u,$anchor:f,empty:T}=a.state.selection;if(!u.sameParent(f))return!0;if(!T)return!1;if(a.endOfTextblock(s>0?"forward":"backward"))return!0;let b=!u.textOffset&&(s<0?u.nodeBefore:u.nodeAfter);if(b&&!b.isText){let l=a.state.tr;return s<0?l.delete(u.pos-b.nodeSize,u.pos):l.delete(u.pos,u.pos+b.nodeSize),a.dispatch(l),!0}return!1}function Si(a,s,u){a.domObserver.stop(),s.contentEditable=u,a.domObserver.start()}function wn(a,s){a.someProp("transformCopied",S=>{s=S(s,a)});let u=[],{content:f,openStart:T,openEnd:b}=s;for(;T>1&&b>1&&1==f.childCount&&1==f.firstChild.childCount;){T--,b--;let S=f.firstChild;u.push(S.type.name,S.attrs!=S.type.defaultAttrs?S.attrs:null),f=S.content}let l=a.someProp("clipboardSerializer")||Te.PW.fromSchema(a.state.schema),o=Xi(),c=o.createElement("div");c.appendChild(l.serializeFragment(f,{document:o}));let g,p=c.firstChild,y=0;for(;p&&1==p.nodeType&&(g=qi[p.nodeName.toLowerCase()]);){for(let S=g.length-1;S>=0;S--){let O=o.createElement(g[S]);for(;c.firstChild;)O.appendChild(c.firstChild);c.appendChild(O),y++}p=c.firstChild}return p&&1==p.nodeType&&p.setAttribute("data-pm-slice",`${T} ${b}${y?` -${y}`:""} ${JSON.stringify(u)}`),{dom:c,text:a.someProp("clipboardTextSerializer",S=>S(s,a))||s.content.textBetween(0,s.content.size,"\n\n")}}function Mi(a,s,u,f,T){let l,o,b=T.parent.type.spec.code;if(!u&&!s)return null;let c=s&&(f||b||!u);if(c){if(a.someProp("transformPastedText",v=>{s=v(s,b||f,a)}),b)return s?new Te.p2(Te.HY.from(a.state.schema.text(s.replace(/\r\n?/g,"\n"))),0,0):Te.p2.empty;let y=a.someProp("clipboardTextParser",v=>v(s,T,f,a));if(y)o=y;else{let v=T.marks(),{schema:S}=a.state,O=Te.PW.fromSchema(S);l=document.createElement("div"),s.split(/(?:\r\n?|\n)+/).forEach(D=>{let H=l.appendChild(document.createElement("p"));D&&H.appendChild(O.serializeNode(S.text(D,v)))})}}else a.someProp("transformPastedHTML",y=>{u=y(u,a)}),l=function vo(a){let s=/^(\s*<meta [^>]*>)*/.exec(a);s&&(a=a.slice(s[0].length));let T,u=Xi().createElement("div"),f=/<([a-z][^>\s]+)/i.exec(a);if((T=f&&qi[f[1].toLowerCase()])&&(a=T.map(b=>"<"+b+">").join("")+a+T.map(b=>"</"+b+">").reverse().join("")),u.innerHTML=a,T)for(let b=0;b<T.length;b++)u=u.querySelector(T[b])||u;return u}(u),he&&function Mn(a){let s=a.querySelectorAll(We?"span:not([class]):not([style])":"span.Apple-converted-space");for(let u=0;u<s.length;u++){let f=s[u];1==f.childNodes.length&&"\xa0"==f.textContent&&f.parentNode&&f.parentNode.replaceChild(a.ownerDocument.createTextNode(" "),f)}}(l);let p=l&&l.querySelector("[data-pm-slice]"),g=p&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(p.getAttribute("data-pm-slice")||"");if(g&&g[3])for(let y=+g[3];y>0;y--){let v=l.firstChild;for(;v&&1!=v.nodeType;)v=v.nextSibling;if(!v)break;l=v}if(o||(o=(a.someProp("clipboardParser")||a.someProp("domParser")||Te.aw.fromSchema(a.state.schema)).parseSlice(l,{preserveWhitespace:!(!c&&!g),context:T,ruleFromNode:v=>"BR"!=v.nodeName||v.nextSibling||!v.parentNode||Zi.test(v.parentNode.nodeName)?null:{ignore:!0}})),g)o=function xo(a,s){if(!a.size)return a;let f,u=a.content.firstChild.type.schema;try{f=JSON.parse(s)}catch{return a}let{content:T,openStart:b,openEnd:l}=a;for(let o=f.length-2;o>=0;o-=2){let c=u.nodes[f[o]];if(!c||c.hasRequiredAttrs())break;T=Te.HY.from(c.create(f[o+1],T)),b++,l++}return new Te.p2(T,b,l)}(Qi(o,+g[1],+g[2]),g[4]);else if(o=Te.p2.maxOpen(function Ei(a,s){if(a.childCount<2)return a;for(let u=s.depth;u>=0;u--){let b,T=s.node(u).contentMatchAt(s.index(u)),l=[];if(a.forEach(o=>{if(!l)return;let p,c=T.findWrapping(o.type);if(!c)return l=null;if(p=l.length&&b.length&&yo(c,b,o,l[l.length-1],0))l[l.length-1]=p;else{l.length&&(l[l.length-1]=ie(l[l.length-1],b.length));let g=Sn(o,c);l.push(g),T=T.matchType(g.type),b=c}}),l)return Te.HY.from(l)}return a}(o.content,T),!0),o.openStart||o.openEnd){let y=0,v=0;for(let S=o.content.firstChild;y<o.openStart&&!S.type.spec.isolating;y++,S=S.firstChild);for(let S=o.content.lastChild;v<o.openEnd&&!S.type.spec.isolating;v++,S=S.lastChild);o=Qi(o,y,v)}return a.someProp("transformPasted",y=>{o=y(o,a)}),o}const Zi=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function Sn(a,s,u=0){for(let f=s.length-1;f>=u;f--)a=s[f].create(null,Te.HY.from(a));return a}function yo(a,s,u,f,T){if(T<a.length&&T<s.length&&a[T]==s[T]){let b=yo(a,s,u,f.lastChild,T+1);if(b)return f.copy(f.content.replaceChild(f.childCount-1,b));if(f.contentMatchAt(f.childCount).matchType(T==a.length-1?u.type:a[T+1]))return f.copy(f.content.append(Te.HY.from(Sn(u,a,T+1))))}}function ie(a,s){if(0==s)return a;let u=a.content.replaceChild(a.childCount-1,ie(a.lastChild,s-1)),f=a.contentMatchAt(a.childCount).fillBefore(Te.HY.empty,!0);return a.copy(u.append(f))}function Oi(a,s,u,f,T,b){let l=s<0?a.firstChild:a.lastChild,o=l.content;return a.childCount>1&&(b=0),T<f-1&&(o=Oi(o,s,u,f,T+1,b)),T>=u&&(o=s<0?l.contentMatchAt(0).fillBefore(o,b<=T).append(o):o.append(l.contentMatchAt(l.childCount).fillBefore(Te.HY.empty,!0))),a.replaceChild(s<0?0:a.childCount-1,l.copy(o))}function Qi(a,s,u){return s<a.openStart&&(a=new Te.p2(Oi(a.content,-1,s,a.openStart,0,a.openEnd),s,a.openEnd)),u<a.openEnd&&(a=new Te.p2(Oi(a.content,1,u,a.openEnd,0,0),a.openStart,u)),a}const qi={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let ri=null;function Xi(){return ri||(ri=document.implementation.createHTMLDocument("title"))}const ft={},ht={},ko={touchstart:!0,touchmove:!0};class Un{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:""},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastAndroidDelete=0,this.composing=!1,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function sn(a,s){a.input.lastSelectionOrigin=s,a.input.lastSelectionTime=Date.now()}function Ii(a){a.someProp("handleDOMEvents",s=>{for(let u in s)a.input.eventHandlers[u]||a.dom.addEventListener(u,a.input.eventHandlers[u]=f=>Di(a,f))})}function Di(a,s){return a.someProp("handleDOMEvents",u=>{let f=u[s.type];return!!f&&(f(a,s)||s.defaultPrevented)})}function wo(a,s){if(!s.bubbles)return!0;if(s.defaultPrevented)return!1;for(let u=s.target;u!=a.dom;u=u.parentNode)if(!u||11==u.nodeType||u.pmViewDesc&&u.pmViewDesc.stopEvent(s))return!1;return!0}function En(a){return{left:a.clientX,top:a.clientY}}function jn(a,s,u,f,T){if(-1==f)return!1;let b=a.state.doc.resolve(f);for(let l=b.depth+1;l>0;l--)if(a.someProp(s,o=>l>b.depth?o(a,u,b.nodeAfter,b.before(l),T,!0):o(a,u,b.node(l),b.before(l),T,!1)))return!0;return!1}function On(a,s,u){a.focused||a.focus();let f=a.state.tr.setSelection(s);"pointer"==u&&f.setMeta("pointer",!0),a.dispatch(f)}function Ze(a,s,u,f){return jn(a,"handleDoubleClickOn",s,u,f)||a.someProp("handleDoubleClick",T=>T(a,s,f))}function Pi(a,s,u,f){return jn(a,"handleTripleClickOn",s,u,f)||a.someProp("handleTripleClick",T=>T(a,s,f))||function eo(a,s,u){if(0!=u.button)return!1;let f=a.state.doc;if(-1==s)return!!f.inlineContent&&(On(a,z.Bs.create(f,0,f.content.size),"pointer"),!0);let T=f.resolve(s);for(let b=T.depth+1;b>0;b--){let l=b>T.depth?T.nodeAfter:T.node(b),o=T.before(b);if(l.inlineContent)On(a,z.Bs.create(f,o+1,o+1+l.content.size),"pointer");else{if(!z.qv.isSelectable(l))continue;On(a,z.qv.create(f,o),"pointer")}return!0}}(a,u,f)}function gn(a){return Jn(a)}ht.keydown=(a,s)=>{let u=s;if(a.input.shiftKey=16==u.keyCode||u.shiftKey,!Wn(a,u)&&(a.input.lastKeyCode=u.keyCode,a.input.lastKeyCodeTime=Date.now(),!se||!We||13!=u.keyCode))if(229!=u.keyCode&&a.domObserver.forceFlush(),!B||13!=u.keyCode||u.ctrlKey||u.altKey||u.metaKey)a.someProp("handleKeyDown",f=>f(a,u))||function bt(a,s){let u=s.keyCode,f=function Lt(a){let s="";return a.ctrlKey&&(s+="c"),a.metaKey&&(s+="m"),a.altKey&&(s+="a"),a.shiftKey&&(s+="s"),s}(s);if(8==u||G&&72==u&&"c"==f)return Gi(a,-1)||pt(a,-1);if(46==u&&!s.shiftKey||G&&68==u&&"c"==f)return Gi(a,1)||pt(a,1);if(13==u||27==u)return!0;if(37==u||G&&66==u&&"c"==f){let T=37==u?"ltr"==Ki(a,a.state.selection.from)?-1:1:-1;return ki(a,T,f)||pt(a,T)}if(39==u||G&&70==u&&"c"==f){let T=39==u?"ltr"==Ki(a,a.state.selection.from)?1:-1:1;return ki(a,T,f)||pt(a,T)}return 38==u||G&&80==u&&"c"==f?Yi(a,-1,f)||pt(a,-1):40==u||G&&78==u&&"c"==f?function Nt(a){if(!de||a.state.selection.$head.parentOffset>0)return!1;let{focusNode:s,focusOffset:u}=a.domSelectionRange();if(s&&1==s.nodeType&&0==u&&s.firstChild&&"false"==s.firstChild.contentEditable){let f=s.firstChild;Si(a,f,"true"),setTimeout(()=>Si(a,f,"false"),20)}return!1}(a)||Yi(a,1,f)||pt(a,1):f==(G?"m":"c")&&(66==u||73==u||89==u||90==u)}(a,u)?u.preventDefault():sn(a,"key");else{let f=Date.now();a.input.lastIOSEnter=f,a.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{a.input.lastIOSEnter==f&&(a.someProp("handleKeyDown",T=>T(a,me(13,"Enter"))),a.input.lastIOSEnter=0)},200)}},ht.keyup=(a,s)=>{16==s.keyCode&&(a.input.shiftKey=!1)},ht.keypress=(a,s)=>{let u=s;if(Wn(a,u)||!u.charCode||u.ctrlKey&&!u.altKey||G&&u.metaKey)return;if(a.someProp("handleKeyPress",T=>T(a,u)))return void u.preventDefault();let f=a.state.selection;if(!(f instanceof z.Bs&&f.$from.sameParent(f.$to))){let T=String.fromCharCode(u.charCode);!/[\r\n]/.test(T)&&!a.someProp("handleTextInput",b=>b(a,f.$from.pos,f.$to.pos,T))&&a.dispatch(a.state.tr.insertText(T).scrollIntoView()),u.preventDefault()}};const li=G?"metaKey":"ctrlKey";ft.mousedown=(a,s)=>{let u=s;a.input.shiftKey=u.shiftKey;let f=gn(a),T=Date.now(),b="singleClick";T-a.input.lastClick.time<500&&function Mo(a,s){let u=s.x-a.clientX,f=s.y-a.clientY;return u*u+f*f<100}(u,a.input.lastClick)&&!u[li]&&("singleClick"==a.input.lastClick.type?b="doubleClick":"doubleClick"==a.input.lastClick.type&&(b="tripleClick")),a.input.lastClick={time:T,x:u.clientX,y:u.clientY,type:b};let l=a.posAtCoords(En(u));l&&("singleClick"==b?(a.input.mouseDown&&a.input.mouseDown.done(),a.input.mouseDown=new ai(a,l,u,!!f)):("doubleClick"==b?Ze:Pi)(a,l.pos,l.inside,u)?u.preventDefault():sn(a,"pointer"))};class ai{constructor(s,u,f,T){let b,l;if(this.view=s,this.pos=u,this.event=f,this.flushed=T,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=s.state.doc,this.selectNode=!!f[li],this.allowDefault=f.shiftKey,u.inside>-1)b=s.state.doc.nodeAt(u.inside),l=u.inside;else{let g=s.state.doc.resolve(u.pos);b=g.parent,l=g.depth?g.before():0}const o=T?null:f.target,c=o?s.docView.nearestDesc(o,!0):null;this.target=c?c.dom:null;let{selection:p}=s.state;(0==f.button&&b.type.spec.draggable&&!1!==b.type.spec.selectable||p instanceof z.qv&&p.from<=l&&p.to>l)&&(this.mightDrag={node:b,pos:l,addAttr:!(!this.target||this.target.draggable),setUneditable:!(!this.target||!qe||this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),s.root.addEventListener("mouseup",this.up=this.up.bind(this)),s.root.addEventListener("mousemove",this.move=this.move.bind(this)),sn(s,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>ct(this.view)),this.view.input.mouseDown=null}up(s){if(this.done(),!this.view.dom.contains(s.target))return;let u=this.pos;this.view.state.doc!=this.startDoc&&(u=this.view.posAtCoords(En(s))),this.updateAllowDefault(s),this.allowDefault||!u?sn(this.view,"pointer"):function ln(a,s,u,f,T){return jn(a,"handleClickOn",s,u,f)||a.someProp("handleClick",b=>b(a,s,f))||(T?function Ke(a,s){if(-1==s)return!1;let f,T,u=a.state.selection;u instanceof z.qv&&(f=u.node);let b=a.state.doc.resolve(s);for(let l=b.depth+1;l>0;l--){let o=l>b.depth?b.nodeAfter:b.node(l);if(z.qv.isSelectable(o)){T=f&&u.$from.depth>0&&l>=u.$from.depth&&b.before(u.$from.depth+1)==u.$from.pos?b.before(u.$from.depth):b.before(l);break}}return null!=T&&(On(a,z.qv.create(a.state.doc,T),"pointer"),!0)}(a,u):function si(a,s){if(-1==s)return!1;let u=a.state.doc.resolve(s),f=u.nodeAfter;return!!(f&&f.isAtom&&z.qv.isSelectable(f))&&(On(a,new z.qv(u),"pointer"),!0)}(a,u))}(this.view,u.pos,u.inside,s,this.selectNode)?s.preventDefault():0==s.button&&(this.flushed||de&&this.mightDrag&&!this.mightDrag.node.isAtom||We&&!this.view.state.selection.visible&&Math.min(Math.abs(u.pos-this.view.state.selection.from),Math.abs(u.pos-this.view.state.selection.to))<=2)?(On(this.view,z.Y1.near(this.view.state.doc.resolve(u.pos)),"pointer"),s.preventDefault()):sn(this.view,"pointer")}move(s){this.updateAllowDefault(s),sn(this.view,"pointer"),0==s.buttons&&this.done()}updateAllowDefault(s){!this.allowDefault&&(Math.abs(this.event.x-s.clientX)>4||Math.abs(this.event.y-s.clientY)>4)&&(this.allowDefault=!0)}}function Wn(a,s){return!!a.composing||!!(de&&Math.abs(s.timeStamp-a.input.compositionEndedAt)<500)&&(a.input.compositionEndedAt=-2e8,!0)}ft.touchstart=a=>{a.input.lastTouch=Date.now(),gn(a),sn(a,"pointer")},ft.touchmove=a=>{a.input.lastTouch=Date.now(),sn(a,"pointer")},ft.contextmenu=a=>gn(a);const Eo=se?5e3:-1;function ci(a,s){clearTimeout(a.input.composingTimeout),s>-1&&(a.input.composingTimeout=setTimeout(()=>Jn(a),s))}function to(a){for(a.composing&&(a.input.composing=!1,a.input.compositionEndedAt=function no(){let a=document.createEvent("Event");return a.initEvent("event",!0,!0),a.timeStamp}());a.input.compositionNodes.length>0;)a.input.compositionNodes.pop().markParentsDirty()}function Jn(a,s=!1){if(!(se&&a.domObserver.flushingSoon>=0)){if(a.domObserver.forceFlush(),to(a),s||a.docView&&a.docView.dirty){let u=Mt(a);return u&&!u.eq(a.state.selection)?a.dispatch(a.state.tr.setSelection(u)):a.updateState(a.state),!0}return!1}}ht.compositionstart=ht.compositionupdate=a=>{if(!a.composing){a.domObserver.flush();let{state:s}=a,u=s.selection.$from;if(s.selection.empty&&(s.storedMarks||!u.textOffset&&u.parentOffset&&u.nodeBefore.marks.some(f=>!1===f.type.spec.inclusive)))a.markCursor=a.state.storedMarks||u.marks(),Jn(a,!0),a.markCursor=null;else if(Jn(a),qe&&s.selection.empty&&u.parentOffset&&!u.textOffset&&u.nodeBefore.marks.length){let f=a.domSelectionRange();for(let T=f.focusNode,b=f.focusOffset;T&&1==T.nodeType&&0!=b;){let l=b<0?T.lastChild:T.childNodes[b-1];if(!l)break;if(3==l.nodeType){a.domSelection().collapse(l,l.nodeValue.length);break}T=l,b=-1}}a.input.composing=!0}ci(a,Eo)},ht.compositionend=(a,s)=>{a.composing&&(a.input.composing=!1,a.input.compositionEndedAt=s.timeStamp,a.input.compositionPendingChanges=a.domObserver.pendingRecords().length?a.input.compositionID:0,a.input.compositionPendingChanges&&Promise.resolve().then(()=>a.domObserver.flush()),a.input.compositionID++,ci(a,20))};const an=Fe&&st<15||B&&ve<604;function _n(a,s,u,f,T){let b=Mi(a,s,u,f,a.state.selection.$from);if(a.someProp("handlePaste",c=>c(a,T,b||Te.p2.empty)))return!0;if(!b)return!1;let l=function ut(a){return 0==a.openStart&&0==a.openEnd&&1==a.content.childCount?a.content.firstChild:null}(b),o=l?a.state.tr.replaceSelectionWith(l,f):a.state.tr.replaceSelection(b);return a.dispatch(o.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function Ni(a){let s=a.getData("text/plain")||a.getData("Text");if(s)return s;let u=a.getData("text/uri-list");return u?u.replace(/\r?\n/g," "):""}ft.copy=ht.cut=(a,s)=>{let u=s,f=a.state.selection,T="cut"==u.type;if(f.empty)return;let b=an?null:u.clipboardData,l=f.content(),{dom:o,text:c}=wn(a,l);b?(u.preventDefault(),b.clearData(),b.setData("text/html",o.innerHTML),b.setData("text/plain",c)):function io(a,s){if(!a.dom.parentNode)return;let u=a.dom.parentNode.appendChild(document.createElement("div"));u.appendChild(s),u.style.cssText="position: fixed; left: -10000px; top: 10px";let f=getSelection(),T=document.createRange();T.selectNodeContents(s),a.dom.blur(),f.removeAllRanges(),f.addRange(T),setTimeout(()=>{u.parentNode&&u.parentNode.removeChild(u),a.focus()},50)}(a,o),T&&a.dispatch(a.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))},ht.paste=(a,s)=>{let u=s;if(a.composing&&!se)return;let f=an?null:u.clipboardData,T=a.input.shiftKey&&45!=a.input.lastKeyCode;f&&_n(a,Ni(f),f.getData("text/html"),T,u)?u.preventDefault():function Ri(a,s){if(!a.dom.parentNode)return;let u=a.input.shiftKey||a.state.selection.$from.parent.type.spec.code,f=a.dom.parentNode.appendChild(document.createElement(u?"textarea":"div"));u||(f.contentEditable="true"),f.style.cssText="position: fixed; left: -10000px; top: 10px",f.focus();let T=a.input.shiftKey&&45!=a.input.lastKeyCode;setTimeout(()=>{a.focus(),f.parentNode&&f.parentNode.removeChild(f),u?_n(a,f.value,null,T,s):_n(a,f.textContent,f.innerHTML,T,s)},50)}(a,u)};class An{constructor(s,u,f){this.slice=s,this.move=u,this.node=f}}const gt=G?"altKey":"ctrlKey";ft.dragstart=(a,s)=>{let u=s,f=a.input.mouseDown;if(f&&f.done(),!u.dataTransfer)return;let l,T=a.state.selection,b=T.empty?null:a.posAtCoords(En(u));if(!(b&&b.pos>=T.from&&b.pos<=(T instanceof z.qv?T.to-1:T.to)))if(f&&f.mightDrag)l=z.qv.create(a.state.doc,f.mightDrag.pos);else if(u.target&&1==u.target.nodeType){let g=a.docView.nearestDesc(u.target,!0);g&&g.node.type.spec.draggable&&g!=a.docView&&(l=z.qv.create(a.state.doc,g.posBefore))}let o=(l||a.state.selection).content(),{dom:c,text:p}=wn(a,o);u.dataTransfer.clearData(),u.dataTransfer.setData(an?"Text":"text/html",c.innerHTML),u.dataTransfer.effectAllowed="copyMove",an||u.dataTransfer.setData("text/plain",p),a.dragging=new An(o,!u[gt],l)},ft.dragend=a=>{let s=a.dragging;window.setTimeout(()=>{a.dragging==s&&(a.dragging=null)},50)},ht.dragover=ht.dragenter=(a,s)=>s.preventDefault(),ht.drop=(a,s)=>{let u=s,f=a.dragging;if(a.dragging=null,!u.dataTransfer)return;let T=a.posAtCoords(En(u));if(!T)return;let b=a.state.doc.resolve(T.pos),l=f&&f.slice;l?a.someProp("transformPasted",O=>{l=O(l,a)}):l=Mi(a,Ni(u.dataTransfer),an?null:u.dataTransfer.getData("text/html"),!1,b);let o=!(!f||u[gt]);if(a.someProp("handleDrop",O=>O(a,u,l||Te.p2.empty,o)))return void u.preventDefault();if(!l)return;u.preventDefault();let c=l?(0,Ne.nj)(a.state.doc,b.pos,l):b.pos;null==c&&(c=b.pos);let p=a.state.tr;if(o){let{node:O}=f;O?O.replace(p):p.deleteSelection()}let g=p.mapping.map(c),y=0==l.openStart&&0==l.openEnd&&1==l.content.childCount,v=p.doc;if(y?p.replaceRangeWith(g,g,l.content.firstChild):p.replaceRange(g,g,l),p.doc.eq(v))return;let S=p.doc.resolve(g);if(y&&z.qv.isSelectable(l.content.firstChild)&&S.nodeAfter&&S.nodeAfter.sameMarkup(l.content.firstChild))p.setSelection(new z.qv(S));else{let O=p.mapping.map(c);p.mapping.maps[p.mapping.maps.length-1].forEach((D,H,$,J)=>O=J),p.setSelection($n(a,S,p.doc.resolve(O)))}a.focus(),a.dispatch(p.setMeta("uiEvent","drop"))},ft.focus=a=>{a.input.lastFocus=Date.now(),a.focused||(a.domObserver.stop(),a.dom.classList.add("ProseMirror-focused"),a.domObserver.start(),a.focused=!0,setTimeout(()=>{a.docView&&a.hasFocus()&&!a.domObserver.currentSelection.eq(a.domSelectionRange())&&ct(a)},20))},ft.blur=(a,s)=>{let u=s;a.focused&&(a.domObserver.stop(),a.dom.classList.remove("ProseMirror-focused"),a.domObserver.start(),u.relatedTarget&&a.dom.contains(u.relatedTarget)&&a.domObserver.currentSelection.clear(),a.focused=!1)},ft.beforeinput=(a,s)=>{if(We&&se&&"deleteContentBackward"==s.inputType){a.domObserver.flushSoon();let{domChangeCount:f}=a.input;setTimeout(()=>{if(a.input.domChangeCount!=f||(a.dom.blur(),a.focus(),a.someProp("handleKeyDown",b=>b(a,me(8,"Backspace")))))return;let{$cursor:T}=a.state.selection;T&&T.pos>0&&a.dispatch(a.state.tr.delete(T.pos-1,T.pos).scrollIntoView())},50)}};for(let a in ht)ft[a]=ht[a];function In(a,s){if(a==s)return!0;for(let u in a)if(a[u]!==s[u])return!1;for(let u in s)if(!(u in a))return!1;return!0}class yt{constructor(s,u){this.toDOM=s,this.spec=u||cn,this.side=this.spec.side||0}map(s,u,f,T){let{pos:b,deleted:l}=s.mapResult(u.from+T,this.side<0?-1:1);return l?null:new vt(b-f,b-f,this)}valid(){return!0}eq(s){return this==s||s instanceof yt&&(this.spec.key&&this.spec.key==s.spec.key||this.toDOM==s.toDOM&&In(this.spec,s.spec))}destroy(s){this.spec.destroy&&this.spec.destroy(s)}}class _t{constructor(s,u){this.attrs=s,this.spec=u||cn}map(s,u,f,T){let b=s.map(u.from+T,this.spec.inclusiveStart?-1:1)-f,l=s.map(u.to+T,this.spec.inclusiveEnd?1:-1)-f;return b>=l?null:new vt(b,l,this)}valid(s,u){return u.from<u.to}eq(s){return this==s||s instanceof _t&&In(this.attrs,s.attrs)&&In(this.spec,s.spec)}static is(s){return s.type instanceof _t}destroy(){}}class Kn{constructor(s,u){this.attrs=s,this.spec=u||cn}map(s,u,f,T){let b=s.mapResult(u.from+T,1);if(b.deleted)return null;let l=s.mapResult(u.to+T,-1);return l.deleted||l.pos<=b.pos?null:new vt(b.pos-f,l.pos-f,this)}valid(s,u){let b,{index:f,offset:T}=s.content.findIndex(u.from);return T==u.from&&!(b=s.child(f)).isText&&T+b.nodeSize==u.to}eq(s){return this==s||s instanceof Kn&&In(this.attrs,s.attrs)&&In(this.spec,s.spec)}destroy(){}}class vt{constructor(s,u,f){this.from=s,this.to=u,this.type=f}copy(s,u){return new vt(s,u,this.type)}eq(s,u=0){return this.type.eq(s.type)&&this.from+u==s.from&&this.to+u==s.to}map(s,u,f){return this.type.map(s,this,u,f)}static widget(s,u,f){return new vt(s,s,new yt(u,f))}static inline(s,u,f,T){return new vt(s,u,new _t(f,T))}static node(s,u,f,T){return new vt(s,u,new Kn(f,T))}get spec(){return this.type.spec}get inline(){return this.type instanceof _t}get widget(){return this.type instanceof yt}}const Dn=[],cn={};class et{constructor(s,u){this.local=s.length?s:Dn,this.children=u.length?u:Dn}static create(s,u){return u.length?di(u,s,0,cn):dt}find(s,u,f){let T=[];return this.findInner(s??0,u??1e9,T,0,f),T}findInner(s,u,f,T,b){for(let l=0;l<this.local.length;l++){let o=this.local[l];o.from<=u&&o.to>=s&&(!b||b(o.spec))&&f.push(o.copy(o.from+T,o.to+T))}for(let l=0;l<this.children.length;l+=3)if(this.children[l]<u&&this.children[l+1]>s){let o=this.children[l]+1;this.children[l+2].findInner(s-o,u-o,f,T+o,b)}}map(s,u,f){return this==dt||0==s.maps.length?this:this.mapInner(s,u,0,0,f||cn)}mapInner(s,u,f,T,b){let l;for(let o=0;o<this.local.length;o++){let c=this.local[o].map(s,f,T);c&&c.type.valid(u,c)?(l||(l=[])).push(c):b.onRemove&&b.onRemove(this.local[o].spec)}return this.children.length?function oo(a,s,u,f,T,b,l){let o=a.slice();for(let p=0,g=b;p<u.maps.length;p++){let y=0;u.maps[p].forEach((v,S,O,D)=>{let H=D-O-(S-v);for(let $=0;$<o.length;$+=3){let J=o[$+1];if(J<0||v>J+g-y)continue;let X=o[$]+g-y;S>=X?o[$+1]=v<=X?-2:-1:v>=g&&H&&(o[$]+=H,o[$+1]+=H)}y+=H}),g=u.maps[p].map(g,-1)}let c=!1;for(let p=0;p<o.length;p+=3)if(o[p+1]<0){if(-2==o[p+1]){c=!0,o[p+1]=-1;continue}let g=u.map(a[p]+b),y=g-T;if(y<0||y>=f.content.size){c=!0;continue}let S=u.map(a[p+1]+b,-1)-T,{index:O,offset:D}=f.content.findIndex(y),H=f.maybeChild(O);if(H&&D==y&&D+H.nodeSize==S){let $=o[p+2].mapInner(u,H,g+1,a[p]+b+1,l);$!=dt?(o[p]=y,o[p+1]=S,o[p+2]=$):(o[p+1]=-2,c=!0)}else c=!0}if(c){let p=function Jo(a,s,u,f,T,b,l){function o(c,p){for(let g=0;g<c.local.length;g++){let y=c.local[g].map(f,T,p);y?u.push(y):l.onRemove&&l.onRemove(c.local[g].spec)}for(let g=0;g<c.children.length;g+=3)o(c.children[g+2],c.children[g]+p+1)}for(let c=0;c<a.length;c+=3)-1==a[c+1]&&o(a[c+2],s[c]+b+1);return u}(o,a,s,u,T,b,l),g=di(p,f,0,l);s=g.local;for(let y=0;y<o.length;y+=3)o[y+1]<0&&(o.splice(y,3),y-=3);for(let y=0,v=0;y<g.children.length;y+=3){let S=g.children[y];for(;v<o.length&&o[v]<S;)v+=3;o.splice(v,0,g.children[y],g.children[y+1],g.children[y+2])}}return new et(s.sort(un),o)}(this.children,l||[],s,u,f,T,b):l?new et(l.sort(un),Dn):dt}add(s,u){return u.length?this==dt?et.create(s,u):this.addInner(s,u,0):this}addInner(s,u,f){let T,b=0;s.forEach((o,c)=>{let g,p=c+f;if(g=Ht(u,o,p)){for(T||(T=this.children.slice());b<T.length&&T[b]<c;)b+=3;T[b]==c?T[b+2]=T[b+2].addInner(o,g,p+1):T.splice(b,0,c,c+o.nodeSize,di(g,o,p+1,cn)),b+=3}});let l=Yn(b?ui(u):u,-f);for(let o=0;o<l.length;o++)l[o].type.valid(s,l[o])||l.splice(o--,1);return new et(l.length?this.local.concat(l).sort(un):this.local,T||this.children)}remove(s){return 0==s.length||this==dt?this:this.removeInner(s,0)}removeInner(s,u){let f=this.children,T=this.local;for(let b=0;b<f.length;b+=3){let l,o=f[b]+u,c=f[b+1]+u;for(let y,g=0;g<s.length;g++)(y=s[g])&&y.from>o&&y.to<c&&(s[g]=null,(l||(l=[])).push(y));if(!l)continue;f==this.children&&(f=this.children.slice());let p=f[b+2].removeInner(l,o+1);p!=dt?f[b+2]=p:(f.splice(b,3),b-=3)}if(T.length)for(let l,b=0;b<s.length;b++)if(l=s[b])for(let o=0;o<T.length;o++)T[o].eq(l,u)&&(T==this.local&&(T=this.local.slice()),T.splice(o--,1));return f==this.children&&T==this.local?this:T.length||f.length?new et(T,f):dt}forChild(s,u){if(this==dt)return this;if(u.isLeaf)return et.empty;let f,T;for(let o=0;o<this.children.length;o+=3)if(this.children[o]>=s){this.children[o]==s&&(f=this.children[o+2]);break}let b=s+1,l=b+u.content.size;for(let o=0;o<this.local.length;o++){let c=this.local[o];if(c.from<l&&c.to>b&&c.type instanceof _t){let p=Math.max(b,c.from)-b,g=Math.min(l,c.to)-b;p<g&&(T||(T=[])).push(c.copy(p,g))}}if(T){let o=new et(T.sort(un),Dn);return f?new Ut([o,f]):o}return f||dt}eq(s){if(this==s)return!0;if(!(s instanceof et)||this.local.length!=s.local.length||this.children.length!=s.children.length)return!1;for(let u=0;u<this.local.length;u++)if(!this.local[u].eq(s.local[u]))return!1;for(let u=0;u<this.children.length;u+=3)if(this.children[u]!=s.children[u]||this.children[u+1]!=s.children[u+1]||!this.children[u+2].eq(s.children[u+2]))return!1;return!0}locals(s){return Pn(this.localsInner(s))}localsInner(s){if(this==dt)return Dn;if(s.inlineContent||!this.local.some(_t.is))return this.local;let u=[];for(let f=0;f<this.local.length;f++)this.local[f].type instanceof _t||u.push(this.local[f]);return u}}et.empty=new et([],[]),et.removeOverlap=Pn;const dt=et.empty;class Ut{constructor(s){this.members=s}map(s,u){const f=this.members.map(T=>T.map(s,u,cn));return Ut.from(f)}forChild(s,u){if(u.isLeaf)return et.empty;let f=[];for(let T=0;T<this.members.length;T++){let b=this.members[T].forChild(s,u);b!=dt&&(b instanceof Ut?f=f.concat(b.members):f.push(b))}return Ut.from(f)}eq(s){if(!(s instanceof Ut)||s.members.length!=this.members.length)return!1;for(let u=0;u<this.members.length;u++)if(!this.members[u].eq(s.members[u]))return!1;return!0}locals(s){let u,f=!0;for(let T=0;T<this.members.length;T++){let b=this.members[T].localsInner(s);if(b.length)if(u){f&&(u=u.slice(),f=!1);for(let l=0;l<b.length;l++)u.push(b[l])}else u=b}return u?Pn(f?u:u.sort(un)):Dn}static from(s){switch(s.length){case 0:return dt;case 1:return s[0];default:return new Ut(s.every(u=>u instanceof et)?s:s.reduce((u,f)=>u.concat(f instanceof et?f:f.members),[]))}}}function Yn(a,s){if(!s||!a.length)return a;let u=[];for(let f=0;f<a.length;f++){let T=a[f];u.push(new vt(T.from+s,T.to+s,T.type))}return u}function Ht(a,s,u){if(s.isLeaf)return null;let f=u+s.nodeSize,T=null;for(let l,b=0;b<a.length;b++)(l=a[b])&&l.from>u&&l.to<f&&((T||(T=[])).push(l),a[b]=null);return T}function ui(a){let s=[];for(let u=0;u<a.length;u++)null!=a[u]&&s.push(a[u]);return s}function di(a,s,u,f){let T=[],b=!1;s.forEach((o,c)=>{let p=Ht(a,o,c+u);if(p){b=!0;let g=di(p,o,u+c+1,f);g!=dt&&T.push(c,c+o.nodeSize,g)}});let l=Yn(b?ui(a):a,-u).sort(un);for(let o=0;o<l.length;o++)l[o].type.valid(s,l[o])||(f.onRemove&&f.onRemove(l[o].spec),l.splice(o--,1));return l.length||T.length?new et(l,T):dt}function un(a,s){return a.from-s.from||a.to-s.to}function Pn(a){let s=a;for(let u=0;u<s.length-1;u++){let f=s[u];if(f.from!=f.to)for(let T=u+1;T<s.length;T++){let b=s[T];if(b.from!=f.from){b.from<f.to&&(s==a&&(s=a.slice()),s[u]=f.copy(f.from,b.from),Li(s,T,f.copy(b.from,f.to)));break}b.to!=f.to&&(s==a&&(s=a.slice()),s[T]=b.copy(b.from,f.to),Li(s,T+1,b.copy(f.to,b.to)))}}return s}function Li(a,s,u){for(;s<a.length&&un(u,a[s])>0;)s++;a.splice(s,0,u)}function Oo(a){let s=[];return a.someProp("decorations",u=>{let f=u(a.state);f&&f!=dt&&s.push(f)}),a.cursorWrapper&&s.push(et.create(a.state.doc,[a.cursorWrapper.deco])),Ut.from(s)}const Ko={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},Yo=Fe&&st<=11;class Go{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(s){this.anchorNode=s.anchorNode,this.anchorOffset=s.anchorOffset,this.focusNode=s.focusNode,this.focusOffset=s.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(s){return s.anchorNode==this.anchorNode&&s.anchorOffset==this.anchorOffset&&s.focusNode==this.focusNode&&s.focusOffset==this.focusOffset}}class Zo{constructor(s,u){this.view=s,this.handleDOMChange=u,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new Go,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.observer=window.MutationObserver&&new window.MutationObserver(f=>{for(let T=0;T<f.length;T++)this.queue.push(f[T]);Fe&&st<=11&&f.some(T=>"childList"==T.type&&T.removedNodes.length||"characterData"==T.type&&T.oldValue.length>T.target.nodeValue.length)?this.flushSoon():this.flush()}),Yo&&(this.onCharData=f=>{this.queue.push({target:f.target,type:"characterData",oldValue:f.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,Ko)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let s=this.observer.takeRecords();if(s.length){for(let u=0;u<s.length;u++)this.queue.push(s[u]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(vi(this.view)){if(this.suppressingSelectionUpdates)return ct(this.view);if(Fe&&st<=11&&!this.view.state.selection.empty){let s=this.view.domSelectionRange();if(s.focusNode&&Ae(s.focusNode,s.focusOffset,s.anchorNode,s.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(s){if(!s.focusNode)return!0;let f,u=new Set;for(let b=s.focusNode;b;b=ne(b))u.add(b);for(let b=s.anchorNode;b;b=ne(b))if(u.has(b)){f=b;break}let T=f&&this.view.docView.nearestDesc(f);return T&&T.ignoreMutation({type:"selection",target:3==f.nodeType?f.parentNode:f})?(this.setCurSelection(),!0):void 0}pendingRecords(){if(this.observer)for(let s of this.observer.takeRecords())this.queue.push(s);return this.queue}flush(){let{view:s}=this;if(!s.docView||this.flushingSoon>-1)return;let u=this.pendingRecords();u.length&&(this.queue=[]);let f=s.domSelectionRange(),T=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(f)&&vi(s)&&!this.ignoreSelectionChange(f),b=-1,l=-1,o=!1,c=[];if(s.editable)for(let g=0;g<u.length;g++){let y=this.registerMutation(u[g],c);y&&(b=b<0?y.from:Math.min(y.from,b),l=l<0?y.to:Math.max(y.to,l),y.typeOver&&(o=!0))}if(qe&&c.length>1){let g=c.filter(y=>"BR"==y.nodeName);if(2==g.length){let y=g[0],v=g[1];y.parentNode&&y.parentNode.parentNode==v.parentNode?v.remove():y.remove()}}let p=null;b<0&&T&&s.input.lastFocus>Date.now()-200&&Math.max(s.input.lastTouch,s.input.lastClick.time)<Date.now()-300&&ze(f)&&(p=Mt(s))&&p.eq(z.Y1.near(s.state.doc.resolve(0),1))?(s.input.lastFocus=0,ct(s),this.currentSelection.set(f),s.scrollToSelection()):(b>-1||T)&&(b>-1&&(s.docView.markDirty(b,l),function Qo(a){if(!Ao.has(a)&&(Ao.set(a,null),-1!==["normal","nowrap","pre-line"].indexOf(getComputedStyle(a.dom).whiteSpace))){if(a.requiresGeckoHackNode=qe,Io)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),Io=!0}}(s)),this.handleDOMChange(b,l,o,c),s.docView&&s.docView.dirty?s.updateState(s.state):this.currentSelection.eq(f)||ct(s),this.currentSelection.set(f))}registerMutation(s,u){if(u.indexOf(s.target)>-1)return null;let f=this.view.docView.nearestDesc(s.target);if("attributes"==s.type&&(f==this.view.docView||"contenteditable"==s.attributeName||"style"==s.attributeName&&!s.oldValue&&!s.target.getAttribute("style"))||!f||f.ignoreMutation(s))return null;if("childList"==s.type){for(let g=0;g<s.addedNodes.length;g++)u.push(s.addedNodes[g]);if(f.contentDOM&&f.contentDOM!=f.dom&&!f.contentDOM.contains(s.target))return{from:f.posBefore,to:f.posAfter};let T=s.previousSibling,b=s.nextSibling;if(Fe&&st<=11&&s.addedNodes.length)for(let g=0;g<s.addedNodes.length;g++){let{previousSibling:y,nextSibling:v}=s.addedNodes[g];(!y||Array.prototype.indexOf.call(s.addedNodes,y)<0)&&(T=y),(!v||Array.prototype.indexOf.call(s.addedNodes,v)<0)&&(b=v)}let l=T&&T.parentNode==s.target?le(T)+1:0,o=f.localPosFromDOM(s.target,l,-1),c=b&&b.parentNode==s.target?le(b):s.target.childNodes.length;return{from:o,to:f.localPosFromDOM(s.target,c,1)}}return"attributes"==s.type?{from:f.posAtStart-f.border,to:f.posAtEnd+f.border}:{from:f.posAtStart,to:f.posAtEnd,typeOver:s.target.nodeValue==s.oldValue}}}let Ao=new WeakMap,Io=!1;function ro(a){let s=a.pmViewDesc;if(s)return s.parseRule();if("BR"==a.nodeName&&a.parentNode){if(de&&/^(ul|ol)$/i.test(a.parentNode.nodeName)){let u=document.createElement("div");return u.appendChild(document.createElement("li")),{skip:u}}if(a.parentNode.lastChild==a||de&&/^(tr|table)$/i.test(a.parentNode.nodeName))return{ignore:!0}}else if("IMG"==a.nodeName&&a.getAttribute("mark-placeholder"))return{ignore:!0};return null}const so=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function lo(a,s,u){return Math.max(u.anchor,u.head)>s.content.size?null:$n(a,s.resolve(u.anchor),s.resolve(u.head))}function pi(a,s,u){let f=a.depth,T=s?a.end():a.pos;for(;f>0&&(s||a.indexAfter(f)==a.node(f).childCount);)f--,T++,s=!1;if(u){let b=a.node(f).maybeChild(a.indexAfter(f));for(;b&&!b.isLeaf;)b=b.firstChild,T++}return T}function ao(a){if(2!=a.length)return!1;let s=a.charCodeAt(0),u=a.charCodeAt(1);return s>=56320&&s<=57343&&u>=55296&&u<=56319}class Fo{constructor(s,u){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new Un,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=u,this.state=u.state,this.directPlugins=u.plugins||[],this.directPlugins.forEach(fi),this.dispatch=this.dispatch.bind(this),this.dom=s&&s.mount||document.createElement("div"),s&&(s.appendChild?s.appendChild(this.dom):"function"==typeof s?s(this.dom):s.mount&&(this.mounted=!0)),this.editable=uo(this),Bo(this),this.nodeViews=Ft(this),this.docView=M(this.state.doc,co(this),Oo(this),this.dom,this),this.domObserver=new Zo(this,(f,T,b,l)=>function Do(a,s,u,f,T){let b=a.input.compositionPendingChanges||(a.composing?a.input.compositionID:0);if(a.input.compositionPendingChanges=0,s<0){let _e=a.input.lastSelectionTime>Date.now()-50?a.input.lastSelectionOrigin:null,Je=Mt(a,_e);if(Je&&!a.state.selection.eq(Je)){if(We&&se&&13===a.input.lastKeyCode&&Date.now()-100<a.input.lastKeyCodeTime&&a.someProp("handleKeyDown",Tt=>Tt(a,me(13,"Enter"))))return;let nt=a.state.tr.setSelection(Je);"pointer"==_e?nt.setMeta("pointer",!0):"key"==_e&&nt.scrollIntoView(),b&&nt.setMeta("composition",b),a.dispatch(nt)}return}let l=a.state.doc.resolve(s),o=l.sharedDepth(u);s=l.before(o+1),u=a.state.doc.resolve(u).after(o+1);let v,S,c=a.state.selection,p=function Xo(a,s,u){let p,{node:f,fromOffset:T,toOffset:b,from:l,to:o}=a.docView.parseRange(s,u),c=a.domSelectionRange(),g=c.anchorNode;if(g&&a.dom.contains(1==g.nodeType?g:g.parentNode)&&(p=[{node:g,offset:c.anchorOffset}],ze(c)||p.push({node:c.focusNode,offset:c.focusOffset})),We&&8===a.input.lastKeyCode)for(let H=b;H>T;H--){let $=f.childNodes[H-1],J=$.pmViewDesc;if("BR"==$.nodeName&&!J){b=H;break}if(!J||J.size)break}let y=a.state.doc,v=a.someProp("domParser")||Te.aw.fromSchema(a.state.schema),S=y.resolve(l),O=null,D=v.parse(f,{topNode:S.parent,topMatch:S.parent.contentMatchAt(S.index()),topOpen:!0,from:T,to:b,preserveWhitespace:"pre"!=S.parent.type.whitespace||"full",findPositions:p,ruleFromNode:ro,context:S});if(p&&null!=p[0].pos){let H=p[0].pos,$=p[1]&&p[1].pos;null==$&&($=H),O={anchor:H+l,head:$+l}}return{doc:D,sel:O,from:l,to:o}}(a,s,u),g=a.state.doc,y=g.slice(p.from,p.to);8===a.input.lastKeyCode&&Date.now()-100<a.input.lastKeyCodeTime?(v=a.state.selection.to,S="end"):(v=a.state.selection.from,S="start"),a.input.lastKeyCode=null;let O=function dn(a,s,u,f,T){let b=a.findDiffStart(s,u);if(null==b)return null;let{a:l,b:o}=a.findDiffEnd(s,u+a.size,u+s.size);if("end"==T&&(f-=l+Math.max(0,b-Math.min(l,o))-b),l<b&&a.size<s.size){let c=f<=b&&f>=l?b-f:0;b-=c,b&&b<s.size&&ao(s.textBetween(b-1,b+1))&&(b+=c?1:-1),o=b+(o-l),l=b}else if(o<b){let c=f<=b&&f>=o?b-f:0;b-=c,b&&b<a.size&&ao(a.textBetween(b-1,b+1))&&(b+=c?1:-1),l=b+(l-o),o=b}return{start:b,endA:l,endB:o}}(y.content,p.doc.content,p.from,v,S);if((B&&a.input.lastIOSEnter>Date.now()-225||se)&&T.some(_e=>1==_e.nodeType&&!so.test(_e.nodeName))&&(!O||O.endA>=O.endB)&&a.someProp("handleKeyDown",_e=>_e(a,me(13,"Enter"))))return void(a.input.lastIOSEnter=0);if(!O){if(!(f&&c instanceof z.Bs&&!c.empty&&c.$head.sameParent(c.$anchor))||a.composing||p.sel&&p.sel.anchor!=p.sel.head){if(p.sel){let _e=lo(a,a.state.doc,p.sel);if(_e&&!_e.eq(a.state.selection)){let Je=a.state.tr.setSelection(_e);b&&Je.setMeta("composition",b),a.dispatch(Je)}}return}O={start:c.from,endA:c.to,endB:c.to}}if(We&&a.cursorWrapper&&p.sel&&p.sel.anchor==a.cursorWrapper.deco.from&&p.sel.head==p.sel.anchor){let _e=O.endB-O.start;p.sel={anchor:p.sel.anchor+_e,head:p.sel.anchor+_e}}a.input.domChangeCount++,a.state.selection.from<a.state.selection.to&&O.start==O.endB&&a.state.selection instanceof z.Bs&&(O.start>a.state.selection.from&&O.start<=a.state.selection.from+2&&a.state.selection.from>=p.from?O.start=a.state.selection.from:O.endA<a.state.selection.to&&O.endA>=a.state.selection.to-2&&a.state.selection.to<=p.to&&(O.endB+=a.state.selection.to-O.endA,O.endA=a.state.selection.to)),Fe&&st<=11&&O.endB==O.start+1&&O.endA==O.start&&O.start>p.from&&" \xa0"==p.doc.textBetween(O.start-p.from-1,O.start-p.from+1)&&(O.start--,O.endA--,O.endB--);let X,D=p.doc.resolveNoCache(O.start-p.from),H=p.doc.resolveNoCache(O.endB-p.from),$=g.resolve(O.start),J=D.sameParent(H)&&D.parent.inlineContent&&$.end()>=O.endA;if((B&&a.input.lastIOSEnter>Date.now()-225&&(!J||T.some(_e=>"DIV"==_e.nodeName||"P"==_e.nodeName))||!J&&D.pos<p.doc.content.size&&!D.sameParent(H)&&(X=z.Y1.findFrom(p.doc.resolve(D.pos+1),1,!0))&&X.head==H.pos)&&a.someProp("handleKeyDown",_e=>_e(a,me(13,"Enter"))))return void(a.input.lastIOSEnter=0);if(a.state.selection.anchor>O.start&&function Ro(a,s,u,f,T){if(!f.parent.isTextblock||u-s<=T.pos-f.pos||pi(f,!0,!1)<T.pos)return!1;let b=a.resolve(s);if(b.parentOffset<b.parent.content.size||!b.parent.isTextblock)return!1;let l=a.resolve(pi(b,!0,!0));return!(!l.parent.isTextblock||l.pos>u||pi(l,!0,!1)<u)&&f.parent.content.cut(f.parentOffset).eq(l.parent.content)}(g,O.start,O.endA,D,H)&&a.someProp("handleKeyDown",_e=>_e(a,me(8,"Backspace"))))return void(se&&We&&a.domObserver.suppressSelectionUpdates());We&&se&&O.endB==O.start&&(a.input.lastAndroidDelete=Date.now()),se&&!J&&D.start()!=H.start()&&0==H.parentOffset&&D.depth==H.depth&&p.sel&&p.sel.anchor==p.sel.head&&p.sel.head==O.endA&&(O.endB-=2,H=p.doc.resolveNoCache(O.endB-p.from),setTimeout(()=>{a.someProp("handleKeyDown",function(_e){return _e(a,me(13,"Enter"))})},20));let ce,fe,Be,re=O.start,ue=O.endA;if(J)if(D.pos==H.pos)Fe&&st<=11&&0==D.parentOffset&&(a.domObserver.suppressSelectionUpdates(),setTimeout(()=>ct(a),20)),ce=a.state.tr.delete(re,ue),fe=g.resolve(O.start).marksAcross(g.resolve(O.endA));else if(O.endA==O.endB&&(Be=function Po(a,s){let l,o,c,u=a.firstChild.marks,f=s.firstChild.marks,T=u,b=f;for(let g=0;g<f.length;g++)T=f[g].removeFromSet(T);for(let g=0;g<u.length;g++)b=u[g].removeFromSet(b);if(1==T.length&&0==b.length)o=T[0],l="add",c=g=>g.mark(o.addToSet(g.marks));else{if(0!=T.length||1!=b.length)return null;o=b[0],l="remove",c=g=>g.mark(o.removeFromSet(g.marks))}let p=[];for(let g=0;g<s.childCount;g++)p.push(c(s.child(g)));if(Te.HY.from(p).eq(a))return{mark:o,type:l}}(D.parent.content.cut(D.parentOffset,H.parentOffset),$.parent.content.cut($.parentOffset,O.endA-$.start()))))ce=a.state.tr,"add"==Be.type?ce.addMark(re,ue,Be.mark):ce.removeMark(re,ue,Be.mark);else if(D.parent.child(D.index()).isText&&D.index()==H.index()-(H.textOffset?0:1)){let _e=D.parent.textBetween(D.parentOffset,H.parentOffset);if(a.someProp("handleTextInput",Je=>Je(a,re,ue,_e)))return;ce=a.state.tr.insertText(_e,re,ue)}if(ce||(ce=a.state.tr.replace(re,ue,p.doc.slice(O.start-p.from,O.endB-p.from))),p.sel){let _e=lo(a,ce.doc,p.sel);_e&&!(We&&se&&a.composing&&_e.empty&&(O.start!=O.endB||a.input.lastAndroidDelete<Date.now()-100)&&(_e.head==re||_e.head==ce.mapping.map(ue)-1)||Fe&&_e.empty&&_e.head==re)&&ce.setSelection(_e)}fe&&ce.ensureMarks(fe),b&&ce.setMeta("composition",b),a.dispatch(ce.scrollIntoView())}(this,f,T,b,l)),this.domObserver.start(),function Ai(a){for(let s in ft){let u=ft[s];a.dom.addEventListener(s,a.input.eventHandlers[s]=f=>{wo(a,f)&&!Di(a,f)&&(a.editable||!(f.type in ht))&&u(a,f)},ko[s]?{passive:!0}:void 0)}de&&a.dom.addEventListener("input",()=>null),Ii(a)}(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let s=this._props;this._props={};for(let u in s)this._props[u]=s[u];this._props.state=this.state}return this._props}update(s){s.handleDOMEvents!=this._props.handleDOMEvents&&Ii(this);let u=this._props;this._props=s,s.plugins&&(s.plugins.forEach(fi),this.directPlugins=s.plugins),this.updateStateInner(s.state,u)}setProps(s){let u={};for(let f in this._props)u[f]=this._props[f];u.state=this.state;for(let f in s)u[f]=s[f];this.update(u)}updateState(s){this.updateStateInner(s,this._props)}updateStateInner(s,u){var f;let T=this.state,b=!1,l=!1;s.storedMarks&&this.composing&&(to(this),l=!0),this.state=s;let o=T.plugins!=s.plugins||this._props.plugins!=u.plugins;if(o||this._props.plugins!=u.plugins||this._props.nodeViews!=u.nodeViews){let S=Ft(this);(function Hi(a,s){let u=0,f=0;for(let T in a){if(a[T]!=s[T])return!0;u++}for(let T in s)f++;return u!=f})(S,this.nodeViews)&&(this.nodeViews=S,b=!0)}(o||u.handleDOMEvents!=this._props.handleDOMEvents)&&Ii(this),this.editable=uo(this),Bo(this);let c=Oo(this),p=co(this),g=T.plugins==s.plugins||T.doc.eq(s.doc)?s.scrollToSelection>T.scrollToSelection?"to selection":"preserve":"reset",y=b||!this.docView.matchesNode(s.doc,p,c);(y||!s.selection.eq(T.selection))&&(l=!0);let v="preserve"==g&&l&&null==this.dom.style.overflowAnchor&&function kt(a){let f,T,s=a.dom.getBoundingClientRect(),u=Math.max(0,s.top);for(let b=(s.left+s.right)/2,l=u+1;l<Math.min(innerHeight,s.bottom);l+=5){let o=a.root.elementFromPoint(b,l);if(!o||o==a.dom||!a.dom.contains(o))continue;let c=o.getBoundingClientRect();if(c.top>=u-20){f=o,T=c.top;break}}return{refDOM:f,refTop:T,stack:qt(a.dom)}}(this);if(l){this.domObserver.stop();let S=y&&(Fe||We)&&!this.composing&&!T.selection.empty&&!s.selection.empty&&function Gn(a,s){let u=Math.min(a.$anchor.sharedDepth(a.head),s.$anchor.sharedDepth(s.head));return a.$anchor.start(u)!=s.$anchor.start(u)}(T.selection,s.selection);if(y){let O=We?this.trackWrites=this.domSelectionRange().focusNode:null;(b||!this.docView.update(s.doc,p,c,this))&&(this.docView.updateOuterDeco([]),this.docView.destroy(),this.docView=M(s.doc,p,c,this.dom,this)),O&&!this.trackWrites&&(S=!0)}S||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&function bo(a){let s=a.docView.domFromPos(a.state.selection.anchor,0),u=a.domSelectionRange();return Ae(s.node,s.offset,u.anchorNode,u.anchorOffset)}(this))?ct(this,S):(Ui(this,s.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(T),!(null===(f=this.dragging)||void 0===f)&&f.node&&!T.doc.eq(s.doc)&&this.updateDraggedNode(this.dragging,T),"reset"==g?this.dom.scrollTop=0:"to selection"==g?this.scrollToSelection():v&&function Wt({refDOM:a,refTop:s,stack:u}){let f=a?a.getBoundingClientRect().top:0;zt(u,0==f?0:f-s)}(v)}scrollToSelection(){let s=this.domSelectionRange().focusNode;if(!this.someProp("handleScrollToSelection",u=>u(this)))if(this.state.selection instanceof z.qv){let u=this.docView.domAfterPos(this.state.selection.from);1==u.nodeType&&Xe(this,u.getBoundingClientRect(),s)}else Xe(this,this.coordsAtPos(this.state.selection.head,1),s)}destroyPluginViews(){let s;for(;s=this.pluginViews.pop();)s.destroy&&s.destroy()}updatePluginViews(s){if(s&&s.plugins==this.state.plugins&&this.directPlugins==this.prevDirectPlugins)for(let u=0;u<this.pluginViews.length;u++){let f=this.pluginViews[u];f.update&&f.update(this,s)}else{this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let u=0;u<this.directPlugins.length;u++){let f=this.directPlugins[u];f.spec.view&&this.pluginViews.push(f.spec.view(this))}for(let u=0;u<this.state.plugins.length;u++){let f=this.state.plugins[u];f.spec.view&&this.pluginViews.push(f.spec.view(this))}}}updateDraggedNode(s,u){let f=s.node,T=-1;if(this.state.doc.nodeAt(f.from)==f.node)T=f.from;else{let b=f.from+(this.state.doc.content.size-u.doc.content.size);(b>0&&this.state.doc.nodeAt(b))==f.node&&(T=b)}this.dragging=new An(s.slice,s.move,T<0?void 0:z.qv.create(this.state.doc,T))}someProp(s,u){let T,f=this._props&&this._props[s];if(null!=f&&(T=u?u(f):f))return T;for(let l=0;l<this.directPlugins.length;l++){let o=this.directPlugins[l].props[s];if(null!=o&&(T=u?u(o):o))return T}let b=this.state.plugins;if(b)for(let l=0;l<b.length;l++){let o=b[l].props[s];if(null!=o&&(T=u?u(o):o))return T}}hasFocus(){if(Fe){let s=this.root.activeElement;if(s==this.dom)return!0;if(!s||!this.dom.contains(s))return!1;for(;s&&this.dom!=s&&this.dom.contains(s);){if("false"==s.contentEditable)return!1;s=s.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&function Ct(a){if(a.setActive)return a.setActive();if(At)return a.focus(At);let s=qt(a);a.focus(null==At?{get preventScroll(){return At={preventScroll:!0},!0}}:void 0),At||(At=!1,zt(s,0))}(this.dom),ct(this),this.domObserver.start()}get root(){let s=this._root;if(null==s)for(let u=this.dom.parentNode;u;u=u.parentNode)if(9==u.nodeType||11==u.nodeType&&u.host)return u.getSelection||(Object.getPrototypeOf(u).getSelection=()=>u.ownerDocument.getSelection()),this._root=u;return s||document}updateRoot(){this._root=null}posAtCoords(s){return en(this,s)}coordsAtPos(s,u=1){return tn(this,s,u)}domAtPos(s,u=0){return this.docView.domFromPos(s,u)}nodeDOM(s){let u=this.docView.descAt(s);return u?u.nodeDOM:null}posAtDOM(s,u,f=-1){let T=this.docView.posFromDOM(s,u,f);if(null==T)throw new RangeError("DOM position not inside the editor");return T}endOfTextblock(s,u){return function k(a,s,u){return $t==s&&K==u?w:($t=s,K=u,w="up"==u||"down"==u?function Pt(a,s,u){let f=s.selection,T="up"==u?f.$from:f.$to;return Dt(a,s,()=>{let{node:b}=a.docView.domFromPos(T.pos,"up"==u?-1:1);for(;;){let o=a.docView.nearestDesc(b,!0);if(!o)break;if(o.node.isBlock){b=o.contentDOM||o.dom;break}b=o.dom.parentNode}let l=tn(a,T.pos,1);for(let o=b.firstChild;o;o=o.nextSibling){let c;if(1==o.nodeType)c=o.getClientRects();else{if(3!=o.nodeType)continue;c=Le(o,0,o.nodeValue.length).getClientRects()}for(let p=0;p<c.length;p++){let g=c[p];if(g.bottom>g.top+1&&("up"==u?l.top-g.top>2*(g.bottom-l.top):g.bottom-l.bottom>2*(l.bottom-g.top)))return!1}}return!0})}(a,s,u):function Rt(a,s,u){let{$head:f}=s.selection;if(!f.parent.isTextblock)return!1;let T=f.parentOffset,b=!T,l=T==f.parent.content.size,o=a.domSelection();return St.test(f.parent.textContent)&&o.modify?Dt(a,s,()=>{let{focusNode:c,focusOffset:p,anchorNode:g,anchorOffset:y}=a.domSelectionRange(),v=o.caretBidiLevel;o.modify("move",u,"character");let S=f.depth?a.docView.domAfterPos(f.before()):a.dom,{focusNode:O,focusOffset:D}=a.domSelectionRange(),H=O&&!S.contains(1==O.nodeType?O:O.parentNode)||c==O&&p==D;try{o.collapse(g,y),c&&(c!=g||p!=y)&&o.extend&&o.extend(c,p)}catch{}return null!=v&&(o.caretBidiLevel=v),H}):"left"==u||"backward"==u?b:l}(a,s,u))}(this,u||this.state,s)}pasteHTML(s,u){return _n(this,"",s,!1,u||new ClipboardEvent("paste"))}pasteText(s,u){return _n(this,s,null,!0,u||new ClipboardEvent("paste"))}destroy(){this.docView&&(function ye(a){a.domObserver.stop();for(let s in a.input.eventHandlers)a.dom.removeEventListener(s,a.input.eventHandlers[s]);clearTimeout(a.input.composingTimeout),clearTimeout(a.input.lastIOSEnterFallbackTimeout)}(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],Oo(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null)}get isDestroyed(){return null==this.docView}dispatchEvent(s){return function So(a,s){!Di(a,s)&&ft[s.type]&&(a.editable||!(s.type in ht))&&ft[s.type](a,s)}(this,s)}dispatch(s){let u=this._props.dispatchTransaction;u?u.call(this,s):this.updateState(this.state.apply(s))}domSelectionRange(){return de&&11===this.root.nodeType&&function xe(a){let s=a.activeElement;for(;s&&s.shadowRoot;)s=s.shadowRoot.activeElement;return s}(this.dom.ownerDocument)==this.dom?function qo(a){let s;function u(c){c.preventDefault(),c.stopImmediatePropagation(),s=c.getTargetRanges()[0]}a.dom.addEventListener("beforeinput",u,!0),document.execCommand("indent"),a.dom.removeEventListener("beforeinput",u,!0);let f=s.startContainer,T=s.startOffset,b=s.endContainer,l=s.endOffset,o=a.domAtPos(a.state.selection.anchor);return Ae(o.node,o.offset,b,l)&&([f,T,b,l]=[b,l,f,T]),{anchorNode:f,anchorOffset:T,focusNode:b,focusOffset:l}}(this):this.domSelection()}domSelection(){return this.root.getSelection()}}function co(a){let s=Object.create(null);return s.class="ProseMirror",s.contenteditable=String(a.editable),a.someProp("attributes",u=>{if("function"==typeof u&&(u=u(a.state)),u)for(let f in u)"class"==f?s.class+=" "+u[f]:"style"==f?s.style=(s.style?s.style+";":"")+u[f]:!s[f]&&"contenteditable"!=f&&"nodeName"!=f&&(s[f]=String(u[f]))}),s.translate||(s.translate="no"),[vt.node(0,a.state.doc.content.size,s)]}function Bo(a){if(a.markCursor){let s=document.createElement("img");s.className="ProseMirror-separator",s.setAttribute("mark-placeholder","true"),s.setAttribute("alt",""),a.cursorWrapper={dom:s,deco:vt.widget(a.state.selection.head,s,{raw:!0,marks:a.markCursor})}}else a.cursorWrapper=null}function uo(a){return!a.someProp("editable",s=>!1===s(a.state))}function Ft(a){let s=Object.create(null);function u(f){for(let T in f)Object.prototype.hasOwnProperty.call(s,T)||(s[T]=f[T])}return a.someProp("nodeViews",u),a.someProp("markViews",u),s}function fi(a){if(a.spec.state||a.spec.filterTransaction||a.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}}}]);