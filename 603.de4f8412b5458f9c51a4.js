"use strict";(self.webpackChunkng_web_apis=self.webpackChunkng_web_apis||[]).push([[603],{7892:(S,b,o)=>{o.r(b),o.d(b,{PaymentRequestPageModule:()=>C});var e=o(1453),t=o(4788),a=o(2554),s=o(2057),r=o(5219),d=o(5087),c=o(6823);function l(i,h){if(1&i){const n=t.EpF();t.TgZ(0,"div",8),t.NdJ("click",function(){const E=t.CHM(n).$implicit;return t.oxw().addToShippintCard(E)}),t._UZ(1,"img",9),t.TgZ(2,"label",10),t._uU(3),t.qZA(),t.TgZ(4,"p",11),t._uU(5),t.qZA(),t.qZA()}if(2&i){const n=h.$implicit;t.xp6(1),t.Q6J("src",n.image,t.LSH),t.xp6(2),t.Oqu(n.label),t.xp6(2),t.hij("",n.price," \u20bd")}}function u(i,h){if(1&i&&(t.TgZ(0,"div",13),t._uU(1),t.qZA()),2&i){const n=h.$implicit;t.Q6J("paymentLabel",n.label)("paymentAmount",n.amount),t.xp6(1),t.lnq(" ",n.label," (",n.amount.value," ",n.amount.currency,") ")}}function g(i,h){if(1&i&&(t.ynx(0),t.YNc(1,u,2,5,"div",12),t.BQk()),2&i){const n=t.oxw();t.xp6(1),t.Q6J("ngForOf",n.shippingCart)}}function f(i,h){1&i&&t._uU(0,"Nothing added")}class y{constructor(h,n,p){this.image=h,this.label=n,this.price=p}get amount(){return{currency:"RUB",value:String(this.price)}}}let m=(()=>{class i{constructor(){this.items=[new y("https://image.flaticon.com/icons/svg/1868/1868178.svg","Matryoshka",50),new y("https://image.flaticon.com/icons/svg/820/820158.svg","Balalaika",100),new y("https://image.flaticon.com/icons/svg/1868/1868169.svg","Ushanka",70),new y("https://image.flaticon.com/icons/svg/1868/1868226.svg","Kokoshnik",70),new y("https://image.flaticon.com/icons/svg/1868/1868276.svg","Borscht",10),new y("https://image.flaticon.com/icons/svg/1868/1868380.svg","Sputnik",1e3)],this.shippingCart=[]}get totalSum(){return this.shippingCart.reduce((n,p)=>n+p.price,0)}get total(){return{label:"Total",amount:{currency:"RUB",value:String(this.totalSum)}}}addToShippintCard(n){this.shippingCart=[...this.shippingCart,n]}onPayment(n){console.info("payment response:",n),this.clearShippingCart(),n.complete()}onPaymentError(n){console.info("payment error:",n),this.clearShippingCart()}clearShippingCart(){this.shippingCart=[]}}return i.\u0275fac=function(n){return new(n||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-shop"]],decls:15,vars:6,consts:[[1,"items"],["class","item",3,"click",4,"ngFor","ngForOf"],["waPayment","",1,"shopping-cart",3,"paymentTotal"],[1,"sticky"],[4,"ngIf","ngIfElse"],["noItems",""],[1,"total"],[1,"buy-button",3,"disabled","waPaymentSubmit","waPaymentError"],[1,"item",3,"click"],["width","64",1,"item-image",3,"src"],[1,"item-label"],[1,"item-price"],["waPaymentItem","","class","shopping-card-item",3,"paymentLabel","paymentAmount",4,"ngFor","ngForOf"],["waPaymentItem","",1,"shopping-card-item",3,"paymentLabel","paymentAmount"]],template:function(n,p){if(1&n&&(t.TgZ(0,"div",0),t.YNc(1,l,6,3,"div",1),t.qZA(),t.TgZ(2,"div",2),t.TgZ(3,"div",3),t.TgZ(4,"h4"),t._uU(5,"Shopping Cart"),t.qZA(),t.YNc(6,g,2,1,"ng-container",4),t.YNc(7,f,1,0,"ng-template",null,5,t.W1O),t.TgZ(9,"div",6),t.TgZ(10,"b"),t._uU(11,"Total:"),t.qZA(),t._uU(12),t.qZA(),t.TgZ(13,"button",7),t.NdJ("waPaymentSubmit",function(E){return p.onPayment(E)})("waPaymentError",function(E){return p.onPaymentError(E)}),t._uU(14," Buy "),t.qZA(),t.qZA(),t.qZA()),2&n){const T=t.MAs(8);t.xp6(1),t.Q6J("ngForOf",p.items),t.xp6(1),t.Q6J("paymentTotal",p.total),t.xp6(4),t.Q6J("ngIf",p.shippingCart.length>0)("ngIfElse",T),t.xp6(6),t.hij(" ",p.totalSum," \u20bd "),t.xp6(1),t.Q6J("disabled",0===p.shippingCart.length)}},directives:[s.sg,r.u,s.O5,d.x,c.j],styles:["[_nghost-%COMP%]{display:flex}.items[_ngcontent-%COMP%]{flex:2;display:flex;flex-wrap:wrap}@media (max-width: 800px){.items[_ngcontent-%COMP%]{max-width:50%;justify-content:flex-end}}.item[_ngcontent-%COMP%]{width:150px;margin:12px;padding:16px 16px 0;display:flex;flex-direction:column;align-items:center;border:1px solid gainsboro;border-radius:8px;cursor:pointer;transition:box-shadow .3s}.item[_ngcontent-%COMP%]:hover{box-shadow:0 12px 36px #0003}.item-label[_ngcontent-%COMP%]{cursor:inherit}.item-price[_ngcontent-%COMP%]{font-size:smaller}.item-image[_ngcontent-%COMP%]{margin-bottom:12px}.sticky[_ngcontent-%COMP%]{position:sticky;top:16px}.total[_ngcontent-%COMP%]{margin-top:16px}.shopping-card-item[_ngcontent-%COMP%]{margin-top:4px;margin-bottom:4px}.shopping-cart[_ngcontent-%COMP%]{flex:1;max-width:168px;background-color:#f0f0f0;padding:0 16px;border-radius:8px}.buy-button[_ngcontent-%COMP%]{width:100%;margin-top:20px;margin-bottom:8px;background-color:#fff;border:1px solid #ccc;border-radius:4px;padding:4px;cursor:pointer}.buy-button[_ngcontent-%COMP%]:disabled{cursor:default;opacity:.56}"],changeDetection:0}),i})(),P=(()=>{class i{constructor(){this.samples={service:"import {PaymentRequestService} from '@ng-web-apis/payment-request';\n\n// ...\n\nconstructor(private readonly paymentRequest: PaymentRequestService) {}\n\npay(details: PaymentDetailsInit) {\n    this.paymentRequest.request(details).then(\n        response => {\n            response.complete();\n        },\n        error => {},\n    );\n}",directives:'<div\n  waPayment\n  [paymentTotal]="total"\n>\n  <div\n    waPaymentItem\n    [paymentLabel]="label"\n    [paymentAmount]="amount"\n  >\n    {{label}} ({{amount}})\n  </div>\n  <button\n    (waPaymentSubmit)="onPayment($event)"\n    (waPaymentError)="onError($event)"\n  >\n    Buy\n  </button>\n</div>'}}}return i.\u0275fac=function(n){return new(n||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["payment-request-page"]],features:[t._Bn([{provide:e.LM,useValue:[{supportedMethods:"https://apple.com/apple-pay",data:{version:3,merchantIdentifier:"merchant.com.example",merchantCapabilities:["supports3DS","supportsCredit","supportsDebit"],supportedNetworks:["amex","discover","masterCard","visa"],countryCode:"US"}},{supportedMethods:"basic-card"}]}])],decls:45,vars:3,consts:[[1,"wrapper"],["target","_blank","href","https://developer.mozilla.org/en-US/docs/Web/API/Payment_Request_API"],[3,"highlight"],[1,"how-it-works"],[1,"how-it-works-text"],[1,"how-it-works-point"],["target","_blank","href","https://github.com/ng-web-apis/payment-request#waPayment"],["target","_blank","href","https://www.w3.org/TR/payment-request/#paymentitem-dictionary"],["target","_blank","href","https://github.com/ng-web-apis/payment-request#waPaymentItem"],["target","_blank","href","https://developer.mozilla.org/en-US/docs/Web/API/PaymentResponse"],["target","_blank","href","https://github.com/ng-web-apis/payment-request#waPaymentSubmit"],[1,"directive-sample"]],template:function(n,p){1&n&&(t.TgZ(0,"div",0),t.TgZ(1,"p"),t._uU(2," Angular does not have any abstractions over "),t.TgZ(3,"a",1),t._uU(4," PaymentRequest API "),t.qZA(),t._uU(5," . This library provides you two ways to use this API with Angular of 6+ version. "),t.qZA(),t.TgZ(6,"h3"),t._uU(7,"As an Angular service:"),t.qZA(),t.TgZ(8,"pre"),t.TgZ(9,"code",2),t._uU(10),t.qZA(),t.qZA(),t.TgZ(11,"h3"),t._uU(12,"As a set of directives:"),t.qZA(),t.TgZ(13,"p"),t._uU(14,"Click to add some items to a shopping cart:"),t.qZA(),t._UZ(15,"app-shop"),t.TgZ(16,"h4"),t._uU(17,"How it works:"),t.qZA(),t.TgZ(18,"div",3),t.TgZ(19,"div",4),t.TgZ(20,"p",5),t.TgZ(21,"a",6),t._uU(22," waPayment "),t.qZA(),t._uU(23," directive defines a scope for a\xa0new payment and needs "),t.TgZ(24,"a",7),t._uU(25," PaymentItem "),t.qZA(),t._uU(26," object with information about a label and a\xa0total sum of the payment "),t.qZA(),t.TgZ(27,"p",5),t._uU(28," Each item of the shipping cart is a\xa0 "),t.TgZ(29,"a",8),t._uU(30," waPaymentItem "),t.qZA(),t._uU(31," directive. It\xa0is\xa0a\xa0declarative "),t.TgZ(32,"a",7),t._uU(33," PaymentItem "),t.qZA(),t._uU(34," for your Payment "),t.qZA(),t.TgZ(35,"p",5),t._uU(36," Click on the button starts a\xa0PaymentRequest modal in your browser that returns "),t.TgZ(37,"a",9),t._uU(38," PaymentResponse "),t.qZA(),t._uU(39," or an error. It works due a\xa0 "),t.TgZ(40,"a",10),t._uU(41," waPaymentSubmit "),t.qZA(),t._uU(42," directive. "),t.qZA(),t.qZA(),t.TgZ(43,"pre",11),t._UZ(44,"code",2),t.qZA(),t.qZA(),t.qZA()),2&n&&(t.xp6(9),t.Q6J("highlight",p.samples.service),t.xp6(1),t.hij("\n    ",p.samples.service,"\n"),t.xp6(34),t.Q6J("highlight",p.samples.directives))},directives:[a.y$,m],encapsulation:2,changeDetection:0}),i})();var w=o(6618);let C=(()=>{class i{}return i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[[s.ez,a._l,e.th,w.Bz.forChild([{path:"",component:P}])]]}),i})()},2176:(S,b,o)=>{o.d(b,{L1:()=>s,s5:()=>f,m9:()=>a});var e=o(4788),A=o(7980),_=o(815),t=o(2057);const a=new e.OlP("An abstraction over global window object",{factory:()=>{const{defaultView:v}=(0,e.f3M)(t.K0);if(!v)throw new Error("Window is not available");return v}}),s=new e.OlP("Shared Observable based on `window.requestAnimationFrame`",{factory:()=>{const{requestAnimationFrame:v,cancelAnimationFrame:x}=(0,e.f3M)(a);return new A.y(I=>{let O=NaN;const M=R=>{I.next(R),O=v(M)};return O=v(M),()=>{x(O)}}).pipe((0,_.B)())}}),f=(new e.OlP("An abstraction over window.caches object",{factory:()=>(0,e.f3M)(a).caches}),new e.OlP("An abstraction over window.crypto object",{factory:()=>(0,e.f3M)(a).crypto}),new e.OlP("An abstraction over window.CSS object",{factory:()=>(0,e.f3M)(a).CSS||{escape:v=>v,supports:()=>!1}}),new e.OlP("An abstraction over window.history object",{factory:()=>(0,e.f3M)(a).history}),new e.OlP("An abstraction over window.localStorage object",{factory:()=>(0,e.f3M)(a).localStorage}),new e.OlP("An abstraction over window.location object",{factory:()=>(0,e.f3M)(a).location}),new e.OlP("An abstraction over window.navigator object",{factory:()=>(0,e.f3M)(a).navigator}));new e.OlP("An abstraction over window.navigator.mediaDevices object",{factory:()=>(0,e.f3M)(f).mediaDevices}),new e.OlP("An abstraction over window.navigator.connection object",{factory:()=>(0,e.f3M)(f).connection||null});var P=o(4581),w=o(1927),C=o(7969),i=o(2147),h=o(5086);new e.OlP("Shared Observable based on `document visibility changed`",{factory:()=>{const v=(0,e.f3M)(t.K0);return(0,P.R)(v,"visibilitychange").pipe((0,w.O)(0),(0,C.U)(()=>"hidden"!==v.visibilityState),(0,i.x)(),(0,h.d)({refCount:!1,bufferSize:1}))}}),new e.OlP("An abstraction over window.performance object",{factory:()=>(0,e.f3M)(a).performance}),new e.OlP("An abstraction over window.screen object",{factory:()=>(0,e.f3M)(a).screen}),new e.OlP("An abstraction over window.sessionStorage object",{factory:()=>(0,e.f3M)(a).sessionStorage}),new e.OlP("An abstraction over SpeechRecognition class",{factory:()=>{const v=(0,e.f3M)(a);return v.speechRecognition||v.webkitSpeechRecognition||null}}),new e.OlP("An abstraction over window.speechSynthesis object",{factory:()=>(0,e.f3M)(a).speechSynthesis}),new e.OlP("An abstraction over window.navigator.userAgent object",{factory:()=>(0,e.f3M)(f).userAgent})},4581:(S,b,o)=>{o.d(b,{R:()=>l});var e=o(5955),A=o(7980),_=o(3159),t=o(6602),a=o(5975),s=o(2692);const r=["addListener","removeListener"],d=["addEventListener","removeEventListener"],c=["on","off"];function l(m,P,w,C){if((0,a.m)(w)&&(C=w,w=void 0),C)return l(m,P,w).pipe((0,s.Z)(C));const[i,h]=function(m){return(0,a.m)(m.addEventListener)&&(0,a.m)(m.removeEventListener)}(m)?d.map(n=>p=>m[n](P,p,w)):function(m){return(0,a.m)(m.addListener)&&(0,a.m)(m.removeListener)}(m)?r.map(u(m,P)):function(m){return(0,a.m)(m.on)&&(0,a.m)(m.off)}(m)?c.map(u(m,P)):[];if(!i&&(0,t.z)(m))return(0,_.z)(n=>l(n,P,w))((0,e.Xf)(m));if(!i)throw new TypeError("Invalid event target");return new A.y(n=>{const p=(...T)=>n.next(1<T.length?T:T[0]);return i(p),()=>h(p)})}function u(m,P){return w=>C=>m[w](P,C)}},2147:(S,b,o)=>{o.d(b,{x:()=>t});var e=o(8330),A=o(2085),_=o(8499);function t(s,r=e.y){return s=null!=s?s:a,(0,A.e)((d,c)=>{let l,u=!0;d.subscribe(new _.Q(c,g=>{const f=r(g);(u||!s(l,f))&&(u=!1,l=f,c.next(g))}))})}function a(s,r){return s===r}},5086:(S,b,o)=>{o.d(b,{d:()=>a});var e=o(9359),A=o(2069);class _ extends e.x{constructor(r=1/0,d=1/0,c=A.l){super(),this._bufferSize=r,this._windowTime=d,this._timestampProvider=c,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=d===1/0,this._bufferSize=Math.max(1,r),this._windowTime=Math.max(1,d)}next(r){const{isStopped:d,_buffer:c,_infiniteTimeWindow:l,_timestampProvider:u,_windowTime:g}=this;d||(c.push(r),!l&&c.push(u.now()+g)),this._trimBuffer(),super.next(r)}_subscribe(r){this._throwIfClosed(),this._trimBuffer();const d=this._innerSubscribe(r),{_infiniteTimeWindow:c,_buffer:l}=this,u=l.slice();for(let g=0;g<u.length&&!r.closed;g+=c?1:2)r.next(u[g]);return this._checkFinalizedStatuses(r),d}_trimBuffer(){const{_bufferSize:r,_timestampProvider:d,_buffer:c,_infiniteTimeWindow:l}=this,u=(l?1:2)*r;if(r<1/0&&u<c.length&&c.splice(0,c.length-u),!l){const g=d.now();let f=0;for(let y=1;y<c.length&&c[y]<=g;y+=2)f=y;f&&c.splice(0,f+1)}}}var t=o(815);function a(s,r,d){var c,l;let u,g=!1;return s&&"object"==typeof s?(u=null!==(c=s.bufferSize)&&void 0!==c?c:1/0,r=null!==(l=s.windowTime)&&void 0!==l?l:1/0,g=!!s.refCount,d=s.scheduler):u=null!=s?s:1/0,(0,t.B)({connector:()=>new _(u,r,d),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:g})}}}]);