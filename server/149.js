"use strict";exports.id=149,exports.ids=[149],exports.modules={86149:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>payment_request_page_component});var common=__webpack_require__(4594),src=__webpack_require__(31589),ngx_highlightjs=__webpack_require__(25858),core=__webpack_require__(35548);function Shop_div_1_Template(rf,ctx){if(1&rf){const _r6=core.EpF();core.TgZ(0,"div",8),core.NdJ("click",function(){const item_r4=core.CHM(_r6).$implicit,ctx_r5=core.oxw();return core.KtG(ctx_r5.addToShippingCard(item_r4))}),core._UZ(1,"img",9),core.TgZ(2,"label",10),core._uU(3),core.qZA(),core.TgZ(4,"p",11),core._uU(5),core.qZA()()}if(2&rf){const item_r4=ctx.$implicit;core.xp6(1),core.Q6J("src",item_r4.image,core.LSH),core.xp6(2),core.Oqu(item_r4.label),core.xp6(2),core.hij("",item_r4.price," \u20bd")}}function Shop_ng_container_6_div_1_Template(rf,ctx){if(1&rf&&(core.TgZ(0,"div",13),core._uU(1),core.qZA()),2&rf){const cartItem_r8=ctx.$implicit;core.Q6J("paymentAmount",cartItem_r8.amount)("paymentLabel",cartItem_r8.label),core.xp6(1),core.lnq(" ",cartItem_r8.label," (",cartItem_r8.amount.value," ",cartItem_r8.amount.currency,") ")}}function Shop_ng_container_6_Template(rf,ctx){if(1&rf&&(core.ynx(0),core.YNc(1,Shop_ng_container_6_div_1_Template,2,5,"div",12),core.BQk()),2&rf){const ctx_r1=core.oxw();core.xp6(1),core.Q6J("ngForOf",ctx_r1.shippingCart)}}function Shop_ng_template_7_Template(rf,ctx){1&rf&&core._uU(0,"Nothing added")}class ShopItem{constructor(image,label,price){this.image=image,this.label=label,this.price=price}get amount(){return{currency:"RUB",value:String(this.price)}}}let Shop=(()=>{var _Shop;class Shop2{constructor(){this.items=[new ShopItem("https://image.flaticon.com/icons/svg/1868/1868178.svg","Matryoshka",50),new ShopItem("https://image.flaticon.com/icons/svg/820/820158.svg","Balalaika",100),new ShopItem("https://image.flaticon.com/icons/svg/1868/1868169.svg","Ushanka",70),new ShopItem("https://image.flaticon.com/icons/svg/1868/1868226.svg","Kokoshnik",70),new ShopItem("https://image.flaticon.com/icons/svg/1868/1868276.svg","Borscht",10),new ShopItem("https://image.flaticon.com/icons/svg/1868/1868380.svg","Sputnik",1e3)],this.shippingCart=[]}get totalSum(){return this.shippingCart.reduce((sum,item)=>sum+item.price,0)}get total(){return{label:"Total",amount:{currency:"RUB",value:String(this.totalSum)}}}addToShippingCard(item){this.shippingCart=[...this.shippingCart,item]}onPayment(response){console.info("payment response:",response),this.clearShippingCart(),response.complete()}onPaymentError(error){console.info("payment error:",error),this.clearShippingCart()}clearShippingCart(){this.shippingCart=[]}}return(_Shop=Shop2).\u0275fac=function(t){return new(t||_Shop)},_Shop.\u0275cmp=core.Xpm({type:_Shop,selectors:[["app-shop"]],standalone:!0,features:[core.jDz],decls:15,vars:6,consts:[[1,"items"],["class","item",3,"click",4,"ngFor","ngForOf"],["waPayment","",1,"shopping-cart",3,"paymentTotal"],[1,"sticky"],[4,"ngIf","ngIfElse"],["noItems",""],[1,"total"],[1,"buy-button",3,"disabled","waPaymentError","waPaymentSubmit"],[1,"item",3,"click"],["alt","item","width","64",1,"item-image",3,"src"],[1,"item-label"],[1,"item-price"],["waPaymentItem","","class","shopping-card-item",3,"paymentAmount","paymentLabel",4,"ngFor","ngForOf"],["waPaymentItem","",1,"shopping-card-item",3,"paymentAmount","paymentLabel"]],template:function(rf,ctx){if(1&rf&&(core.TgZ(0,"div",0),core.YNc(1,Shop_div_1_Template,6,3,"div",1),core.qZA(),core.TgZ(2,"div",2)(3,"div",3)(4,"h4"),core._uU(5,"Shopping Cart"),core.qZA(),core.YNc(6,Shop_ng_container_6_Template,2,1,"ng-container",4),core.YNc(7,Shop_ng_template_7_Template,1,0,"ng-template",null,5,core.W1O),core.TgZ(9,"div",6)(10,"b"),core._uU(11,"Total:"),core.qZA(),core._uU(12),core.qZA(),core.TgZ(13,"button",7),core.NdJ("waPaymentError",function($event){return ctx.onPaymentError($event)})("waPaymentSubmit",function($event){return ctx.onPayment($event)}),core._uU(14," Buy "),core.qZA()()()),2&rf){const _r2=core.MAs(8);core.xp6(1),core.Q6J("ngForOf",ctx.items),core.xp6(1),core.Q6J("paymentTotal",ctx.total),core.xp6(4),core.Q6J("ngIf",ctx.shippingCart.length>0)("ngIfElse",_r2),core.xp6(6),core.hij(" ",ctx.totalSum," \u20bd "),core.xp6(1),core.Q6J("disabled",0===ctx.shippingCart.length)}},dependencies:[common.sg,common.O5,src.Ag,src.zv,src.pG],styles:["[_nghost-%COMP%]{display:flex}.items[_ngcontent-%COMP%]{flex:2;display:flex;flex-wrap:wrap}@media (max-width: 800px){.items[_ngcontent-%COMP%]{max-width:50%;justify-content:flex-end}}.item[_ngcontent-%COMP%]{width:150px;margin:12px;padding:16px 16px 0;display:flex;flex-direction:column;align-items:center;border:1px solid gainsboro;border-radius:8px;cursor:pointer;transition:box-shadow .3s}.item[_ngcontent-%COMP%]:hover{box-shadow:0 12px 36px #0003}.item-label[_ngcontent-%COMP%]{cursor:inherit}.item-price[_ngcontent-%COMP%]{font-size:smaller}.item-image[_ngcontent-%COMP%]{margin-bottom:12px}.sticky[_ngcontent-%COMP%]{position:sticky;top:16px}.total[_ngcontent-%COMP%]{margin-top:16px}.shopping-card-item[_ngcontent-%COMP%]{margin-top:4px;margin-bottom:4px}.shopping-cart[_ngcontent-%COMP%]{flex:1;max-width:168px;background-color:#f0f0f0;padding:0 16px;border-radius:8px}.buy-button[_ngcontent-%COMP%]{width:100%;margin-top:20px;margin-bottom:8px;background-color:#fff;border:1px solid #ccc;border-radius:4px;padding:4px;cursor:pointer}.buy-button[_ngcontent-%COMP%]:disabled{cursor:default;opacity:.56}"],changeDetection:0}),Shop2})();const payment_request_page_component=(()=>{var _PaymentRequestPage;class PaymentRequestPage2{constructor(){this.samples={service:"import {PaymentRequestService} from '@ng-web-apis/payment-request';\n\n// ...\n\nconstructor(private readonly paymentRequest: PaymentRequestService) {}\n\npay(details: PaymentDetailsInit) {\n    this.paymentRequest.request(details).then(\n        response => {\n            response.complete();\n        },\n        error => {},\n    );\n}",directives:'<div\n  waPayment\n  [paymentTotal]="total"\n>\n  <div\n    waPaymentItem\n    [paymentLabel]="label"\n    [paymentAmount]="amount"\n  >\n    {{label}} ({{amount}})\n  </div>\n  <button\n    (waPaymentSubmit)="onPayment($event)"\n    (waPaymentError)="onError($event)"\n  >\n    Buy\n  </button>\n</div>'}}}return(_PaymentRequestPage=PaymentRequestPage2).\u0275fac=function(t){return new(t||_PaymentRequestPage)},_PaymentRequestPage.\u0275cmp=core.Xpm({type:_PaymentRequestPage,selectors:[["payment-request-page"]],standalone:!0,features:[core._Bn([{provide:src.LM,useValue:[{supportedMethods:"https://apple.com/apple-pay",data:{version:3,merchantIdentifier:"merchant.com.example",merchantCapabilities:["supports3DS","supportsCredit","supportsDebit"],supportedNetworks:["amex","discover","masterCard","visa"],countryCode:"US"}},{supportedMethods:"basic-card"}]}]),core.jDz],decls:45,vars:3,consts:[[1,"wrapper"],["href","https://developer.mozilla.org/en-US/docs/Web/API/Payment_Request_API","rel","noreferrer","target","_blank"],[3,"highlight"],[1,"how-it-works"],[1,"how-it-works-text"],[1,"how-it-works-point"],["href","https://github.com/taiga-family/ng-web-apis/tree/main/libs/payment-request#wapayment","rel","noreferrer","target","_blank"],["href","https://www.w3.org/TR/payment-request/#paymentitem-dictionary","rel","noreferrer","target","_blank"],["href","https://github.com/taiga-family/ng-web-apis/tree/main/libs/payment-request#waPaymentItem","rel","noreferrer","target","_blank"],["href","https://developer.mozilla.org/en-US/docs/Web/API/PaymentResponse","rel","noreferrer","target","_blank"],["href","https://github.com/taiga-family/ng-web-apis/tree/main/libs/payment-request#waPaymentSubmit","rel","noreferrer","target","_blank"],[1,"directive-sample"]],template:function(rf,ctx){1&rf&&(core.TgZ(0,"div",0)(1,"p"),core._uU(2," Angular does not have any abstractions over "),core.TgZ(3,"a",1),core._uU(4," PaymentRequest API "),core.qZA(),core._uU(5," . This library provides you two ways to use this API with Angular of 6+ version. "),core.qZA(),core.TgZ(6,"h3"),core._uU(7,"As an Angular service:"),core.qZA(),core.TgZ(8,"pre")(9,"code",2),core._uU(10),core.qZA()(),core.TgZ(11,"h3"),core._uU(12,"As a set of directives:"),core.qZA(),core.TgZ(13,"p"),core._uU(14,"Click to add some items to a shopping cart:"),core.qZA(),core._UZ(15,"app-shop"),core.TgZ(16,"h4"),core._uU(17,"How it works:"),core.qZA(),core.TgZ(18,"div",3)(19,"div",4)(20,"p",5)(21,"a",6),core._uU(22," waPayment "),core.qZA(),core._uU(23," directive defines a scope for a\xa0new payment and needs "),core.TgZ(24,"a",7),core._uU(25," PaymentItem "),core.qZA(),core._uU(26," object with information about a label and a\xa0total sum of the payment "),core.qZA(),core.TgZ(27,"p",5),core._uU(28," Each item of the shipping cart is a\xa0 "),core.TgZ(29,"a",8),core._uU(30," waPaymentItem "),core.qZA(),core._uU(31," directive. It\xa0is\xa0a\xa0declarative "),core.TgZ(32,"a",7),core._uU(33," PaymentItem "),core.qZA(),core._uU(34," for your Payment "),core.qZA(),core.TgZ(35,"p",5),core._uU(36," Click on the button starts a\xa0PaymentRequest modal in your browser that returns "),core.TgZ(37,"a",9),core._uU(38," PaymentResponse "),core.qZA(),core._uU(39," or an error. It works due a\xa0 "),core.TgZ(40,"a",10),core._uU(41," waPaymentSubmit "),core.qZA(),core._uU(42," directive. "),core.qZA()(),core.TgZ(43,"pre",11),core._UZ(44,"code",2),core.qZA()()()),2&rf&&(core.xp6(9),core.Q6J("highlight",ctx.samples.service),core.xp6(1),core.hij("\n    ",ctx.samples.service,"\n"),core.xp6(34),core.Q6J("highlight",ctx.samples.directives))},dependencies:[common.ez,ngx_highlightjs._l,ngx_highlightjs.y$,Shop],styles:["[_nghost-%COMP%]{display:block;max-width:600px;margin:0 auto}.wrapper[_ngcontent-%COMP%]{padding:0 10px}.how-it-works[_ngcontent-%COMP%]{position:relative;display:flex;flex-wrap:wrap}.how-it-works-point[_ngcontent-%COMP%]{margin-top:26px;margin-bottom:26px}.how-it-works-text[_ngcontent-%COMP%]{flex:1;min-width:300px;margin:8px}.directive-sample[_ngcontent-%COMP%]{display:block;flex:1;margin:8px;width:330px}.directive-sample-arrow[_ngcontent-%COMP%]{position:absolute;right:95px;top:-42px}"],changeDetection:0}),PaymentRequestPage2})()},31589:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{LM:()=>PAYMENT_METHODS,aB:()=>PAYMENT_REQUEST_SUPPORT,Ag:()=>WaPayment,zv:()=>WaPaymentItem,pG:()=>WaPaymentSubmit});var core=__webpack_require__(35548);let WaPaymentItem=(()=>{var _WaPaymentItem;class WaPaymentItem2{}return(_WaPaymentItem=WaPaymentItem2).\u0275fac=function(t){return new(t||_WaPaymentItem)},_WaPaymentItem.\u0275dir=core.lG2({type:_WaPaymentItem,selectors:[["","waPaymentItem","","paymentAmount","","paymentLabel",""]],inputs:{amount:["paymentAmount","amount"],label:["paymentLabel","label"],pending:["paymentPending","pending"]},standalone:!0}),WaPaymentItem2})(),WaPayment=(()=>{var _WaPayment;class WaPayment2{set paymentItems(items){this.displayItems=items.toArray()}}return(_WaPayment=WaPayment2).\u0275fac=function(t){return new(t||_WaPayment)},_WaPayment.\u0275dir=core.lG2({type:_WaPayment,selectors:[["","waPayment","","paymentTotal",""]],contentQueries:function(rf,ctx,dirIndex){if(1&rf&&core.Suo(dirIndex,WaPaymentItem,4),2&rf){let _t;core.iGM(_t=core.CRH())&&(ctx.paymentItems=_t)}},inputs:{total:["paymentTotal","total"],id:["paymentId","id"],modifiers:["paymentModifiers","modifiers"],shippingOptions:["paymentShippingOptions","shippingOptions"]},standalone:!0}),WaPayment2})();var fromEvent=__webpack_require__(59359),switchMap=__webpack_require__(275),from=__webpack_require__(37384),catchError=__webpack_require__(11751),of=__webpack_require__(97318),share=__webpack_require__(89407),filter=__webpack_require__(13591),asyncToGenerator=__webpack_require__(8239);const PAYMENT_METHODS=new core.OlP("[PAYMENT_METHODS]: The methods used by Request Payment API",{factory:()=>[{supportedMethods:"basic-card"}]}),PAYMENT_OPTIONS=new core.OlP("[PAYMENT_OPTIONS]: Additional data requests from payer",{factory:()=>({})});var src=__webpack_require__(88108);const PAYMENT_REQUEST_SUPPORT=new core.OlP("[PAYMENT_REQUEST_SUPPORT]: Is Payment Request Api supported?",{factory:()=>!!(0,core.f3M)(src.m9).PaymentRequest});let PaymentRequestService=(()=>{var _PaymentRequestService;class PaymentRequestService2{constructor(){this.supported=(0,core.f3M)(PAYMENT_REQUEST_SUPPORT),this.paymentMethods=(0,core.f3M)(PAYMENT_METHODS),this.paymentOptions=(0,core.f3M)(PAYMENT_OPTIONS)}request(details,methods=this.paymentMethods,options=this.paymentOptions){var _this=this;return(0,asyncToGenerator.Z)(function*(){if(!_this.supported)return Promise.reject(new Error("Payment Request is not supported in your browser"));const gateway=new PaymentRequest(methods,details,options);return gateway.canMakePayment().then(function(){var _ref=(0,asyncToGenerator.Z)(function*(canPay){return canPay?gateway.show(details):Promise.reject(new Error("Payment Request cannot make the payment"))});return function(_x){return _ref.apply(this,arguments)}}())})()}}return(_PaymentRequestService=PaymentRequestService2).\u0275fac=function(t){return new(t||_PaymentRequestService)},_PaymentRequestService.\u0275prov=core.Yz7({token:_PaymentRequestService,factory:_PaymentRequestService.\u0275fac,providedIn:"root"}),PaymentRequestService2})();function isError(item){return item instanceof Error||item instanceof DOMException}let WaPaymentSubmit=(()=>{var _WaPaymentSubmit;class WaPaymentSubmit2{constructor(){this.paymentHost=(0,core.f3M)(WaPayment),this.paymentRequest=(0,core.f3M)(PaymentRequestService),this.nativeElement=(0,core.f3M)(core.SBq).nativeElement,this.methods=(0,core.f3M)(PAYMENT_METHODS),this.options=(0,core.f3M)(PAYMENT_OPTIONS);const requests$=(0,fromEvent.R)(this.nativeElement,"click").pipe((0,switchMap.w)(()=>(0,from.D)(this.paymentRequest.request({...this.paymentHost},this.methods,this.options)).pipe((0,catchError.K)(error=>(0,of.of)(error)))),(0,share.B)());this.waPaymentSubmit=requests$.pipe((0,filter.h)(response=>!isError(response))),this.waPaymentError=requests$.pipe((0,filter.h)(isError))}}return(_WaPaymentSubmit=WaPaymentSubmit2).\u0275fac=function(t){return new(t||_WaPaymentSubmit)},_WaPaymentSubmit.\u0275dir=core.lG2({type:_WaPaymentSubmit,selectors:[["","waPaymentSubmit",""]],outputs:{waPaymentSubmit:"waPaymentSubmit",waPaymentError:"waPaymentError"},standalone:!0}),WaPaymentSubmit2})()}};