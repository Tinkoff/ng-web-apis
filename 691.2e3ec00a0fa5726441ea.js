"use strict";(self.webpackChunkng_web_apis=self.webpackChunkng_web_apis||[]).push([[691],{6431:(O,y,i)=>{i.r(y),i.d(y,{GeolocationPageModule:()=>E});var n=i(5598),t=i(4788),s=i(6247),a=i(1211),r=i(2057),g=i(2554),c=i(4121);function m(e,u){if(1&e&&(t.O4$(),t.kcU(),t.TgZ(0,"div",5),t.TgZ(1,"div"),t._uU(2),t.qZA(),t.TgZ(3,"div"),t._uU(4),t.qZA(),t.qZA()),2&e){const o=t.oxw();t.xp6(2),t.hij("long: ",o.currentCoords.longitude,""),t.xp6(2),t.hij("lat: ",o.currentCoords.latitude,"")}}let h=(()=>{class e{constructor(o){this.domSanitizer=o,this.currentCoords=null,this.initialCoords=null,this.markerTransform$=new c.X("translate(0px,0px)")}set coordinatesChange(o){this.coordsToStyle(o),this.currentCoords=o}coordsToStyle(o){if(!this.initialCoords)return void(this.initialCoords=o);const S=this.domSanitizer.bypassSecurityTrustStyle(`translate(${1e4*(this.initialCoords.longitude-o.longitude)}px,${1e4*(this.initialCoords.latitude-o.latitude)}px)`);this.markerTransform$.next(S)}}return e.\u0275fac=function(o){return new(o||e)(t.Y36(a.H7))},e.\u0275cmp=t.Xpm({type:e,selectors:[["map"]],inputs:{coordinatesChange:"coordinatesChange"},decls:7,vars:5,consts:[[1,"map"],[1,"marker"],["id","Layer_1","version","1.1","xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink","x","0px","y","0px","viewBox","0 0 365 560","enable-background","new 0 0 365 560",0,"xml","space","preserve"],["fill","#00AEEF","d","M182.9,551.7c0,0.1,0.2,0.3,0.2,0.3S358.3,283,358.3,194.6c0-130.1-88.8-186.7-175.4-186.9\n\t\tC96.3,7.9,7.5,64.5,7.5,194.6c0,88.4,175.3,357.4,175.3,357.4S182.9,551.7,182.9,551.7z M122.2,187.2c0-33.6,27.2-60.8,60.8-60.8\n\t\tc33.6,0,60.8,27.2,60.8,60.8S216.5,248,182.9,248C149.4,248,122.2,220.8,122.2,187.2z"],["class","coords",4,"ngIf"],[1,"coords"]],template:function(o,l){1&o&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.ALo(2,"async"),t.O4$(),t.TgZ(3,"svg",2),t.TgZ(4,"g"),t._UZ(5,"path",3),t.qZA(),t.qZA(),t.qZA(),t.YNc(6,m,5,2,"div",4),t.qZA()),2&o&&(t.xp6(1),t.Udp("transform",t.lcZ(2,3,l.markerTransform$)),t.xp6(5),t.Q6J("ngIf",l.currentCoords))},directives:[r.O5],pipes:[r.Ov],styles:[".map[_ngcontent-%COMP%]{min-width:300px;height:300px;overflow:hidden;background-color:#eceaea70;border:1px solid #7c7c7c}.marker[_ngcontent-%COMP%]{position:relative;top:50%;left:50%;width:20px;height:20px}.coords[_ngcontent-%COMP%]{position:absolute;font-family:monospace;width:max-content}"],changeDetection:0}),e})();function p(e,u){if(1&e&&(t.TgZ(0,"div"),t._uU(1),t.qZA()),2&e){const o=t.oxw();t.xp6(1),t.hij(" Sorry, position is not available: ",o.error.message," ")}}function f(e,u){if(1&e&&t._UZ(0,"map",13),2&e){const o=t.oxw().ngIf;t.Q6J("coordinatesChange",o.coords)}}function Z(e,u){if(1&e&&(t.TgZ(0,"div"),t.YNc(1,f,1,1,"map",12),t.qZA()),2&e){const o=u.ngIf;t.xp6(1),t.Q6J("ngIf",o.coords)}}function d(e,u){if(1&e&&(t.TgZ(0,"div"),t.YNc(1,Z,2,1,"div",1),t.ALo(2,"async"),t.qZA()),2&e){const o=t.oxw();t.xp6(1),t.Q6J("ngIf",t.lcZ(2,1,o.geolocation$))}}function w(e,u){if(1&e&&t._UZ(0,"iframe",14),2&e){const o=t.oxw();t.Q6J("src",o.currentPositionUrl,t.uOi)}}let A=(()=>{class e{constructor(o,l,P){this.geolocation$=o,this.domSanitizer=l,this.changeDetectorRef=P,this.position=null,this.toggle=!1,this.currentPositionUrl=null,this.watchSubscription=null,this.error=null,this.sample="import {GeolocationService} from '@ng-web-apis/geolocation';\n\n// ...\n\nconstructor(private readonly geolocation$: GeolocationService) {}\n\ngetPosition() {\n  geolocation$.subscribe((position) => {\n     doSomethingWithPosition(position);\n  });\n}",this.sampleAsync='<app-component-using-position [position]="geolocation$ | async"></app-component-using-position>'}getCurrentPosition(){this.geolocation$.pipe((0,n.q)(1)).subscribe(o=>{this.currentPositionUrl=this.getUrl(o),this.changeDetectorRef.markForCheck()},o=>{this.error=o,this.changeDetectorRef.markForCheck()})}toggleWatch(){this.toggle=!this.toggle}getUrl(o){const l=o.coords.longitude,P=o.coords.latitude;return this.domSanitizer.bypassSecurityTrustResourceUrl(`//www.openstreetmap.org/export/embed.html?bbox=${l-.005},${P-.005},${l+.005},${P+.005}&marker=${o.coords.latitude},${o.coords.longitude}&layer=mapnik`)}}return e.\u0275fac=function(o){return new(o||e)(t.Y36(s._1),t.Y36(a.H7),t.Y36(t.sBO))},e.\u0275cmp=t.Xpm({type:e,selectors:[["geolocation-page"]],decls:56,vars:7,consts:[[1,"wrapper"],[4,"ngIf"],[3,"highlight"],[1,"watch-position"],[1,"switch-container"],["for","switcher",1,"switch-container__text"],[1,"switch"],["id","switcher","type","checkbox",3,"click"],[1,"slider","round"],[1,"current-position"],[1,"primary-button",3,"click"],["width","425","height","350","frameborder","0","scrolling","no","marginheight","0","marginwidth","0",3,"src",4,"ngIf"],[3,"coordinatesChange",4,"ngIf"],[3,"coordinatesChange"],["width","425","height","350","frameborder","0","scrolling","no","marginheight","0","marginwidth","0",3,"src"]],template:function(o,l){1&o&&(t.TgZ(0,"div",0),t.TgZ(1,"section"),t.TgZ(2,"p"),t.TgZ(3,"strong"),t._uU(4,"Angular"),t.qZA(),t._uU(5," does not have any built-in instruments to use "),t.TgZ(6,"strong"),t._uU(7,"Geolocation API"),t.qZA(),t._uU(8," . This is an "),t.TgZ(9,"code"),t._uU(10,"Observable"),t.qZA(),t._uU(11," based abstraction over "),t.TgZ(12,"strong"),t._uU(13,"Geolocation API"),t.qZA(),t._uU(14," to use with "),t.TgZ(15,"strong"),t._uU(16,"Angular"),t.qZA(),t.qZA(),t.qZA(),t.YNc(17,p,2,1,"div",1),t.TgZ(18,"section"),t.TgZ(19,"h2"),t._uU(20,"How to use"),t.qZA(),t.TgZ(21,"p"),t._uU(22," Usage is pretty simple: just import service in your component and subscribe to it. Service extends "),t.TgZ(23,"code"),t._uU(24,"Observable"),t.qZA(),t._uU(25," and will emit the "),t.TgZ(26,"code"),t._uU(27,"Position"),t.qZA(),t._uU(28," object. "),t.qZA(),t.TgZ(29,"pre"),t.TgZ(30,"code",2),t._uU(31),t.qZA(),t.qZA(),t.TgZ(32,"p"),t._uU(33,"You also can use async pipe"),t.qZA(),t.TgZ(34,"pre"),t.TgZ(35,"code",2),t._uU(36),t.qZA(),t.qZA(),t.TgZ(37,"div",3),t.TgZ(38,"div",4),t.TgZ(39,"label",5),t._uU(40," Track my position "),t.qZA(),t.TgZ(41,"label",6),t.TgZ(42,"input",7),t.NdJ("click",function(){return l.toggleWatch()}),t.qZA(),t._UZ(43,"span",8),t.qZA(),t.qZA(),t.YNc(44,d,3,3,"div",1),t.qZA(),t.TgZ(45,"h2"),t._uU(46,"Single position"),t.qZA(),t.TgZ(47,"div",9),t.TgZ(48,"p"),t._uU(49," If you need to get position just once and stop observing user location, you can subscribe to geolocation$ and use "),t.TgZ(50,"code"),t._uU(51,"take(1)"),t.qZA(),t._uU(52," RxJs operator. Service is cold, meaning if there are no Subscribers, it doesn't track position "),t.qZA(),t.TgZ(53,"button",10),t.NdJ("click",function(){return l.getCurrentPosition()}),t._uU(54," Get my position! "),t.qZA(),t.YNc(55,w,1,1,"iframe",11),t.qZA(),t.qZA(),t.qZA()),2&o&&(t.xp6(17),t.Q6J("ngIf",!!l.error),t.xp6(13),t.Q6J("highlight",l.sample),t.xp6(1),t.hij("\n            ",l.sample,"\n        "),t.xp6(4),t.Q6J("highlight",l.sampleAsync),t.xp6(1),t.hij("\n            ",l.sampleAsync,"\n        "),t.xp6(8),t.Q6J("ngIf",!!l.toggle),t.xp6(11),t.Q6J("ngIf",!!l.currentPositionUrl))},directives:[r.O5,g.y$,h],pipes:[r.Ov],encapsulation:2,changeDetection:0}),e})();var C=i(6618);let E=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({providers:[{provide:s.H,useValue:{enableHighAccuracy:!0,timeout:3e3,maximumAge:1e3}}],imports:[[r.ez,g._l,C.Bz.forChild([{path:"",component:A}])]]}),e})()},2176:(O,y,i)=>{i.d(y,{L1:()=>a,s5:()=>f,m9:()=>s});var n=i(4788),T=i(7980),b=i(815),t=i(2057);const s=new n.OlP("An abstraction over global window object",{factory:()=>{const{defaultView:v}=(0,n.f3M)(t.K0);if(!v)throw new Error("Window is not available");return v}}),a=new n.OlP("Shared Observable based on `window.requestAnimationFrame`",{factory:()=>{const{requestAnimationFrame:v,cancelAnimationFrame:U}=(0,n.f3M)(s);return new T.y(I=>{let _=NaN;const x=R=>{I.next(R),_=v(x)};return _=v(x),()=>{U(_)}}).pipe((0,b.B)())}}),f=(new n.OlP("An abstraction over window.caches object",{factory:()=>(0,n.f3M)(s).caches}),new n.OlP("An abstraction over window.crypto object",{factory:()=>(0,n.f3M)(s).crypto}),new n.OlP("An abstraction over window.CSS object",{factory:()=>(0,n.f3M)(s).CSS||{escape:v=>v,supports:()=>!1}}),new n.OlP("An abstraction over window.history object",{factory:()=>(0,n.f3M)(s).history}),new n.OlP("An abstraction over window.localStorage object",{factory:()=>(0,n.f3M)(s).localStorage}),new n.OlP("An abstraction over window.location object",{factory:()=>(0,n.f3M)(s).location}),new n.OlP("An abstraction over window.navigator object",{factory:()=>(0,n.f3M)(s).navigator}));new n.OlP("An abstraction over window.navigator.mediaDevices object",{factory:()=>(0,n.f3M)(f).mediaDevices}),new n.OlP("An abstraction over window.navigator.connection object",{factory:()=>(0,n.f3M)(f).connection||null});var w=i(4581),A=i(1927),C=i(7969),E=i(2147),e=i(5086);new n.OlP("Shared Observable based on `document visibility changed`",{factory:()=>{const v=(0,n.f3M)(t.K0);return(0,w.R)(v,"visibilitychange").pipe((0,A.O)(0),(0,C.U)(()=>"hidden"!==v.visibilityState),(0,E.x)(),(0,e.d)({refCount:!1,bufferSize:1}))}}),new n.OlP("An abstraction over window.performance object",{factory:()=>(0,n.f3M)(s).performance}),new n.OlP("An abstraction over window.screen object",{factory:()=>(0,n.f3M)(s).screen}),new n.OlP("An abstraction over window.sessionStorage object",{factory:()=>(0,n.f3M)(s).sessionStorage}),new n.OlP("An abstraction over SpeechRecognition class",{factory:()=>{const v=(0,n.f3M)(s);return v.speechRecognition||v.webkitSpeechRecognition||null}}),new n.OlP("An abstraction over window.speechSynthesis object",{factory:()=>(0,n.f3M)(s).speechSynthesis}),new n.OlP("An abstraction over window.navigator.userAgent object",{factory:()=>(0,n.f3M)(f).userAgent})},4581:(O,y,i)=>{i.d(y,{R:()=>m});var n=i(5955),T=i(7980),b=i(3159),t=i(6602),s=i(5975),a=i(2692);const r=["addListener","removeListener"],g=["addEventListener","removeEventListener"],c=["on","off"];function m(d,w,A,C){if((0,s.m)(A)&&(C=A,A=void 0),C)return m(d,w,A).pipe((0,a.Z)(C));const[E,e]=function(d){return(0,s.m)(d.addEventListener)&&(0,s.m)(d.removeEventListener)}(d)?g.map(u=>o=>d[u](w,o,A)):function(d){return(0,s.m)(d.addListener)&&(0,s.m)(d.removeListener)}(d)?r.map(h(d,w)):function(d){return(0,s.m)(d.on)&&(0,s.m)(d.off)}(d)?c.map(h(d,w)):[];if(!E&&(0,t.z)(d))return(0,b.z)(u=>m(u,w,A))((0,n.Xf)(d));if(!E)throw new TypeError("Invalid event target");return new T.y(u=>{const o=(...l)=>u.next(1<l.length?l:l[0]);return E(o),()=>e(o)})}function h(d,w){return A=>C=>d[A](w,C)}},2147:(O,y,i)=>{i.d(y,{x:()=>t});var n=i(8330),T=i(2085),b=i(8499);function t(a,r=n.y){return a=null!=a?a:s,(0,T.e)((g,c)=>{let m,h=!0;g.subscribe(new b.Q(c,p=>{const f=r(p);(h||!a(m,f))&&(h=!1,m=f,c.next(p))}))})}function s(a,r){return a===r}},5086:(O,y,i)=>{i.d(y,{d:()=>s});var n=i(9359),T=i(2069);class b extends n.x{constructor(r=1/0,g=1/0,c=T.l){super(),this._bufferSize=r,this._windowTime=g,this._timestampProvider=c,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=g===1/0,this._bufferSize=Math.max(1,r),this._windowTime=Math.max(1,g)}next(r){const{isStopped:g,_buffer:c,_infiniteTimeWindow:m,_timestampProvider:h,_windowTime:p}=this;g||(c.push(r),!m&&c.push(h.now()+p)),this._trimBuffer(),super.next(r)}_subscribe(r){this._throwIfClosed(),this._trimBuffer();const g=this._innerSubscribe(r),{_infiniteTimeWindow:c,_buffer:m}=this,h=m.slice();for(let p=0;p<h.length&&!r.closed;p+=c?1:2)r.next(h[p]);return this._checkFinalizedStatuses(r),g}_trimBuffer(){const{_bufferSize:r,_timestampProvider:g,_buffer:c,_infiniteTimeWindow:m}=this,h=(m?1:2)*r;if(r<1/0&&h<c.length&&c.splice(0,c.length-h),!m){const p=g.now();let f=0;for(let Z=1;Z<c.length&&c[Z]<=p;Z+=2)f=Z;f&&c.splice(0,f+1)}}}var t=i(815);function s(a,r,g){var c,m;let h,p=!1;return a&&"object"==typeof a?(h=null!==(c=a.bufferSize)&&void 0!==c?c:1/0,r=null!==(m=a.windowTime)&&void 0!==m?m:1/0,p=!!a.refCount,g=a.scheduler):h=null!=a?a:1/0,(0,t.B)({connector:()=>new b(h,r,g),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:p})}}}]);